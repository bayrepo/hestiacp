diff --git a/README.md b/README.md
index 7b4585a..3cfe850 100644
--- a/README.md
+++ b/README.md
@@ -70,7 +70,7 @@ ssh root@your.server
 Download the installation script for the latest release:
 
 ```bash
-wget https://raw.githubusercontent.com/hestiacp/hestiacp/release/install/hst-install.sh
+wget https://dev.putey.net/bayrepo/hestiacp/raw/branch/master/install/hst-install.sh
 ```
 
 If the download fails due to an SSL validation error, please be sure you've installed the ca-certificate package on your system - you can do this with the following command:
diff --git a/bin/v-add-sys-ip b/bin/v-add-sys-ip
index 9711b1d..4eecbb1 100755
--- a/bin/v-add-sys-ip
+++ b/bin/v-add-sys-ip
@@ -128,9 +128,12 @@ TIME='$time'
 DATE='$date'" > $HESTIA/data/ips/$ip
 chmod 660 $HESTIA/data/ips/$ip
 
+confd=$(get_conf_d_name "$WEB_SYSTEM")
+pconfd=$(get_conf_d_name "$PROXY_SYSTEM")
+
 # WEB support
 if [ -n "$WEB_SYSTEM" ]; then
-	web_conf="/etc/$WEB_SYSTEM/conf.d/$ip.conf"
+	web_conf="/etc/$WEB_SYSTEM/$confd/$ip.conf"
 	rm -f "$web_conf"
 
 	if [ "$WEB_SYSTEM" = 'httpd' ] || [ "$WEB_SYSTEM" = 'apache2' ]; then
@@ -164,12 +167,12 @@ if [ -n "$PROXY_SYSTEM" ]; then
 			-e "s/%web_port%/$WEB_PORT/g" \
 			-e "s/%proxy_port%/$PROXY_PORT/g" \
 			-e "s/%proxy_ssl_port%/$PROXY_SSL_PORT/g" \
-			> /etc/$PROXY_SYSTEM/conf.d/$ip.conf
+			> /etc/$PROXY_SYSTEM/$pconfd/$ip.conf
 
-	process_http2_directive "/etc/$PROXY_SYSTEM/conf.d/$ip.conf"
+	process_http2_directive "/etc/$PROXY_SYSTEM/$pconfd/$ip.conf"
 
 	# mod_extract_forwarded
-	fw_conf="/etc/$WEB_SYSTEM/conf.d/mod_extract_forwarded.conf"
+	fw_conf="/etc/$WEB_SYSTEM/$confd/mod_extract_forwarded.conf"
 	if [ -e "$fw_conf" ]; then
 		ips=$(grep 'MEFaccept ' "$fw_conf" | grep -v '#' | head -n1)
 		sed -i "s/$ips/$ips $ip/g" "$fw_conf"
diff --git a/bin/v-add-sys-quota b/bin/v-add-sys-quota
index 811eaae..364add5 100755
--- a/bin/v-add-sys-quota
+++ b/bin/v-add-sys-quota
@@ -22,14 +22,16 @@ source_conf "$HESTIA/conf/hestia.conf"
 #----------------------------------------------------------#
 
 # Ensure that quota kernel modules are installed
-kernel_module_check=$(find /lib/modules/$(uname -r) -type f -name '*quota_v*.ko*' | egrep '.*' && [ $? -eq 0 ])
-if [ -z "$kernel_module_check" ]; then
-	# Install kernel modules for quota support.
-	# Requires reboot to activate updated kernel.
-	echo "Installing required kernel modules for quota support..."
-	reboot_req="Y"
-	apt-get -qq install linux-image-extra-virtual -y
-	check_result $? "kernel module installation failed" "$E_UPDATE"
+if [ ! -f /etc/redhat-release ]; then
+	kernel_module_check=$(find /lib/modules/$(uname -r) -type f -name '*quota_v*.ko*' | egrep '.*' && [ $? -eq 0 ])
+	if [ -z "$kernel_module_check" ]; then
+		# Install kernel modules for quota support.
+		# Requires reboot to activate updated kernel.
+		echo "Installing required kernel modules for quota support..."
+		reboot_req="Y"
+		apt-get -qq install linux-image-extra-virtual -y
+		check_result $? "kernel module installation failed" "$E_UPDATE"
+	fi
 fi
 
 # Checking quota package
diff --git a/bin/v-add-user-sftp-key b/bin/v-add-user-sftp-key
index 1df7993..4a7d9f7 100755
--- a/bin/v-add-user-sftp-key
+++ b/bin/v-add-user-sftp-key
@@ -44,7 +44,7 @@ AUTHKEY_FILE="$HOMEDIR/$user/.ssh/authorized_keys"
 [ -z "$(readlink -f "$AUTHKEY_FILE" | egrep "^$HOMEDIR/$user/.ssh/")" ] && check_result "$E_FORBIDEN" "Invalid authorized keys path"
 
 if [ ! -f "${PRVKEY_FILE}" ]; then
-	ssh-keygen -q -b 1024 -t rsa -f "${PRVKEY_FILE}" -N ""
+	ssh-keygen -q -t rsa-sha2-512 -b 4096 -f "${PRVKEY_FILE}" -N ""
 	rm "${PUBKEY_FILE}"
 	new_privkey=true
 fi
diff --git a/bin/v-add-web-php b/bin/v-add-web-php
index bba1d77..b96361c 100755
--- a/bin/v-add-web-php
+++ b/bin/v-add-web-php
@@ -21,6 +21,12 @@ source $HESTIA/func/main.sh
 # load config file
 source_conf "$HESTIA/conf/hestia.conf"
 source_conf "$HESTIA/install/upgrade/upgrade.conf"
+
+if [ -f /etc/redhat-release ]; then
+	for elem in "${!multiphp_v[@]}"; do
+		multiphp_v[$elem]=$(convert_dot_version_to_non_dot "${multiphp_v[$elem]}")
+	done
+fi
 #----------------------------------------------------------#
 #                    Verifications                         #
 #----------------------------------------------------------#
@@ -32,7 +38,11 @@ if [ -z "$WEB_BACKEND" ]; then
 fi
 
 # Set file locations
-php_fpm="/etc/init.d/php$version-fpm"
+if [ -f /etc/redhat-release ]; then
+	php_fpm="/usr/lib/systemd/system/php$version-php-fpm.service"
+else
+	php_fpm="/etc/init.d/php$version-fpm"
+fi
 
 # Verify php version format
 if [ -f /etc/redhat-release ]; then
@@ -68,16 +78,16 @@ check_hestia_demo_mode
 #                       Action                             #
 #----------------------------------------------------------#
 
-mph="php$version-common php$version-mbstring php$version-bcmath php$version-cli php$version-curl
+mph="php$version-common php$version-mbstring php$version-bcmath php$version-cli php$version-curl 
      php$version-fpm php$version-gd php$version-intl php$version-mysql
      php$version-soap php$version-xml php$version-zip php$version-json php$version-bz2
      php$version-pspell php$version-imagick php$version-pgsql php$version-imap php$version-ldap"
 if [ -f /etc/redhat-release ]; then
   # Packages in Remi repo have names with php$version-php- prefixes
-  mph="php$version-php-fpm php$version-php-cgi php$version-php-mysqlnd php$version-php-pgsql
-       php$version-php-pdo php$version-php-common php$version-php-pecl-imagick php$version-php-imap
-       php$version-php-ldap php$version-php-pecl-apcu php$version-php-pecl-zip php$version-php-cli
-       php$version-php-opcache php$version-php-xml php$version-php-gd php$version-php-intl
+  mph="php$version-php-fpm php$version-php-cgi php$version-php-mysqlnd php$version-php-pgsql 
+       php$version-php-pdo php$version-php-common php$version-php-pecl-imagick php$version-php-imap 
+       php$version-php-ldap php$version-php-pecl-apcu php$version-php-pecl-zip php$version-php-cli 
+       php$version-php-opcache php$version-php-xml php$version-php-gd php$version-php-intl 
        php$version-php-mbstring php$version-php-pspell php$version-php-readline"
 	   if [ "$version" = "56" ]; then
            mph=$(sed -e "s/php$version-php-pecl-apcu//")
@@ -133,6 +143,13 @@ if [ ! -f "$php_fpm" ]; then
 	fi
 fi
 
+if [ -f '/etc/redhat-release' ]; then
+	result_alt_php=$(alternatives --display php | grep /usr/bin/php$version)
+	if [ -z "$result_alt_php" ]; then
+		alternatives --install /usr/bin/php php /usr/bin/php$version 1 > /dev/null 2>&1
+	fi
+fi
+
 # Check if required modules for apache2 are enabled
 if [ "$WEB_SYSTEM" = "apache2" ]; then
 	if [ -f /etc/redhat-release ]; then
diff --git a/bin/v-change-sys-api b/bin/v-change-sys-api
index fdd53fb..92da649 100755
--- a/bin/v-change-sys-api
+++ b/bin/v-change-sys-api
@@ -38,9 +38,10 @@ check_hestia_demo_mode
 
 if [ "$status" = "enable" ]; then
 	if [ ! -f "$HESTIA/web/api/index.php" ]; then
-		wget -q https://raw.githubusercontent.com/hestiacp/hestiacp/$RELEASE_BRANCH/web/api/index.php -O $HESTIA/web/api/index.php
+		# Avoid useng RELEASE_BRANCH
+		wget -q https://dev.putey.net/bayrepo/hestiacp/raw/branch/master/web/api/index.php -O $HESTIA/web/api/index.php
 		if [ ! -s "$HESTIA/web/api/index.php" ]; then
-			wget -q https://raw.githubusercontent.com/hestiacp/hestiacp/release/web/api/index.php -O $HESTIA/web/api/index.php
+			wget -q https://dev.putey.net/bayrepo/hestiacp/raw/branch/master/web/api/index.php -O $HESTIA/web/api/index.php
 			if [ ! -s "$HESTIA/web/api/index.php" ]; then
 				# Throw error message to user
 				echo "ERROR: API installation failed."
diff --git a/bin/v-change-sys-db-alias b/bin/v-change-sys-db-alias
index 816db87..c76be8d 100755
--- a/bin/v-change-sys-db-alias
+++ b/bin/v-change-sys-db-alias
@@ -59,6 +59,15 @@ if [ "$type" = "pma" ] || [ "$type" = "PMA" ] || [ "$type" = "phpmyadmin" ]; the
 		$BIN/v-restart-service apache2
 	fi
 
+	if [ -e "/etc/httpd/conf.h.d/phpmyadmin.inc" ]; then
+		rm -f /etc/httpd/conf.h.d/phpmyadmin.inc
+		cp -f $HESTIA_INSTALL_DIR/pma/apache.conf /etc/httpd/conf.h.d/phpmyadmin.inc
+		sed -i "s|%pma_alias%|$alias|g" /etc/httpd/conf.h.d/phpmyadmin.inc
+
+		# Restart services
+		$BIN/v-restart-service httpd
+	fi
+
 	if [ -e "/etc/nginx/conf.d/phpmyadmin.inc" ]; then
 		rm -f /etc/nginx/conf.d/phpmyadmin.inc
 		cp -f $HESTIA_INSTALL_DIR/nginx/phpmyadmin.inc /etc/nginx/conf.d/phpmyadmin.inc
@@ -87,6 +96,15 @@ if [ "$type" = "pga" ] || [ "$type" = "PGA" ] || [ "$type" = "phppgadmin" ]; the
 		$BIN/v-restart-service apache2
 	fi
 
+		if [ -e "/etc/httpd/conf.h.d/phpmyadmin.inc" ]; then
+		rm -f /etc/httpd/conf.h.d/phpmyadmin.inc
+		cp -f $HESTIA_INSTALL_DIR/pga/phppgadmin.conf /etc/httpd/conf.h.d/phppgadmin.inc
+		sed -i "s|%pga_alias%|$alias|g" /etc/httpd/conf.h.d/phppgadmin.inc
+
+		# Restart services
+		$BIN/v-restart-service httpd
+	fi
+
 	if [ -e "/etc/nginx/conf.d/phppgadmin.inc" ]; then
 		rm -f /etc/nginx/conf.d/phppgadmin.inc
 		cp -f $HESTIA_INSTALL_DIR/nginx/phppgadmin.inc /etc/nginx/conf.d/phppgadmin.inc
diff --git a/bin/v-change-sys-php b/bin/v-change-sys-php
index acfaae0..6bfb44f 100755
--- a/bin/v-change-sys-php
+++ b/bin/v-change-sys-php
@@ -21,10 +21,18 @@ source_conf "$HESTIA/conf/hestia.conf"
 check_args '1' "$#" 'VERSION'
 
 # Verify php version format
-if [[ ! $version =~ ^[0-9]\.[0-9]+ ]]; then
-	echo "The specified PHP version format is invalid, it should look like [0-9].[0-9]."
-	echo "Example: 7.0, 7.4, 8.0"
-	exit "$E_INVALID"
+if [ -f /etc/redhat-release ]; then
+	if [[ ! $version =~ ^[0-9][0-9]+ ]]; then
+		echo "The specified PHP version format is invalid, it should look like [0-9][0-9]."
+		echo "Example: 70, 74, 80"
+		exit "$E_INVALID"
+	fi
+else
+	if [[ ! $version =~ ^[0-9].[0-9]+ ]]; then
+		echo "The specified PHP version format is invalid, it should look like [0-9].[0-9]."
+		echo "Example: 7.0, 7.4, 8.0"
+		exit "$E_INVALID"
+	fi
 fi
 
 # Check if php version exists
@@ -42,10 +50,19 @@ check_hestia_demo_mode
 #----------------------------------------------------------#
 
 # Set file locations
-php_fpm="/etc/init.d/php$version-fpm"
+if [ -f /etc/redhat-release ]; then
+	php_fpm="/usr/lib/systemd/system/php$version-php-fpm.service"
+else
+	php_fpm="/etc/init.d/php$version-fpm"
+fi
 
-rm -f /etc/php/*/fpm/pool.d/www.conf
-cp -f $HESTIA/install/deb/php-fpm/www.conf /etc/php/$version/fpm/pool.d/www.conf
+if [ -f /etc/redhat-release ]; then
+	rm -f /etc/opt/remi/php*/php-fpm.d/www.conf
+	cp -f $HESTIA/install/rpm/php-fpm/www.conf /etc/opt/remi/php$version/php-fpm.d/www.conf
+else
+	rm -f /etc/php/*/fpm/pool.d/www.conf
+	cp -f $HESTIA/install/deb/php-fpm/www.conf /etc/php/$version/fpm/pool.d/www.conf
+fi
 
 for user in $($BIN/v-list-sys-users plain); do
 	$BIN/v-rebuild-web-domains "$user" 'no' > /dev/null 2>&1
@@ -58,6 +75,13 @@ $BIN/v-restart-web-backend
 $BIN/v-restart-web
 $BIN/v-restart-proxy
 
+if [ -f '/etc/redhat-release' ]; then
+	result_alt_php=$(alternatives --display php | grep /usr/bin/php$version)
+	if [ -z "$result_alt_php" ]; then
+		alternatives --install /usr/bin/php php /usr/bin/php$version 1 > /dev/null 2>&1
+	fi
+fi
+
 update-alternatives --set php /usr/bin/php$version
 
 #----------------------------------------------------------#
diff --git a/bin/v-change-sys-release b/bin/v-change-sys-release
index b2ea28c..aae514d 100755
--- a/bin/v-change-sys-release
+++ b/bin/v-change-sys-release
@@ -49,7 +49,7 @@ if [ -z "$branch" ]; then
 else
 	# Check that requested branch exists
 	echo "Checking for existence of $branch branch..."
-	branch_check=$(curl -s --head -w %{http_code} "https://raw.githubusercontent.com/hestiacp/hestiacp/$branch/src/deb/hestia/control" -o /dev/null)
+	branch_check=$(curl -s --head -w %{http_code} "https://dev.putey.net/bayrepo/hestiacp/raw/branch/master/src/rpm/hestia/control" -o /dev/null)
 	if [ "$branch_check" -ne "200" ]; then
 		echo "Error: invalid branch name specified."
 		exit 1
diff --git a/bin/v-change-sys-webmail b/bin/v-change-sys-webmail
index 1a1cd92..8b3be4e 100755
--- a/bin/v-change-sys-webmail
+++ b/bin/v-change-sys-webmail
@@ -55,6 +55,10 @@ if [ -d /etc/apache2/ ]; then
 	sed -i "s/IncludeOptional conf.d\/domains\/$WEBMAIL_ALIAS.*.conf/IncludeOptional conf.d\/domains\/$NEW_ALIAS.*.conf/g" /etc/apache2/apache2.conf
 fi
 
+if [ -d /etc/httpd/ ]; then
+	sed -i "s/IncludeOptional conf.h.d\/domains\/$WEBMAIL_ALIAS.*.conf/IncludeOptional conf.h.d\/domains\/$NEW_ALIAS.*.conf/g" /etc/httpd/conf/htpd.conf
+fi
+
 #----------------------------------------------------------#
 #                       Hestia                             #
 #----------------------------------------------------------#
diff --git a/bin/v-change-user-php-cli b/bin/v-change-user-php-cli
index b6d150a..03435fe 100755
--- a/bin/v-change-user-php-cli
+++ b/bin/v-change-user-php-cli
@@ -27,7 +27,11 @@ source_conf "$HESTIA/conf/hestia.conf"
 #                    Verifications                         #
 #----------------------------------------------------------#
 
-FILE=$HOMEDIR/$user/.bash_aliases
+if [ -f /etc/redhat-release ];then
+	FILE=$HOMEDIR/$user/.bashrc.d/bash_aliases
+else
+	FILE=$HOMEDIR/$user/.bash_aliases
+fi
 
 check_args '2' "$#" 'USER PHPVERSION'
 is_format_valid 'user'
@@ -55,6 +59,10 @@ fi
 
 # Create .bash_aliases is not exsists
 if [ ! -f "$FILE" ]; then
+	if [ -f /etc/redhat-release ];then
+		mkdir -p $HOMEDIR/$user/.bashrc.d
+		chown -R $user:$user $HOMEDIR/$user/.bashrc.d
+	fi
 	touch $FILE
 	chown $user:$user $FILE
 fi
diff --git a/bin/v-change-web-domain-name b/bin/v-change-web-domain-name
index dee80ff..291e090 100755
--- a/bin/v-change-web-domain-name
+++ b/bin/v-change-web-domain-name
@@ -99,14 +99,16 @@ if [ "$SSL" = 'yes' ]; then
 	del_web_config "$WEB_SYSTEM" "$TPL.stpl"
 fi
 
+pconfd=$(get_conf_d_name "$PROXY_SYSTEM")
+
 # Deleting proxy
 if [ -n "$PROXY_SYSTEM" ]; then
 	del_web_config "$PROXY_SYSTEM" "$PROXY.tpl"
 	if [ "$SSL" = 'yes' ]; then
 		del_web_config "$PROXY_SYSTEM" "$PROXY.stpl"
 	fi
-	if [ -e "/etc/$PROXY_SYSTEM/conf.d/01_caching_pool.conf" ]; then
-		sed -i "/=$domain:/d" /etc/$PROXY_SYSTEM/conf.d/01_caching_pool.conf
+	if [ -e "/etc/$PROXY_SYSTEM/$pconfd/01_caching_pool.conf" ]; then
+		sed -i "/=$domain:/d" /etc/$PROXY_SYSTEM/$pconfd/01_caching_pool.conf
 	fi
 fi
 
diff --git a/bin/v-check-rhel-utility b/bin/v-check-rhel-utility
new file mode 100755
index 0000000..e280d5b
--- /dev/null
+++ b/bin/v-check-rhel-utility
@@ -0,0 +1,11 @@
+#!/bin/bash
+# info: Check rehel or not
+# options: none
+
+# example: v-check-rhel-utility
+
+if [ -f '/etc/redhat-release' ]; then
+    echo -n "+"
+else
+    echo -n "-"
+fi
\ No newline at end of file
diff --git a/bin/v-check-service-config b/bin/v-check-service-config
new file mode 100755
index 0000000..5a0e25b
--- /dev/null
+++ b/bin/v-check-service-config
@@ -0,0 +1,51 @@
+#!/bin/bash
+# info: check service config
+# options: [SERVICE NAME]
+#
+# example: v-restart-web
+#
+# This function return status of service check config.
+
+#----------------------------------------------------------#
+#                Variables & Functions                     #
+#----------------------------------------------------------#
+
+# Includes
+# shellcheck source=/etc/hestiacp/hestia.conf
+source /etc/hestiacp/hestia.conf
+# shellcheck source=/usr/local/hestia/func/main.sh
+source $HESTIA/func/main.sh
+# load config file
+source_conf "$HESTIA/conf/hestia.conf"
+
+date=$(date +"%Y-%m-%d %H:%M:%S")
+DEBUG_LOG_FILE="/var/log/hestia/debug.log"
+
+[[ -f /etc/redhat-release ]] || exit 0
+
+[[ -n "$1" ]] || exit 1
+
+[[ -n "$2" ]] || DEBUG_LOG_FILE="$2"
+
+SERVICE_NAME="$1"
+
+case "$SERVICE_NAME" in
+nginx )
+    /usr/sbin/nginx -t >> "$DEBUG_LOG_FILE" 2>&1
+    V_RESULT=$?
+    exit $V_RESULT
+;;
+httpd )
+    /usr/sbin/httpd -t >> "$DEBUG_LOG_FILE" 2>&1
+    V_RESULT=$?
+    exit $V_RESULT
+;;
+* )
+    exit 0
+;;
+esac
+
+# Something like error, we shouldn't be here
+exit 1
+
+
diff --git a/bin/v-delete-sys-ip b/bin/v-delete-sys-ip
index 76e602f..1ac77e2 100755
--- a/bin/v-delete-sys-ip
+++ b/bin/v-delete-sys-ip
@@ -93,17 +93,20 @@ fi
 # Deleting Hestia IP
 rm -f $HESTIA/data/ips/$ip
 
+confd=$(get_conf_d_name "$WEB_SYSTEM")
+pconfd=$(get_conf_d_name "$PROXY_SYSTEM")
+
 # Deleting web config
 if [ -n "$WEB_SYSTEM" ]; then
-	rm -f /etc/$WEB_SYSTEM/conf.d/$ip.conf
+	rm -f /etc/$WEB_SYSTEM/$confd/$ip.conf
 fi
 
 # Deleting proxy config
 if [ -n "$PROXY_SYSTEM" ]; then
-	rm -f /etc/$PROXY_SYSTEM/conf.d/$ip.conf
+	rm -f /etc/$PROXY_SYSTEM/$pconfd/$ip.conf
 
 	# mod_extract_forwarded
-	fw_conf="/etc/$WEB_SYSTEM/conf.d/mod_extract_forwarded.conf"
+	fw_conf="/etc/$WEB_SYSTEM/$pconfd/mod_extract_forwarded.conf"
 	if [ -e "$fw_conf" ]; then
 		ips="$(grep 'MEFaccept 127.0.0.1' "$fw_conf")"
 		new_ips="$(echo "$ips" | sed "s/$ip//")"
diff --git a/bin/v-delete-web-domain b/bin/v-delete-web-domain
index 90deaeb..de7cbac 100755
--- a/bin/v-delete-web-domain
+++ b/bin/v-delete-web-domain
@@ -88,14 +88,16 @@ fi
 # Deleting domain from web.conf
 sed -i "/DOMAIN='$domain'/ d" "$USER_DATA/web.conf"
 
+pconfd=$(get_conf_d_name "$PROXY_SYSTEM")
+
 # Deleting proxy
 if [ -n "$PROXY_SYSTEM" ]; then
 	del_web_config "$PROXY_SYSTEM" "$PROXY.tpl"
 	if [ "$SSL" = 'yes' ]; then
 		del_web_config "$PROXY_SYSTEM" "$PROXY.stpl"
 	fi
-	if [ -e "/etc/$PROXY_SYSTEM/conf.d/01_caching_pool.conf" ]; then
-		sed -i "/=$domain:/d" "/etc/$PROXY_SYSTEM/conf.d/01_caching_pool.conf"
+	if [ -e "/etc/$PROXY_SYSTEM/$pconfd/01_caching_pool.conf" ]; then
+		sed -i "/=$domain:/d" "/etc/$PROXY_SYSTEM/$pconfd/01_caching_pool.conf"
 	fi
 fi
 
diff --git a/bin/v-delete-web-domain-backend b/bin/v-delete-web-domain-backend
index 464b55d..51bf51f 100755
--- a/bin/v-delete-web-domain-backend
+++ b/bin/v-delete-web-domain-backend
@@ -53,7 +53,7 @@ BACKEND="$template"
 
 # Defining pool directory
 if [ -f "/etc/redhat-release" ]; then
-	pool=$(find -L /etc/opt/remi/php80/ -name "$domain.conf" -exec dirname {} \;)
+	pool=$(find -L /etc/opt/remi/ -name "$domain.conf" -exec dirname {} \;)
 else
 	pool=$(find -L /etc/php/ -name "$domain.conf" -exec dirname {} \;)
 fi
diff --git a/bin/v-delete-web-php b/bin/v-delete-web-php
index 9680df1..e575543 100755
--- a/bin/v-delete-web-php
+++ b/bin/v-delete-web-php
@@ -32,13 +32,25 @@ if [ -z "$WEB_BACKEND" ]; then
 fi
 
 # Set file locations
-php_fpm="/etc/init.d/php$version-fpm"
+if [ -f /etc/redhat-release ]; then
+	php_fpm="/usr/lib/systemd/system/php$version-php-fpm.service"
+else
+	php_fpm="/etc/init.d/php$version-fpm"
+fi
 
 # Verify php version format
-if [[ ! $version =~ ^[0-9]\.[0-9]+ ]]; then
-	echo "The PHP version format is invalid, it should look like [0-9].[0-9]."
-	echo "Example:  7.0, 7.4"
-	exit
+if [ -f /etc/redhat-release ]; then
+	if [[ ! $version =~ ^[0-9][0-9]+ ]]; then
+		echo "The PHP version format is invalid, it should look like [0-9][0-9]."
+		echo "Example: 70, 74, 80"
+		exit "$E_INVALID"
+	fi
+else
+	if [[ ! $version =~ ^[0-9].[0-9]+ ]]; then
+		echo "The PHP version format is invalid, it should look like [0-9].[0-9]."
+		echo "Example: 7.0, 7.4, 8.0"
+		exit "$E_INVALID"
+	fi
 fi
 
 # Remove backend template
@@ -64,10 +76,25 @@ mph="php$version-common php$version-mbstring php$version-bcmath php$version-cli
  php$version-json php$version-bz2 php$version-pspell php$version-imagick php$version-pgsql
  php$version-imap php$version-ldap"
 
+ if [ -f /etc/redhat-release ]; then
+  # Packages in Remi repo have names with php$version-php- prefixes
+  mph="php$version-php-fpm php$version-php-cgi php$version-php-mysqlnd php$version-php-pgsql 
+       php$version-php-pdo php$version-php-common php$version-php-pecl-imagick php$version-php-imap 
+       php$version-php-ldap php$version-php-pecl-apcu php$version-php-pecl-zip php$version-php-cli 
+       php$version-php-opcache php$version-php-xml php$version-php-gd php$version-php-intl 
+       php$version-php-mbstring php$version-php-pspell php$version-php-readline"
+fi
+
 # Check is version is 7.1 or below to add mcrypt
+if [ -f /etc/redhat-release ]; then
+if [[ $(echo "$version 72" | awk '{print ($1 < $2)}') == 1 ]]; then
+	mph="$mph php$version-php-mcrypt"
+fi
+else
 if [[ $(echo "$version 7.2" | awk '{print ($1 < $2)}') == 1 ]]; then
 	mph="$mph php$version-mcrypt"
 fi
+fi
 
 # Purge php packages
 if [ -f '/etc/redhat-release' ]; then
@@ -101,16 +128,33 @@ if [ -f "$php_fpm" ]; then
 fi
 
 # Cleanup php folder
-[[ -d /etc/php/$version ]] && rm -rf "/etc/php/$version"
-
-if [ "$WEB_BACKEND" = "php-fpm" ]; then
-	conf=$(find /etc/php* -name www.conf)
-	# Check if www.conf exists
-	if [ -z "$conf" ]; then
-		# If not grab the "last php version
-		last=$($BIN/v-list-sys-php "shell" | tail -n1)
-		cp -f $HESTIA/install/deb/php-fpm/www.conf /etc/php/$last/fpm/pool.d/www.conf
-		$BIN/v-restart-web-backend
+if [ -f '/etc/redhat-release' ]; then
+	[[ -d /etc/opt/remi/php$version ]] && rm -rf "/etc/opt/remi/php$version"
+else
+	[[ -d /etc/php/$version ]] && rm -rf "/etc/php/$version"
+fi
+
+if [ -f '/etc/redhat-release' ]; then
+	if [ "$WEB_BACKEND" = "php-fpm" ]; then
+		conf=$(find /etc/opt/remi/php* -name www.conf)
+		# Check if www.conf exists
+		if [ -z "$conf" ]; then
+			# If not grab the "last php version
+			last=$($BIN/v-list-sys-php "shell" | tail -n1)
+			cp -f $HESTIA/install/rpm/php-fpm/www.conf /etc/opt/remi/php$version/php-fpm.d/www.conf
+			$BIN/v-restart-web-backend
+		fi
+	fi
+else
+	if [ "$WEB_BACKEND" = "php-fpm" ]; then
+		conf=$(find /etc/php* -name www.conf)
+		# Check if www.conf exists
+		if [ -z "$conf" ]; then
+			# If not grab the "last php version
+			last=$($BIN/v-list-sys-php "shell" | tail -n1)
+			cp -f $HESTIA/install/deb/php-fpm/www.conf /etc/php/$last/fpm/pool.d/www.conf
+			$BIN/v-restart-web-backend
+		fi
 	fi
 fi
 
diff --git a/bin/v-list-default-php b/bin/v-list-default-php
index ef4b945..da15898 100755
--- a/bin/v-list-default-php
+++ b/bin/v-list-default-php
@@ -67,10 +67,17 @@ csv_list() {
 
 declare -a versions
 # List through /etc/php
-for version in /etc/php/*/fpm/pool.d/www.conf; do
-	ver=$(echo "$version" | awk -F"/" '{ print $4 }')
-	versions+=("$ver")
-done
+if [ -f /etc/redhat-release ]; then
+	for version in /etc/opt/remi/php*/php-fpm.d/www.conf; do
+		ver=$(echo "$version" | awk -F"/" '{ print $5 }' | sed  "s/php\([[:digit:]]\+\)/\1/g")
+		versions+=("$ver")
+	done
+else
+	for version in /etc/php/*/fpm/pool.d/www.conf; do
+		ver=$(echo "$version" | awk -F"/" '{ print $4 }')
+		versions+=("$ver")
+	done
+fi
 
 # Listing data
 case $format in
diff --git a/bin/v-list-sys-clamd-config b/bin/v-list-sys-clamd-config
index 4683e43..c54e644 100755
--- a/bin/v-list-sys-clamd-config
+++ b/bin/v-list-sys-clamd-config
@@ -58,7 +58,10 @@ else
 		config_path='/etc/clamd.conf'
 	fi
 	if [ -e '/etc/clamd.d/clamd.conf' ]; then
-		config_path='/etc/clamav/clamd.conf'
+		config_path='/etc/clamd.d/clamd.conf'
+	fi
+	if [ -e '/etc/clamd.d/daemon.conf' ]; then
+		config_path='/etc/clamd.d/daemon.conf'
 	fi
 fi
 
diff --git a/bin/v-list-sys-hestia-updates b/bin/v-list-sys-hestia-updates
index a138299..2dbde30 100755
--- a/bin/v-list-sys-hestia-updates
+++ b/bin/v-list-sys-hestia-updates
@@ -85,9 +85,9 @@ shell_list() {
 
 # Checking official latest version
 if [ -f '/etc/redhat-release' ]; then
-	hestia_v=$(dnf list hestia | grep hestia | awk '{print $2}' | cut -f 1 -d '-')
-	nginx_v=$(dnf list hestia-nginx | grep hestia-nginx | awk '{print $2}' | cut -f 1 -d '-')
-	php_v=$(dnf list hestia-php | grep hestia-php | awk '{print $2}' | cut -f 1 -d '-')
+	hestia_v=$(dnf list hestia --available | grep -v '.src' | grep hestia | awk '{print $2}' | cut -f 1 -d '-')
+	nginx_v=$(dnf list hestia-nginx --available | grep -v '.src' | grep hestia-nginx | awk '{print $2}' | cut -f 1 -d '-')
+	php_v=$(dnf list hestia-php --available | grep -v '.src' | grep hestia-php | awk '{print $2}' | cut -f 1 -d '-')
 else
 	hestia_v=$(apt-cache policy hestia | grep Candidate | cut -d ':' -f 2 | xargs)
 	nginx_v=$(apt-cache policy hestia-nginx | grep Candidate | cut -d ':' -f 2 | xargs)
diff --git a/bin/v-list-sys-php b/bin/v-list-sys-php
index 5f1ecab..c415a64 100755
--- a/bin/v-list-sys-php
+++ b/bin/v-list-sys-php
@@ -67,17 +67,24 @@ csv_list() {
 
 declare -a versions
 # List through /etc/php
-if [ -n "$WEB_BACKEND" ]; then
-	for version in /etc/php/*/fpm; do
-		ver=$(echo "$version" | awk -F"/" '{ print $4 }')
+if [ -f /etc/redhat-release ]; then
+	for version in /etc/opt/remi/php*/; do
+		ver=$(echo "$version" | awk -F"/" '{ print $5 }' | sed 's|php||')
 		versions+=("$ver")
 	done
 else
-	# Fix for modphp
-	for version in /etc/php/*/cli; do
-		ver=$(echo "$version" | awk -F"/" '{ print $4 }')
-		versions+=("$ver")
-	done
+	if [ -n "$WEB_BACKEND" ]; then
+		for version in /etc/php/*/fpm; do
+			ver=$(echo "$version" | awk -F"/" '{ print $4 }')
+			versions+=("$ver")
+		done
+	else
+		# Fix for modphp
+		for version in /etc/php/*/cli; do
+			ver=$(echo "$version" | awk -F"/" '{ print $4 }')
+			versions+=("$ver")
+		done
+	fi
 fi
 # Listing data
 case $format in
diff --git a/bin/v-list-sys-php-config b/bin/v-list-sys-php-config
index b78e774..2c07df7 100755
--- a/bin/v-list-sys-php-config
+++ b/bin/v-list-sys-php-config
@@ -63,10 +63,18 @@ csv_list() {
 #----------------------------------------------------------#
 
 # Defining config path
-config_path=$(find /etc/php* -name php.ini)
+if [ -f /etc/redhat-release ]; then
+	config_path=$(find /etc/opt/remi/php* -name php.ini)
+else
+	config_path=$(find /etc/php* -name php.ini)
+fi
 config_count=$(echo "$config_path" | wc -l)
 if [ "$config_count" -gt 1 ]; then
-	multiphp_versions=$(ls -d /etc/php/*/fpm/pool.d 2> /dev/null | wc -l)
+	if [ -f /etc/redhat-release ]; then
+		multiphp_versions=$(ls -d /etc/opt/remi/php*/php-fpm.d 2> /dev/null | wc -l)
+	else
+		multiphp_versions=$(ls -d /etc/php/*/fpm/pool.d 2> /dev/null | wc -l)
+	fi
 	if [ "$WEB_BACKEND" = 'php-fpm' ] || [ "$multiphp_versions" -gt 0 ]; then
 		config_path=$(echo "$config_path" | grep fpm)
 	else
diff --git a/bin/v-list-sys-services b/bin/v-list-sys-services
index 2ee0cdb..2029128 100755
--- a/bin/v-list-sys-services
+++ b/bin/v-list-sys-services
@@ -86,13 +86,23 @@ get_srv_state() {
 	rtime="0"
 
 	# Searching related pids
-	if [ -z $3 ]; then
-		pids=$(pidof $name | tr ' ' '|')
+	if [ -f /etc/redhat-release ] && [ "$name" = "php-fpm" ]; then
+		pids=''
+		for php_pid in $(pidof php-fpm); do
+			process_info=$(ps -p "$php_pid" -o args | tail -n1 | grep "$srv")
+			if [ -n "$process_info" ]; then
+				pids="${pids}|${php_pid}"
+			fi
+		done
 	else
-		pids=$(pidof -x $name | tr ' ' '|')
-	fi
-	if [ -z "$pids" ] && [ "$name" != 'nginx' ]; then
-		pids=$(pgrep $name | tr '\n' '|')
+		if [ -z $3 ]; then
+			pids=$(pidof $name | tr ' ' '|')
+		else
+			pids=$(pidof -x $name | tr ' ' '|')
+		fi
+		if [ -z "$pids" ] && [ "$name" != 'nginx' ]; then
+			pids=$(pgrep $name | tr '\n' '|')
+		fi
 	fi
 
 	# Prevent from an SSH false positive when there is a TTY or SFTP connection but service is down
@@ -164,14 +174,25 @@ fi
 
 # Checking PHP intepreter
 if [ -n "$WEB_BACKEND" ] && [ "$WEB_BACKEND" != 'remote' ]; then
-	php_versions=$(ls /usr/sbin/php*fpm* | cut -d'/' -f4 | sed 's|php-fpm||')
-	for version in $php_versions; do
-		proc_name="php-fpm${version}"
-		service_name="php${version}-fpm"
-		get_srv_state "$proc_name"
-		data="$data\nNAME='$service_name' SYSTEM='php interpreter' STATE='$state'"
-		data="$data CPU='$cpu' MEM='$mem' RTIME='$rtime'"
-	done
+	if [ -f /etc/redhat-release ]; then
+		php_versions=$(ls /opt/remi/php*/root/sbin/php-fpm | cut -d'/' -f4 | sed 's|php||')
+		for version in $php_versions; do
+			proc_name="php-fpm"
+			service_name="php${version}"
+			get_srv_state "$proc_name"
+			data="$data\nNAME='$service_name-php-fpm' SYSTEM='php interpreter' STATE='$state'"
+			data="$data CPU='$cpu' MEM='$mem' RTIME='$rtime'"
+		done
+	else
+		php_versions=$(ls /usr/sbin/php*fpm* | cut -d'/' -f4 | sed 's|php-fpm||')
+		for version in $php_versions; do
+			proc_name="php-fpm${version}"
+			service_name="php${version}-fpm"
+			get_srv_state "$service_name" "$proc_name"
+			data="$data\nNAME='$service_name' SYSTEM='php interpreter' STATE='$state'"
+			data="$data CPU='$cpu' MEM='$mem' RTIME='$rtime'"
+		done
+	fi
 fi
 
 # Checking WEB Proxy
@@ -210,6 +231,11 @@ if [ -n "$ANTIVIRUS_SYSTEM" ] && [ "$ANTIVIRUS_SYSTEM" != 'remote' ]; then
 		if [ "$ANTIVIRUS_SYSTEM" == 'clamav' ]; then
 			ANTIVIRUS_SYSTEM='clamd'
 		fi
+		if [ -f /etc/redhat-release ]; then
+			if [ "$ANTIVIRUS_SYSTEM" == 'clamav-daemon' ]; then
+				ANTIVIRUS_SYSTEM='clamd'
+			fi
+		fi
 		get_srv_state "$ANTIVIRUS_SYSTEM"
 	else
 		if [ "$ANTIVIRUS_SYSTEM" == 'clamav-daemon' ]; then
@@ -302,8 +328,15 @@ fi
 # Checking FIREWALL system
 if [ -n "$FIREWALL_SYSTEM" ] && [ "$FIREWALL_SYSTEM" != 'remote' ]; then
 	state="stopped"
-	if $(iptables -S INPUT | grep -qx '\-P INPUT DROP'); then
-		state="running"
+	if [ -f /etc/redhat-release ]; then
+		RES=$(systemctl is-active nftables | grep -E "^active")
+		if [ -n "$RES" ]; then
+			state="running"
+		fi
+	else
+		if $(iptables -S INPUT | grep -qx '\-P INPUT DROP'); then
+			state="running"
+		fi
 	fi
 	data="$data\nNAME='$FIREWALL_SYSTEM' SYSTEM='firewall'"
 	data="$data STATE='$state' CPU='0' MEM='0' RTIME='0'"
diff --git a/bin/v-oneshot-service b/bin/v-oneshot-service
new file mode 100755
index 0000000..ab65dde
--- /dev/null
+++ b/bin/v-oneshot-service
@@ -0,0 +1,48 @@
+#!/bin/bash
+# info: prepare actions befor whole system will start
+# options: NONE
+#
+# example: v-oneshot-service
+#
+# This function prepares dir structure for such things
+# wich deleted on system shoutdown, run as root only
+
+# Includes
+# shellcheck source=/etc/hestiacp/hestia.conf
+source /etc/hestiacp/hestia.conf
+# shellcheck source=/usr/local/hestia/func/main.sh
+source $HESTIA/func/main.sh
+# load config file
+source_conf "$HESTIA/conf/hestia.conf"
+
+# Checking root permissions
+if [ "$(id -u)" != '0' ]; then
+	echo "Error: Script can be run executed only by root"
+	exit 10
+fi
+
+php_DIR="/run/php"
+#make php directory in /var/run/directory for php-fpm and for hestia-php
+if [ -f /etc/redhat-release ]; then
+	if [ ! -e "$php_DIR" ]; then
+		user_apache=$(cat $HESTIA_INSTALL_DIR/php-fpm/multiphp.tpl | grep listen.group | cut -d= -f2 | xargs)
+		if [ -n "$user_apache" ]; then
+			if grep -q "$user_apache" /etc/passwd; then
+				if grep -q "$user_apache" /etc/group; then
+					mkdir "$php_DIR"
+					chmod 755 "$php_DIR"
+					chown "$user_apache":"$user_apache" "$php_DIR"
+				fi
+			fi
+		fi
+	fi
+	if [ ! -e /run/hestia ]; then
+		mkdir /run/hestia
+		chown admin:admin /run/hestia
+	else
+		own=$(stat -c "%U:%G" /run/hestia)
+		if [ "$own" != "admin:admin" ]; then
+			chown admin:admin /run/hestia
+		fi
+	fi
+fi
\ No newline at end of file
diff --git a/bin/v-package-hook-checks b/bin/v-package-hook-checks
new file mode 100755
index 0000000..3dfab16
--- /dev/null
+++ b/bin/v-package-hook-checks
@@ -0,0 +1,26 @@
+#!/bin/bash
+# info: script for rpm package hook for correct rights checking
+# options: [NONE]
+#
+# This function check needed rights for stndar5d service configurations
+
+#----------------------------------------------------------#
+#                Variables & Functions                     #
+#----------------------------------------------------------#
+
+# Includes
+# shellcheck source=/etc/hestiacp/hestia.conf
+source /etc/hestiacp/hestia.conf
+# shellcheck source=/usr/local/hestia/func/main.sh
+source $HESTIA/func/main.sh
+# load config file
+source_conf "$HESTIA/conf/hestia.conf"
+# load config file
+source_conf "$HESTIA/install/upgrade/upgrade.conf"
+
+if [ -e /etc/ssh/sshd_config ]; then
+    stat -c "%a" /etc/ssh/sshd_config | grep -E "[0-9][4-7][4-7]"
+    if [ $? -ne 0 ]; then
+        chmod go+r /etc/ssh/sshd_config
+    fi
+fi
\ No newline at end of file
diff --git a/bin/v-rebuild-web-domain b/bin/v-rebuild-web-domain
index ece7488..3d6266f 100755
--- a/bin/v-rebuild-web-domain
+++ b/bin/v-rebuild-web-domain
@@ -52,34 +52,37 @@ check_hestia_demo_mode
 #                       Action                             #
 #----------------------------------------------------------#
 
+confd=$(get_conf_d_name "$WEB_SYSTEM")
+
 # Deleting old web configs
-if [ -e "/etc/$WEB_SYSTEM/conf.d/hestia.conf" ]; then
-	sed -i "/.*\/$user\/conf\/web\//d" /etc/$WEB_SYSTEM/conf.d/hestia.conf
+if [ -e "/etc/$WEB_SYSTEM/$confd/hestia.conf" ]; then
+	sed -i "/.*\/$user\/conf\/web\//d" /etc/$WEB_SYSTEM/$confd/hestia.conf
 fi
 
 if [ -e "$HOMEDIR/$user/conf/web/$domain/$WEB_SYSTEM.conf" ]; then
 	rm -f $HOMEDIR/$user/conf/web/$domain/$WEB_SYSTEM.conf
-	rm -f /etc/$WEB_SYSTEM/conf.d/domains/$domain.conf
+	rm -f /etc/$WEB_SYSTEM/$confd/domains/$domain.conf
 fi
 if [ -e "$HOMEDIR/$user/conf/web/$domain/$WEB_SYSTEM.ssl.conf" ]; then
 	rm $HOMEDIR/$user/conf/web/$domain/$WEB_SYSTEM.ssl.conf
-	rm -f /etc/$WEB_SYSTEM/conf.d/domains/$domain.ssl.conf
+	rm -f /etc/$WEB_SYSTEM/$confd/domains/$domain.ssl.conf
 fi
 
+pconfd=$(get_conf_d_name "$PROXY_SYSTEM")
 # Deleting old proxy configs
 if [ -n "$PROXY_SYSTEM" ]; then
-	if [ -e "/etc/$PROXY_SYSTEM/conf.d/hestia.conf" ]; then
-		sed -i "/.*\/$user\/conf\/web\//d" /etc/$PROXY_SYSTEM/conf.d/hestia.conf
+	if [ -e "/etc/$PROXY_SYSTEM/$pconfd/hestia.conf" ]; then
+		sed -i "/.*\/$user\/conf\/web\//d" /etc/$PROXY_SYSTEM/$pconfd/hestia.conf
 	fi
 
 	if [ -e "$HOMEDIR/$user/conf/web/$domain/$PROXY_SYSTEM.conf" ]; then
 		rm -f $HOMEDIR/$user/conf/web/$domain/$PROXY_SYSTEM.conf
-		rm -f /etc/$PROXY_SYSTEM/conf.d/domains/$domain.conf
+		rm -f /etc/$PROXY_SYSTEM/$pconfd/domains/$domain.conf
 	fi
 
 	if [ -e "$HOMEDIR/$user/conf/web/$domain/$PROXY_SYSTEM.ssl.conf" ]; then
 		rm -f $HOMEDIR/$user/conf/web/$domain/$PROXY_SYSTEM.ssl.conf
-		rm -f /etc/$PROXY_SYSTEM/conf.d/domains/$domain.ssl.conf
+		rm -f /etc/$PROXY_SYSTEM/$pconfd/domains/$domain.ssl.conf
 	fi
 fi
 
diff --git a/bin/v-rebuild-web-domains b/bin/v-rebuild-web-domains
index e74abd1..a55d0b3 100755
--- a/bin/v-rebuild-web-domains
+++ b/bin/v-rebuild-web-domains
@@ -49,35 +49,37 @@ check_hestia_demo_mode
 #----------------------------------------------------------#
 #                       Action                             #
 #----------------------------------------------------------#
+confd=$(get_conf_d_name "$WEB_SYSTEM")
+pconfd=$(get_conf_d_name "$PROXY_SYSTEM")
 
 # Deleting old web configs
-if [ -e "/etc/$WEB_SYSTEM/conf.d/hestia.conf" ]; then
-	sed -i "/.*\/$user\/conf\/web\//d" /etc/$WEB_SYSTEM/conf.d/hestia.conf
+if [ -e "/etc/$WEB_SYSTEM/$confd/hestia.conf" ]; then
+	sed -i "/.*\/$user\/conf\/web\//d" /etc/$WEB_SYSTEM/$confd/hestia.conf
 fi
 
 if [ -e "$HOMEDIR/$user/conf/web/$domain/$WEB_SYSTEM.conf" ]; then
 	rm -f $HOMEDIR/$user/conf/web/$domain/$WEB_SYSTEM.conf
-	rm -f /etc/$WEB_SYSTEM/conf.d/domains/$domain.conf
+	rm -f /etc/$WEB_SYSTEM/$confd/domains/$domain.conf
 fi
 if [ -e "$HOMEDIR/$user/conf/web/$domain/$WEB_SYSTEM.ssl.conf" ]; then
 	rm $HOMEDIR/$user/conf/web/$domain/$WEB_SYSTEM.ssl.conf
-	rm -f /etc/$WEB_SYSTEM/conf.d/domains/$domain.ssl.conf
+	rm -f /etc/$WEB_SYSTEM/$confd/domains/$domain.ssl.conf
 fi
 
 # Deleting old proxy configs
 if [ -n "$PROXY_SYSTEM" ]; then
-	if [ -e "/etc/$PROXY_SYSTEM/conf.d/hestia.conf" ]; then
-		sed -i "/.*\/$user\/conf\/web\//d" /etc/$PROXY_SYSTEM/conf.d/hestia.conf
+	if [ -e "/etc/$PROXY_SYSTEM/$pconfd/hestia.conf" ]; then
+		sed -i "/.*\/$user\/conf\/web\//d" /etc/$PROXY_SYSTEM/$pconfd/hestia.conf
 	fi
 
 	if [ -e "$HOMEDIR/$user/conf/web/$domain/$PROXY_SYSTEM.conf" ]; then
 		rm -f $HOMEDIR/$user/conf/web/$domain/$PROXY_SYSTEM.conf
-		rm -f /etc/$PROXY_SYSTEM/conf.d/domains/$domain.conf
+		rm -f /etc/$PROXY_SYSTEM/$pconfd/domains/$domain.conf
 	fi
 
 	if [ -e "$HOMEDIR/$user/conf/web/$domain/$PROXY_SYSTEM.ssl.conf" ]; then
 		rm -f $HOMEDIR/$user/conf/web/$domain/$PROXY_SYSTEM.ssl.conf
-		rm -f /etc/$PROXY_SYSTEM/conf.d/domains/$domain.ssl.conf
+		rm -f /etc/$PROXY_SYSTEM/$pconfd/domains/$domain.ssl.conf
 	fi
 fi
 
diff --git a/bin/v-restart-ftp b/bin/v-restart-ftp
index df026a3..57c5931 100755
--- a/bin/v-restart-ftp
+++ b/bin/v-restart-ftp
@@ -23,8 +23,12 @@ send_email_report() {
 	email=$(echo "$email" | cut -f 2 -d "'")
 	tmpfile=$(mktemp)
 	subj="$(hostname): $FTP_SYSTEM restart failed"
-	service "$FTP_SYSTEM" configtest >> $tmpfile 2>&1
-	service "$FTP_SYSTEM" restart >> $tmpfile 2>&1
+	if [ -f /etc/redhat-release ]; then
+		systemctl restart "$FTP_SYSTEM" >> $tmpfile 2>&1
+	else
+		service "$FTP_SYSTEM" configtest >> $tmpfile 2>&1
+		service "$FTP_SYSTEM" restart >> $tmpfile 2>&1
+	fi
 	cat $tmpfile | $SENDMAIL -s "$subj" $email
 	rm -f $tmpfile
 }
diff --git a/bin/v-restart-proxy b/bin/v-restart-proxy
index 9ea8fec..0e61f00 100755
--- a/bin/v-restart-proxy
+++ b/bin/v-restart-proxy
@@ -70,13 +70,20 @@ if [ -f "$HESTIA/web/inc/nginx_proxy" ]; then
 	if [ "$1" = 'background' ]; then
 		# Restart system
 		sleep 15
-
 		# Preform a check if Nginx is valid as reload doesn't throw an error / exit
 		if [ "$DEBUG_MODE" = "true" ]; then
 			echo "[ $date | $PROXY_SYSTEM ]" >> /var/log/hestia/debug.log 2>&1
-			service $PROXY_SYSTEM configtest >> /var/log/hestia/debug.log 2>&1
+			if [ -f /etc/redhat-release ]; then
+				$BIN/v-check-service-config "$PROXY_SYSTEM" /var/log/hestia/debug.log
+			else
+				service $PROXY_SYSTEM configtest >> /var/log/hestia/debug.log 2>&1
+			fi
 		else
-			service $PROXY_SYSTEM configtest > /dev/null 2>&1
+			if [ -f /etc/redhat-release ]; then
+				$BIN/v-check-service-config "$PROXY_SYSTEM" /dev/null
+			else
+				service $PROXY_SYSTEM configtest > /dev/null 2>&1
+			fi
 		fi
 		if [ $? -ne 0 ]; then
 			send_email_report
@@ -100,9 +107,17 @@ else
 	# Preform a check if Nginx is valid as reload doesn't throw an error / exit
 	if [ "$DEBUG_MODE" = "true" ]; then
 		echo "[ $date | $PROXY_SYSTEM ]" >> /var/log/hestia/debug.log 2>&1
-		service $PROXY_SYSTEM configtest >> /var/log/hestia/debug.log 2>&1
+		if [ -f /etc/redhat-release ]; then
+			$BIN/v-check-service-config "$PROXY_SYSTEM" /var/log/hestia/debug.log
+		else
+			service $PROXY_SYSTEM configtest >> /var/log/hestia/debug.log 2>&1
+		fi
 	else
-		service $PROXY_SYSTEM configtest > /dev/null 2>&1
+		if [ -f /etc/redhat-release ]; then
+			$BIN/v-check-service-config "$PROXY_SYSTEM" /dev/null
+		else
+			service $PROXY_SYSTEM configtest > /dev/null 2>&1
+		fi
 	fi
 	if [ $? -ne 0 ]; then
 		send_email_report
diff --git a/bin/v-restart-service b/bin/v-restart-service
index a04b665..9898e5d 100755
--- a/bin/v-restart-service
+++ b/bin/v-restart-service
@@ -38,6 +38,10 @@ if [ "$DEBUG_MODE" = "true" ]; then
 	log="/var/log/hestia/debug.log"
 fi
 
+if [ "$service" = "cron" ] && [ -f /etc/redhat-release ]; then
+	service="crond"
+fi
+
 # Multi-instance service restart request handling
 if [ "$service" = "php-fpm" ]; then
 	service_list=''
diff --git a/bin/v-restart-web b/bin/v-restart-web
index 2ddd88f..332bb21 100755
--- a/bin/v-restart-web
+++ b/bin/v-restart-web
@@ -28,7 +28,11 @@ send_email_report() {
 	if [ "$WEB_SYSTEM" = "apache2" ]; then
 		apache2ctl configtest >> "$tmpfile" 2>&1
 	else
-		service $WEB_SYSTEM configtest >> "$tmpfile" 2>&1
+		if [ -f /etc/redhat-release ]; then
+			$BIN/v-check-service-config "$WEB_SYSTEM" "$tmpfile"
+		else
+			service $WEB_SYSTEM configtest >> "$tmpfile" 2>&1
+		fi
 	fi
 	if [ "$1" == "DO_RESTART" ]; then
 		service "$WEB_SYSTEM" restart >> "$tmpfile" 2>&1
@@ -74,9 +78,17 @@ if [ $WEB_SYSTEM = 'nginx' ]; then
 	fi
 	if [ "$DEBUG_MODE" = "true" ]; then
 		echo "[  $date | $WEB_SYSTEM | WEB ]" >> /var/log/hestia/debug.log 2>&1
-		service $WEB_SYSTEM configtest >> /var/log/hestia/debug.log 2>&1
+		if [ -f /etc/redhat-release ]; then
+			$BIN/v-check-service-config "$WEB_SYSTEM"
+		else
+			service $WEB_SYSTEM configtest >> /var/log/hestia/debug.log 2>&1
+		fi
 	else
-		service $WEB_SYSTEM configtest > /dev/null 2>&1
+		if [ -f /etc/redhat-release ]; then
+			$BIN/v-check-service-config "$WEB_SYSTEM" /dev/null
+		else
+			service $WEB_SYSTEM configtest > /dev/null 2>&1
+		fi
 	fi
 	if [ $? -ne 0 ]; then
 		send_email_report
@@ -93,6 +105,17 @@ elif [ $WEB_SYSTEM = 'apache2' ]; then
 		send_email_report
 		check_result "$E_RESTART" "$WEB_SYSTEM restart failed"
 	fi
+elif [ $WEB_SYSTEM = 'httpd' ]; then
+	if [ "$DEBUG_MODE" = "true" ]; then
+		echo "[  $date | $WEB_SYSTEM | WEB ]" >> /var/log/hestia/debug.log 2>&1
+		$BIN/v-check-service-config "$WEB_SYSTEM" /var/log/hestia/debug.log
+	else
+		$BIN/v-check-service-config "$WEB_SYSTEM" /dev/null
+	fi
+	if [ $? -ne 0 ]; then
+		send_email_report
+		check_result "$E_RESTART" "$WEB_SYSTEM restart failed"
+	fi
 fi
 
 $BIN/v-restart-service "$WEB_SYSTEM" "$restart"
diff --git a/bin/v-restart-web-backend b/bin/v-restart-web-backend
index e3437bc..7d79c48 100755
--- a/bin/v-restart-web-backend
+++ b/bin/v-restart-web-backend
@@ -9,6 +9,9 @@
 restart=$1
 # For backward compatibility might change in the feature
 version=$2
+if [ -f "/etc/redhat-release" ]; then
+	version="${version//./}"
+fi
 
 #----------------------------------------------------------#
 #                Variables & Functions                     #
@@ -55,10 +58,21 @@ tmpfile=$(mktemp)
 if [ -z "$version" ]; then
 	# Substitute php-fpm service name formats
 	for version in $($BIN/v-list-sys-php plain); do
-		v_php="php$version-fpm"
-		if [ ! -f "/etc/php/${version}/fpm/pool.d/dummy.conf" ]; then
-			cp -f "$HESTIA_INSTALL_DIR/php-fpm/dummy.conf" "/etc/php/${version}/fpm/pool.d/"
-			sed -i "s/9999/99${version//./}/g" "/etc/php/${version}/fpm/pool.d/dummy.conf"
+		if [ -f /etc/redhat-release ]; then
+			v_php="php$version-php-fpm"
+		else
+			v_php="php$version-fpm"
+		fi
+		if [ -f /etc/redhat-release ]; then
+			if [ ! -f "/etc/opt/remi/php${version}/php-fpm.d/dummy.conf" ]; then
+				cp -f $HESTIA_INSTALL_DIR/php-fpm/dummy.conf /etc/opt/remi/php${version}/php-fpm.d/
+				sed -i "s/9999/99$v_tpl/g" /etc/opt/remi/php${version}/php-fpm.d/dummy.conf
+			fi
+		else
+			if [ ! -f "/etc/php/${version}/fpm/pool.d/dummy.conf" ]; then
+				cp -f "$HESTIA_INSTALL_DIR/php-fpm/dummy.conf" "/etc/php/${version}/fpm/pool.d/"
+				sed -i "s/9999/99${version//./}/g" "/etc/php/${version}/fpm/pool.d/dummy.conf"
+			fi
 		fi
 
 		$BIN/v-restart-service "$v_php" "$restart"
@@ -68,7 +82,11 @@ if [ -z "$version" ]; then
 		fi
 	done
 else
-	v_php="php$version-fpm"
+	if [ -f /etc/redhat-release ]; then
+		v_php="php$version-php-fpm"
+	else
+		v_php="php$version-fpm"
+	fi
 	$BIN/v-restart-service "$v_php" "$restart"
 	if [ $? -ne 0 ]; then
 		send_email_report
diff --git a/bin/v-start-service b/bin/v-start-service
index 6ef8f8a..5698f0b 100755
--- a/bin/v-start-service
+++ b/bin/v-start-service
@@ -42,6 +42,16 @@ fi
 
 for service in $service_list; do
 	if [ "$service" = "iptables" ]; then
+		if [ -f /etc/redhat-release ]; then
+			RES=$(systemctl is-enabled nftables | grep enabled)
+			if [ -z "$RES" ]; then
+				systemctl enable nftables --now
+			fi
+			systemctl status nftables
+			if [ $? -ne 0 ]; then
+				systemctl start nftables
+			fi
+		fi
 		$BIN/v-update-firewall
 	else
 		systemctl start "$service"
diff --git a/bin/v-update-firewall b/bin/v-update-firewall
index 1c7d743..ef1bef3 100755
--- a/bin/v-update-firewall
+++ b/bin/v-update-firewall
@@ -1,6 +1,6 @@
 #!/bin/bash
 # info: update system firewall rules
-# options: NONE
+# options: no opts
 #
 # example: v-update-firewall
 #
@@ -46,18 +46,26 @@ if [ ! -e "$rules" ]; then
 	exit
 fi
 
-# Checking conntrack module avaiabilty
-$modprobe nf_conntrack > /dev/null 2>&1
-if [ $? -ne 0 ]; then
-	$sysctl net.netfilter.nf_conntrack_max > /dev/null 2>&1
+if [ -f /etc/redhat-release ]; then
+	conntrack='yes'
+else
+	# Checking conntrack module avaiabilty
+	$modprobe nf_conntrack > /dev/null 2>&1
 	if [ $? -ne 0 ]; then
-		conntrack='no'
+		$sysctl net.netfilter.nf_conntrack_max > /dev/null 2>&1
+		if [ $? -ne 0 ]; then
+			conntrack='no'
+		fi
 	fi
 fi
 
-$modprobe nf_conntrack_ftp > /dev/null 2>&1
-if [ $? -ne 0 ]; then
-	conntrack_ftp='no'
+if [ -f /etc/redhat-release ]; then
+	conntrack_ftp='yes'
+else
+	$modprobe nf_conntrack_ftp > /dev/null 2>&1
+	if [ $? -ne 0 ]; then
+		conntrack_ftp='no'
+	fi
 fi
 
 # Checking custom OpenSSH  port
diff --git a/bin/v-update-sys-hestia-git b/bin/v-update-sys-hestia-git
index 47c0680..2f941c0 100755
--- a/bin/v-update-sys-hestia-git
+++ b/bin/v-update-sys-hestia-git
@@ -26,6 +26,12 @@ nodejs_ver="20"
 # Perform verification if read-only mode is enabled
 check_hestia_demo_mode
 
+#TODO
+#Temporary disable for RPM
+if [ -f /etc/redhat-release ]; then
+	exit 0
+fi
+
 # Detect and install NodeJS if necessary
 if [ -z $(which "node") ]; then
 	read -p "NodeJS not found. Install now to proceed? [Y/n] " answer
diff --git a/bin/v-update-sys-ip b/bin/v-update-sys-ip
index 1d3720c..1f3ee00 100755
--- a/bin/v-update-sys-ip
+++ b/bin/v-update-sys-ip
@@ -36,6 +36,9 @@ check_hestia_demo_mode
 #                       Action                             #
 #----------------------------------------------------------#
 
+confd=$(get_conf_d_name "$WEB_SYSTEM")
+pconfd=$(get_conf_d_name "$PROXY_SYSTEM")
+
 # Listing system IP addresses
 nics="$(ip -d -j link show | jq -r '.[] | if .link_type == "loopback" then empty else .ifname end')"
 
@@ -83,7 +86,7 @@ if [ -n "$old_ip" ]; then
 
 	# Updating PROXY
 	if [ -n "$PROXY_SYSTEM" ]; then
-		cd /etc/$PROXY_SYSTEM/conf.d
+		cd /etc/$PROXY_SYSTEM/$pconfd
 		if [ -e "$old_ip.conf" ]; then
 			mv $old_ip.conf $new_ip.conf
 			sed -i "s/$old_ip/$new_ip/g" $new_ip.conf
@@ -92,7 +95,7 @@ if [ -n "$old_ip" ]; then
 
 	# Updating WEB
 	if [ -n "$WEB_SYSTEM" ]; then
-		cd /etc/$WEB_SYSTEM/conf.d
+		cd /etc/$WEB_SYSTEM/$confd
 
 		if [ -e "$old_ip.conf" ]; then
 			mv $old_ip.conf $new_ip.conf
@@ -164,11 +167,16 @@ for ip in $ips; do
 done
 
 # Updating NAT
-pub_ipv4="$(curl -fsLm5 --retry 2 --ipv4 https://ip.hestiacp.com/)"
-if [ ! -e "$HESTIA/data/ips/$pub_ipv4" ]; then
-	if [ -z "$(grep -R "$pub_ipv4" $HESTIA/data/ips/)" ]; then
-		ip="$(ls -t $HESTIA/data/ips/ | head -n1)"
-		$BIN/v-change-sys-ip-nat "$ip" "$pub_ipv4"
+if [ -e $HESTIA/conf/nopublickip ]; then
+	ip="$(ls -t $HESTIA/data/ips/ | head -n1)"
+	$BIN/v-change-sys-ip-nat "$ip" "$ip"
+else
+	pub_ipv4="$(curl -fsLm5 --retry 2 --ipv4 https://ip.hestiacp.com/)"
+	if [ ! -e "$HESTIA/data/ips/$pub_ipv4" ]; then
+		if [ -z "$(grep -R "$pub_ipv4" $HESTIA/data/ips/)" ]; then
+			ip="$(ls -t $HESTIA/data/ips/ | head -n1)"
+			$BIN/v-change-sys-ip-nat "$ip" "$pub_ipv4"
+		fi
 	fi
 fi
 
diff --git a/bin/v-update-white-label-logo b/bin/v-update-white-label-logo
index 4cfade4..d6aaa26 100755
--- a/bin/v-update-white-label-logo
+++ b/bin/v-update-white-label-logo
@@ -30,31 +30,31 @@ source_conf "$HESTIA/conf/hestia.conf"
 if [ -f "$HESTIA/web/images/custom/logo.svg" ]; then
 	cp -f $HESTIA/web/images/custom/logo.svg $HESTIA/web/images/logo.svg
 elif [ ! -f "$HESTIA/web/images/custom/logo.svg" ] && [ "$download" = "yes" ]; then
-	download_file https://raw.githubusercontent.com/hestiacp/hestiacp/release/web/images/logo.svg $HESTIA/web/images/logo.svg
+	download_file https://dev.putey.net/bayrepo/hestiacp/raw/branch/master/web/images/logo.svg $HESTIA/web/images/logo.svg
 fi
 
 if [ -f "$HESTIA/web/images/custom/logo.png" ]; then
 	cp -f $HESTIA/web/images/custom/logo.png $HESTIA/web/images/logo.png
 elif [ ! -f "$HESTIA/web/images/custom/logo.png" ] && [ "$download" = "yes" ]; then
-	download_file https://raw.githubusercontent.com/hestiacp/hestiacp/release/web/images/logo.png $HESTIA/web/images/logo.png
+	download_file https://dev.putey.net/bayrepo/hestiacp/raw/branch/master/web/images/logo.png $HESTIA/web/images/logo.png
 fi
 
 if [ -f "$HESTIA/web/images/custom/logo-header.svg" ]; then
 	cp -f $HESTIA/web/images/custom/logo-header.svg $HESTIA/web/images/logo-header.svg
 elif [ ! -f "$HESTIA/web/images/custom/logo-header.svg" ] && [ "$download" = "yes" ]; then
-	download_file https://raw.githubusercontent.com/hestiacp/hestiacp/release/web/images/logo-header.svg $HESTIA/web/images/logo-header.svg
+	download_file https://dev.putey.net/bayrepo/hestiacp/raw/branch/master/web/images/logo-header.svg $HESTIA/web/images/logo-header.svg
 fi
 
 if [ -f "$HESTIA/web/images/custom/favicon.png" ]; then
 	cp -f $HESTIA/web/images/custom/favicon.png $HESTIA/web/images/favicon.png
 elif [ ! -f "$HESTIA/web/images/custom/favicon.png" ] && [ "$download" = "yes" ]; then
-	download_file https://raw.githubusercontent.com/hestiacp/hestiacp/release/web/images/favicon.png $HESTIA/web/images/favicon.png
+	download_file https://dev.putey.net/bayrepo/hestiacp/raw/branch/master/web/images/favicon.png $HESTIA/web/images/favicon.png
 fi
 
 if [ -f "$HESTIA/web/images/custom/favicon.ico" ]; then
 	cp -f $HESTIA/web/images/custom/favicon.ico $HESTIA/web/favicon.ico
 elif [ ! -f "$HESTIA/web/images/custom/favicon.ico" ] && [ "$download" = "yes" ]; then
-	download_file https://raw.githubusercontent.com/hestiacp/hestiacp/release/web/favicon.ico $HESTIA/web/favicon.ico
+	download_file https://dev.putey.net/bayrepo/hestiacp/raw/branch/master/web/favicon.ico $HESTIA/web/favicon.ico
 fi
 
 #----------------------------------------------------------#
diff --git a/docs/.vitepress/theme/components/InstallOptions.vue b/docs/.vitepress/theme/components/InstallOptions.vue
index 82575ba..07657ad 100644
--- a/docs/.vitepress/theme/components/InstallOptions.vue
+++ b/docs/.vitepress/theme/components/InstallOptions.vue
@@ -13,7 +13,7 @@ export default {
 		return {
 			pageloader: false,
 			hestia_wget:
-				"wget https://raw.githubusercontent.com/hestiacp/hestiacp/release/install/hst-install.sh",
+				"wget https://dev.putey.net/bayrepo/hestiacp/raw/branch/master/install/hst-install.sh",
 			hestia_install: "sudo bash hst-install.sh",
 			installStr: "",
 		};
diff --git a/docs/docs/introduction/getting-started.md b/docs/docs/introduction/getting-started.md
index b4ec9ea..343169a 100644
--- a/docs/docs/introduction/getting-started.md
+++ b/docs/docs/introduction/getting-started.md
@@ -43,7 +43,7 @@ Interactive installer that will install the default Hestia software configuratio
 Download the installation script for the latest release:
 
 ```bash
-wget https://raw.githubusercontent.com/hestiacp/hestiacp/release/install/hst-install.sh
+wget https://dev.putey.net/bayrepo/hestiacp/raw/branch/master/install/hst-install.sh
 ```
 
 If the download fails due to an SSL validation error, please be sure you've installed the ca-certificate package on your system - you can do this with the following command:
diff --git a/docs/docs/server-administration/databases.md b/docs/docs/server-administration/databases.md
index f997bad..1b23bcd 100644
--- a/docs/docs/server-administration/databases.md
+++ b/docs/docs/server-administration/databases.md
@@ -36,6 +36,21 @@ systemctl restart apache2
 IncludeOptional /etc/apache2/conf.d/*.inc
 ```
 
+### For httpd
+
+```bash
+nano /etc/httpd/conf.h.d/ip.conf
+
+# Add the following code before both </VirtualHost> closing tags
+IncludeOptional /etc/httpd/conf.h.d/*.inc
+
+# Restart apache2
+systemctl restart httpd
+
+# You can also add the following in /etc/apache2.conf instead
+IncludeOptional /etc/httpd/conf.h.d/*.inc
+```
+
 ### For Nginx
 
 ```bash
diff --git a/func/domain.sh b/func/domain.sh
index 4263dce..ef94b43 100644
--- a/func/domain.sh
+++ b/func/domain.sh
@@ -103,7 +103,7 @@ prepare_web_backend() {
 	local backend_template=${1:-$template}
 
 	if [ -f "/etc/redhat-release" ]; then
-		pool=$(find -L /etc/opt/remi/php80/ -name "$domain.conf" -exec dirname {} \;)
+		pool=$(find -L /etc/opt/remi/php80/ -name "$domain.conf" -exec dirname {} \; 2>/dev/null)
 	else
 		pool=$(find -L /etc/php/ -name "$domain.conf" -exec dirname {} \;)
 	fi
@@ -121,7 +121,8 @@ prepare_web_backend() {
 		backend_version=$(multiphp_default_version)
 		if [ -z "$pool" ] || [ -z "$BACKEND" ]; then
 			if [ -f "/etc/redhat-release" ]; then
-				pool=$(find -L /etc/opt/remi/php80 -type d \( -name "pool.d" -o -name "*fpm.d" \))
+				m_backend_version="${backend_version//./}"
+				pool=$(find -L /etc/opt/remi/php$m_backend_version -type d \( -name "pool.d" -o -name "*fpm.d" \))
 			else
 				pool=$(find -L /etc/php/$backend_version -type d \( -name "pool.d" -o -name "*fpm.d" \))
 			fi
@@ -146,7 +147,11 @@ prepare_web_backend() {
 
 # Delete web backend
 delete_web_backend() {
+if [ -f "/etc/redhat-release" ]; then
+	find -L /etc/opt/remi/ -name "$backend_type.conf" -exec rm -f {} \;
+else
 	find -L /etc/php/ -type f -name "$backend_type.conf" -exec rm -f {} \;
+fi
 }
 
 # Prepare web aliases
@@ -248,6 +253,12 @@ prepare_web_domain_values() {
 # Add web config
 add_web_config() {
 	# Check if folder already exists
+	if [ "$1" = "httpd" ]; then
+		confd="conf.h.d"
+	else
+		confd="conf.d"
+	fi
+
 	if [ ! -d "$HOMEDIR/$user/conf/web/$domain" ]; then
 		mkdir -p "$HOMEDIR/$user/conf/web/$domain/"
 	fi
@@ -308,8 +319,8 @@ add_web_config() {
 	chmod 640 $conf
 
 	if [[ "$2" =~ stpl$ ]]; then
-		rm -f /etc/$1/conf.d/domains/$domain.ssl.conf
-		ln -s $conf /etc/$1/conf.d/domains/$domain.ssl.conf
+		rm -f /etc/$1/$confd/domains/$domain.ssl.conf
+		ln -s $conf /etc/$1/$confd/domains/$domain.ssl.conf
 
 		# Rename/Move extra SSL config files
 		find=$(find $HOMEDIR/$user/conf/web/*.$domain.org* 2> /dev/null)
@@ -325,8 +336,8 @@ add_web_config() {
 			fi
 		done
 	else
-		rm -f /etc/$1/conf.d/domains/$domain.conf
-		ln -s $conf /etc/$1/conf.d/domains/$domain.conf
+		rm -f /etc/$1/$confd/domains/$domain.conf
+		ln -s $conf /etc/$1/$confd/domains/$domain.conf
 		# Rename/Move extra config files
 		find=$(find $HOMEDIR/$user/conf/web/*.$domain.org* 2> /dev/null)
 		for f in $find; do
@@ -393,6 +404,11 @@ replace_web_config() {
 
 # Delete web configuration
 del_web_config() {
+	if [ "$1" = "httpd" ]; then
+		confd="conf.h.d"
+	else
+		confd="conf.d"
+	fi
 	conf="$HOMEDIR/$user/conf/web/$domain/$1.conf"
 	local confname="$domain.conf"
 	if [[ "$2" =~ stpl$ ]]; then
@@ -409,17 +425,17 @@ del_web_config() {
 		rm -f $legacyconf
 
 		# Remove old global includes file
-		rm -f /etc/$1/conf.d/hestia.conf
+		rm -f /etc/$1/$confd/hestia.conf
 	fi
 
 	# Remove domain configuration files and clean up symbolic links
 	rm -f "$conf"
 
 	if [ -n "$WEB_SYSTEM" ] && [ "$WEB_SYSTEM" = "$1" ]; then
-		rm -f "/etc/$WEB_SYSTEM/conf.d/domains/$confname"
+		rm -f "/etc/$WEB_SYSTEM/$confd/domains/$confname"
 	fi
 	if [ -n "$PROXY_SYSTEM" ] && [ "$PROXY_SYSTEM" = "$1" ]; then
-		rm -f "/etc/$PROXY_SYSTEM/conf.d/domains/$confname"
+		rm -f "/etc/$PROXY_SYSTEM/$confd/domains/$confname"
 	fi
 }
 
@@ -786,6 +802,16 @@ add_mail_ssl_config() {
 
 # Delete SSL support for mail domain
 del_mail_ssl_config() {
+	if [ "$WEB_SYSTEM" = "httpd" ]; then
+		confd="conf.h.d"
+	else
+		confd="conf.d"
+	fi
+	if [ "$PROXY_SYSTEM" = "httpd" ]; then
+		pconfd="conf.h.d"
+	else
+		pconfd="conf.d"
+	fi
 	# Check to prevent accidental removal of mismatched certificate
 	wildcard_domain="\\*.$(echo "$domain" | cut -f 1 -d . --complement)"
 	mail_cert_match=$($BIN/v-list-mail-domain-ssl $user $domain | awk '/SUBJECT|ALIASES/' | grep -wE " $domain| $wildcard_domain")
@@ -798,8 +824,8 @@ del_mail_ssl_config() {
 
 	# Remove SSL vhost configuration
 	rm -f $HOMEDIR/$user/conf/mail/$domain/*.*ssl.conf
-	rm -f /etc/$WEB_SYSTEM/conf.d/domains/$WEBMAIL_ALIAS.$domain.ssl.conf
-	rm -f /etc/$PROXY_SYSTEM/conf.d/domains/$WEBMAIL_ALIAS.$domain.ssl.conf
+	rm -f /etc/$WEB_SYSTEM/$confd/domains/$WEBMAIL_ALIAS.$domain.ssl.conf
+	rm -f /etc/$PROXY_SYSTEM/$pconfd/domains/$WEBMAIL_ALIAS.$domain.ssl.conf
 
 	# Remove SSL certificates
 	rm -f $HOMEDIR/$user/conf/mail/$domain/ssl/*
@@ -820,6 +846,11 @@ del_mail_ssl_certificates() {
 
 # Add webmail config
 add_webmail_config() {
+	if [ "$1" = "httpd" ]; then
+		confd="conf.h.d"
+	else
+		confd="conf.d"
+	fi
 	mkdir -p "$HOMEDIR/$user/conf/mail/$domain"
 	conf="$HOMEDIR/$user/conf/mail/$domain/$1.conf"
 	if [[ "$2" =~ stpl$ ]]; then
@@ -882,13 +913,13 @@ add_webmail_config() {
 	if [[ "$2" =~ stpl$ ]]; then
 		if [ -n "$WEB_SYSTEM" ]; then
 			forcessl="$HOMEDIR/$user/conf/mail/$domain/$WEB_SYSTEM.forcessl.conf"
-			rm -f /etc/$1/conf.d/domains/$WEBMAIL_ALIAS.$domain.ssl.conf
-			ln -s $conf /etc/$1/conf.d/domains/$WEBMAIL_ALIAS.$domain.ssl.conf
+			rm -f /etc/$1/$confd/domains/$WEBMAIL_ALIAS.$domain.ssl.conf
+			ln -s $conf /etc/$1/$confd/domains/$WEBMAIL_ALIAS.$domain.ssl.conf
 		fi
 		if [ -n "$PROXY_SYSTEM" ]; then
 			forcessl="$HOMEDIR/$user/conf/mail/$domain/$PROXY_SYSTEM.forcessl.conf"
-			rm -f /etc/$1/conf.d/domains/$WEBMAIL_ALIAS.$domain.ssl.conf
-			ln -s $conf /etc/$1/conf.d/domains/$WEBMAIL_ALIAS.$domain.ssl.conf
+			rm -f /etc/$1/$confd/domains/$WEBMAIL_ALIAS.$domain.ssl.conf
+			ln -s $conf /etc/$1/$confd/domains/$WEBMAIL_ALIAS.$domain.ssl.conf
 		fi
 
 		# Add rewrite rules to force HTTPS/SSL connections
@@ -903,12 +934,12 @@ add_webmail_config() {
 		find $HOMEDIR/$user/conf/mail/ -maxdepth 1 -type f \( -name "$domain.*" -o -name "ssl.$domain.*" -o -name "*nginx.$domain.*" \) -exec rm {} \;
 	else
 		if [ -n "$WEB_SYSTEM" ]; then
-			rm -f /etc/$1/conf.d/domains/$WEBMAIL_ALIAS.$domain.conf
-			ln -s $conf /etc/$1/conf.d/domains/$WEBMAIL_ALIAS.$domain.conf
+			rm -f /etc/$1/$confd/domains/$WEBMAIL_ALIAS.$domain.conf
+			ln -s $conf /etc/$1/$confd/domains/$WEBMAIL_ALIAS.$domain.conf
 		fi
 		if [ -n "$PROXY_SYSTEM" ]; then
-			rm -f /etc/$1/conf.d/domains/$WEBMAIL_ALIAS.$domain.conf
-			ln -s $conf /etc/$1/conf.d/domains/$WEBMAIL_ALIAS.$domain.conf
+			rm -f /etc/$1/$confd/domains/$WEBMAIL_ALIAS.$domain.conf
+			ln -s $conf /etc/$1/$confd/domains/$WEBMAIL_ALIAS.$domain.conf
 		fi
 		# Clear old configurations
 		find $HOMEDIR/$user/conf/mail/ -maxdepth 1 -type f \( -name "$domain.*" \) -exec rm {} \;
@@ -917,27 +948,47 @@ add_webmail_config() {
 
 # Delete webmail support
 del_webmail_config() {
+	if [ "$WEB_SYSTEM" = "httpd" ]; then
+		confd="conf.h.d"
+	else
+		confd="conf.d"
+	fi
+	if [ "$PROXY_SYSTEM" = "httpd" ]; then
+		pconfd="conf.h.d"
+	else
+		pconfd="conf.d"
+	fi
 	if [ -n "$WEB_SYSTEM" ]; then
-		rm -f $HOMEDIR/$user/conf/mail/$domain/$WEB_SYSTEM.conf
-		rm -f /etc/$WEB_SYSTEM/conf.d/domains/$WEBMAIL_ALIAS.$domain.conf
+		rm -f $HOMEDIR/$user/$confd/mail/$domain/$WEB_SYSTEM.conf
+		rm -f /etc/$WEB_SYSTEM/$confd/domains/$WEBMAIL_ALIAS.$domain.conf
 	fi
 
 	if [ -n "$PROXY_SYSTEM" ]; then
 		rm -f $HOMEDIR/$user/conf/mail/$domain/$PROXY_SYSTEM.*conf
-		rm -f /etc/$PROXY_SYSTEM/conf.d/domains/$WEBMAIL_ALIAS.$domain.conf
+		rm -f /etc/$PROXY_SYSTEM/$pconfd/domains/$WEBMAIL_ALIAS.$domain.conf
 	fi
 }
 
 # Delete SSL webmail support
 del_webmail_ssl_config() {
+	if [ "$WEB_SYSTEM" = "httpd" ]; then
+		confd="conf.h.d"
+	else
+		confd="conf.d"
+	fi
+	if [ "$PROXY_SYSTEM" = "httpd" ]; then
+		pconfd="conf.h.d"
+	else
+		pconfd="conf.d"
+	fi
 	if [ -n "$WEB_SYSTEM" ]; then
 		rm -f $HOMEDIR/$user/conf/mail/$domain/$WEB_SYSTEM.*ssl.conf
-		rm -f /etc/$WEB_SYSTEM/conf.d/domains/$WEBMAIL_ALIAS.$domain.ssl.conf
+		rm -f /etc/$WEB_SYSTEM/$confd/domains/$WEBMAIL_ALIAS.$domain.ssl.conf
 	fi
 
 	if [ -n "$PROXY_SYSTEM" ]; then
 		rm -f $HOMEDIR/$user/conf/mail/$domain/$PROXY_SYSTEM.*ssl.conf
-		rm -f /etc/$PROXY_SYSTEM/conf.d/domains/$WEBMAIL_ALIAS.$domain.ssl.conf
+		rm -f /etc/$PROXY_SYSTEM/$pconfd/domains/$WEBMAIL_ALIAS.$domain.ssl.conf
 	fi
 }
 
diff --git a/func/main.sh b/func/main.sh
index 229fdc7..e35e5c4 100644
--- a/func/main.sh
+++ b/func/main.sh
@@ -14,7 +14,11 @@ BACKUP_DISK_LIMIT=95
 BACKUP_LA_LIMIT=$(cat /proc/cpuinfo | grep processor | wc -l)
 RRD_STEP=300
 BIN=$HESTIA/bin
-HESTIA_INSTALL_DIR="$HESTIA/install/deb"
+if [ -f /etc/redhat-release ]; then
+	HESTIA_INSTALL_DIR="$HESTIA/install/rpm"
+else
+	HESTIA_INSTALL_DIR="$HESTIA/install/deb"
+fi
 HESTIA_COMMON_DIR="$HESTIA/install/common"
 HESTIA_BACKUP="/root/hst_backups/$(date +%d%m%Y%H%M)"
 HESTIA_PHP="$HESTIA/php/bin/php"
@@ -24,7 +28,7 @@ MAILTPL=$HESTIA/data/templates/mail
 DNSTPL=$HESTIA/data/templates/dns
 RRD=$HESTIA/web/rrd
 SENDMAIL="$HESTIA/web/inc/mail-wrapper.php"
-HESTIA_GIT_REPO="https://raw.githubusercontent.com/hestiacp/hestiacp"
+HESTIA_GIT_REPO="https://dev.putey.net/bayrepo/hestiacp"
 HESTIA_THEMES="$HESTIA/web/css/themes"
 HESTIA_THEMES_CUSTOM="$HESTIA/web/css/themes/custom"
 SCRIPT="$(basename $0)"
@@ -1712,3 +1716,18 @@ search_command_arg_position() {
 
 	echo "$position"
 }
+
+# Convert version X.X to XX
+convert_dot_version_to_non_dot() {
+	version="$1"
+	echo "${version//./}"
+}
+
+# Get conf,d name according to web system
+get_conf_d_name(){
+	if [ "$1" = "httpd" ]; then
+		echo "conf.h.d"
+	else
+		echo "conf.d"
+	fi
+}
\ No newline at end of file
diff --git a/func/rebuild.sh b/func/rebuild.sh
index ece6961..6455206 100644
--- a/func/rebuild.sh
+++ b/func/rebuild.sh
@@ -221,13 +221,27 @@ rebuild_user_conf() {
 
 # WEB domain rebuild
 rebuild_web_domain_conf() {
+	WWW_USER="www-data"
+	if [ -f /etc/redhat-release ]; then
+    	WWW_USER="apache"
+	fi
 
+	if [ "$WEB_SYSTEM" = "httpd" ]; then
+		confd="conf.h.d"
+	else
+		confd="conf.d"
+	fi
+	if [ "$PROXY_SYSTEM" = "httpd" ]; then
+		pconfd="conf.h.d"
+	else
+		pconfd="conf.d"
+	fi
 	# Ensure that global domain folders are available
-	if [ ! -d /etc/$WEB_SYSTEM/conf.d/domains ]; then
-		mkdir -p /etc/$WEB_SYSTEM/conf.d/domains
+	if [ ! -d /etc/$WEB_SYSTEM/$confd/domains ]; then
+		mkdir -p /etc/$WEB_SYSTEM/$confd/domains
 	fi
-	if [ ! -d /etc/$PROXY_SYSTEM/conf.d/domains ]; then
-		mkdir -p /etc/$PROXY_SYSTEM/conf.d/domains
+	if [ ! -d /etc/$PROXY_SYSTEM/$pconfd/domains ]; then
+		mkdir -p /etc/$PROXY_SYSTEM/$pconfd/domains
 	fi
 
 	syshealth_repair_web_config
@@ -236,11 +250,11 @@ rebuild_web_domain_conf() {
 	prepare_web_domain_values
 
 	# Remove old web configuration files
-	if [ -f /etc/$WEB_SYSTEM/conf.d/$domain.conf ]; then
-		rm -f /etc/$WEB_SYSTEM/conf.d/$domain*.conf
+	if [ -f /etc/$WEB_SYSTEM/$confd/$domain.conf ]; then
+		rm -f /etc/$WEB_SYSTEM/$confd/$domain*.conf
 	fi
-	if [ -f /etc/$PROXY_SYSTEM/conf.d/$domain.conf ]; then
-		rm -f /etc/$PROXY_SYSTEM/conf.d/$domain*.conf
+	if [ -f /etc/$PROXY_SYSTEM/$pconfd/$domain.conf ]; then
+		rm -f /etc/$PROXY_SYSTEM/$pconfd/$domain*.conf
 	fi
 
 	# Temporary allow write permissions to owner
@@ -469,7 +483,7 @@ rebuild_web_domain_conf() {
 		$HOMEDIR/$user/web/$domain/document_errors
 	chmod 640 /var/log/$WEB_SYSTEM/domains/$domain.*
 
-	chown --no-dereference $user:www-data $HOMEDIR/$user/web/$domain/public_*html
+	chown --no-dereference $user:$WWW_USER $HOMEDIR/$user/web/$domain/public_*html
 }
 # DNS domain rebuild
 rebuild_dns_domain_conf() {
diff --git a/func/upgrade.sh b/func/upgrade.sh
index ee7a4cf..d69d71c 100644
--- a/func/upgrade.sh
+++ b/func/upgrade.sh
@@ -606,6 +606,10 @@ upgrade_phppgadmin() {
 }
 
 upgrade_phpmyadmin() {
+	WWW_USER="www-data"
+	if [ -f /etc/redhat-release ]; then
+    	WWW_USER="apache"
+	fi
 	# Check if MariaDB/MySQL is installed on the server before attempting to install or upgrade phpMyAdmin
 	if [ -n "$(echo $DB_SYSTEM | grep -w 'mysql')" ]; then
 		pma_version=$(jq -r .version /usr/share/phpmyadmin/package.json)
@@ -613,7 +617,7 @@ upgrade_phpmyadmin() {
 			echo "[ * ] phpMyAdmin is up to date (${pma_version})..."
 			# Update permissions
 			if [ -e /var/lib/phpmyadmin/blowfish_secret.inc.php ]; then
-				chown root:www-data /var/lib/phpmyadmin/blowfish_secret.inc.php
+				chown root:$WWW_USER /var/lib/phpmyadmin/blowfish_secret.inc.php
 				chmod 0640 /var/lib/phpmyadmin/blowfish_secret.inc.php
 			fi
 		else
@@ -639,13 +643,13 @@ upgrade_phpmyadmin() {
 			# Create temporary folder and change permissions
 			if [ ! -d /usr/share/phpmyadmin/tmp ]; then
 				mkdir /usr/share/phpmyadmin/tmp
-				chown root:www-data /usr/share/phpmyadmin/tmp
+				chown root:$WWW_USER /usr/share/phpmyadmin/tmp
 				chmod 0770 /usr/share/phpmyadmin/tmp
 
 			fi
 
 			if [ -e /var/lib/phpmyadmin/blowfish_secret.inc.php ]; then
-				chown root:www-data /var/lib/phpmyadmin/blowfish_secret.inc.php
+				chown root:$WWW_USER /var/lib/phpmyadmin/blowfish_secret.inc.php
 				chmod 0640 /var/lib/phpmyadmin/blowfish_secret.inc.php
 			fi
 
diff --git a/hestiacp-rpm b/hestiacp-rpm
new file mode 120000
index 0000000..e81acb2
--- /dev/null
+++ b/hestiacp-rpm
@@ -0,0 +1 @@
+hestiacp-rpm
\ No newline at end of file
diff --git a/install/hst-install-rhel.sh b/install/hst-install-rhel.sh
index 69f1664..70aaebf 100755
--- a/install/hst-install-rhel.sh
+++ b/install/hst-install-rhel.sh
@@ -28,7 +28,7 @@ type=$(grep "^ID=" /etc/os-release | cut -f 2 -d '"')
 VERSION=$type
 
 # TODO: Not sure if condition below is required
-if [[ "$type" =~ ^(rhel|almalinux|eurolinux|ol|rocky|centos)$ ]]; then
+if [[ "$type" =~ ^(rhel|almalinux|eurolinux|ol|rocky|centos|msvsphere)$ ]]; then
 	release=$(rpm --eval='%rhel')
 fi
 
@@ -63,7 +63,7 @@ software="nginx
   mysql.${arch} mysql-common mysql-server
   postgresql-server postgresql sqlite.${arch}
   vsftpd proftpd bind
-  exim clamd spamassassin dovecot dovecot-pigeonhole
+  exim clamd clamav spamassassin dovecot dovecot-pigeonhole
   hestia hestia-nginx hestia-php
   rrdtool quota e2fsprogs fail2ban dnsutils util-linux cronie expect perl-Mail-DKIM unrar vim acl sysstat
   rsyslog openssh-clients util-linux ipset zstd systemd-timesyncd jq awstats perl-Switch net-tools mc flex
@@ -87,16 +87,16 @@ help() {
   -x, --exim              Install Exim               [yes|no]   default: yes
   -z, --dovecot           Install Dovecot            [yes|no]   default: yes
   -Z, --sieve             Install Sieve              [yes|no]   default: no
-  -c, --clamav            Install ClamAV             [yes|no]   default: yes
+  -c, --clamav            Install ClamAV             [yes|no]   default: no
   -t, --spamassassin      Install SpamAssassin       [yes|no]   default: yes
   -i, --iptables          Install Iptables           [yes|no]   default: yes
   -b, --fail2ban          Install Fail2ban           [yes|no]   default: yes
   -q, --quota             Filesystem Quota           [yes|no]   default: no
   -d, --api               Activate API               [yes|no]   default: yes
-  -X, --raven             Install Raven modular repo [yes|no]   default: no
   -r, --port              Change Backend Port                   default: 8083
   -l, --lang              Default language                      default: en
   -y, --interactive       Interactive install        [yes|no]   default: yes
+  -I, --nopublicip        Use local ip               [yes|no]   default: yes
   -s, --hostname          Set hostname
   -e, --email             Set admin email
   -p, --password          Set admin password
@@ -240,13 +240,13 @@ for arg; do
 		--lang) args="${args}-l " ;;
 		--interactive) args="${args}-y " ;;
 		--api) args="${args}-d " ;;
-		--raven) args="${args}-X " ;;
 		--hostname) args="${args}-s " ;;
 		--email) args="${args}-e " ;;
 		--password) args="${args}-p " ;;
 		--force) args="${args}-f " ;;
 		--with-debs) args="${args}-D " ;;
 		--help) args="${args}-h " ;;
+		--nopublicip) args="${args}-I " ;;
 		*)
 			[[ "${arg:0:1}" == "-" ]] || delim="\""
 			args="${args}${delim}${arg}${delim} "
@@ -256,7 +256,7 @@ done
 eval set -- "$args"
 
 # Parsing arguments
-while getopts "a:w:v:j:k:m:M:g:d:x:z:Z:c:t:i:b:r:o:q:l:y:s:e:p:R:fh" Option; do
+while getopts "I:a:w:v:j:k:m:M:g:d:x:z:Z:c:t:i:b:r:o:q:l:y:s:e:p:R:fh" Option; do
 	case $Option in
 		a) apache=$OPTARG ;;       # Apache
 		w) phpfpm=$OPTARG ;;       # PHP-FPM
@@ -278,7 +278,6 @@ while getopts "a:w:v:j:k:m:M:g:d:x:z:Z:c:t:i:b:r:o:q:l:y:s:e:p:R:fh" Option; do
 		r) port=$OPTARG ;;         # Backend Port
 		l) lang=$OPTARG ;;         # Language
 		d) api=$OPTARG ;;          # Activate API
-		X) raven=$OPTARG ;;        # Install Raven repo
 		y) interactive=$OPTARG ;;  # Interactive install
 		s) servername=$OPTARG ;;   # Hostname
 		e) email=$OPTARG ;;        # Admin email
@@ -286,6 +285,7 @@ while getopts "a:w:v:j:k:m:M:g:d:x:z:Z:c:t:i:b:r:o:q:l:y:s:e:p:R:fh" Option; do
 		R) withrpms=$OPTARG ;;     # Hestia rpms path
 		f) force='yes' ;;          # Force install
 		h) help ;;                 # Help
+		I) nopublicip=$OPTARG ;;   # NoPublicIP
 		*) help ;;                 # Print help (default)
 	esac
 done
@@ -311,7 +311,7 @@ elif [ $memory -lt 3000000 ]; then
 	set_default_value 'clamd' 'no'
 	set_default_value 'spamd' 'yes'
 else
-	set_default_value 'clamd' 'yes'
+	set_default_value 'clamd' 'no'
 	set_default_value 'spamd' 'yes'
 fi
 set_default_value 'iptables' 'yes'
@@ -319,7 +319,7 @@ set_default_value 'fail2ban' 'yes'
 set_default_value 'quota' 'no'
 set_default_value 'interactive' 'yes'
 set_default_value 'api' 'yes'
-set_default_value 'raven' 'no'
+set_default_value 'nopublicip' 'yes'
 set_default_port '8083'
 set_default_lang 'en'
 
@@ -350,7 +350,7 @@ if [ "x$(id -u)" != 'x0' ]; then
 	check_result 1 "Script can be run executed only by root"
 fi
 
-if [ -d "/usr/local/hestia" ]; then
+if [ -d "/usr/local/hestia" ] && [ "$force" = "no" ]; then
 	check_result 1 "Hestia install detected. Unable to continue"
 fi
 
@@ -669,17 +669,6 @@ fi
 #                   Install repository                     #
 #----------------------------------------------------------#
 
-# Installing Raven repository (required for some apache modules and old PHP versions)
-if [ "$raven" = 'yes' ] && [ ! -e "/etc/yum.repos.d/raven.repo" ]; then
-    dnf -y localinstall https://pkgs.dyn.su/el${release}/base/x86_64/raven-release.el${release}.noarch.rpm
-    check_result $? "Can't install Raven RPM repository"
-    dnf config-manager --set-enabled raven-modular
-fi
-
-if [ "$raven" = 'yes' ] && [ "$multiphp" = 'yes' ]; then
-  multiphp_v=("56" "70" "71" "72" "73" "74" "80" "81" "82" "83")
-fi
-
 # Create new folder if not all-ready exists
 mkdir -p /root/.gnupg/ && chmod 700 /root/.gnupg/
 
@@ -690,7 +679,7 @@ echo
 # Installing Nginx repo
 
 echo "[ * ] NGINX"
-dnf config-manager --add-repo https://raw.githubusercontent.com/hestiacp/hestiacp/main/install/rpm/nginx/nginx.repo
+dnf config-manager --add-repo https://dev.putey.net/bayrepo/hestiacp/raw/branch/master/install/rpm/nginx/nginx.repo
 
 # Installing Remi PHP repo
 echo "[ * ] PHP"
@@ -699,7 +688,7 @@ dnf install -y https://rpms.remirepo.net/enterprise/remi-release-$release.rpm
 # Installing MariaDB repo
 if [ "$mysql" = 'yes' ]; then
 	echo "[ * ] MariaDB"
-	dnf config-manager --add-repo https://raw.githubusercontent.com/hestiacp/hestiacp/main/install/rpm/mysql/mariadb-$(arch).repo
+	dnf config-manager --add-repo https://dev.putey.net/bayrepo/hestiacp/raw/branch/master/install/rpm/mysql/mariadb-$(arch).repo
 fi
 
 # Enabling MySQL module
@@ -712,7 +701,11 @@ fi
 
 # Installing HestiaCP repo
 echo "[ * ] Hestia Control Panel"
-dnf config-manager --add-repo https://raw.githubusercontent.com/raven-kg/hestiacp/hcp-rhel-rx/install/rpm/hestia/hestia.repo
+dnf config-manager --add-repo https://dev.putey.net/bayrepo/hestiacp/raw/branch/master/install/rpm/hestia/hestia.repo
+rpm --import https://repo.putey.net/repo/gpgkeys/repo.putey.net.pub
+check_result $? "rpm import putey.net GPG key failed"
+mkdir /var/cache/hestia-nginx/
+chown admin:admin /var/cache/hestia-nginx/
 
 # Installing PostgreSQL repo
 if [ "$postgresql" = 'yes' ]; then
@@ -759,7 +752,7 @@ cp -r /etc/nginx/* $hst_backups/nginx > /dev/null 2>&1
 # Backup Apache configuration
 systemctl stop httpd > /dev/null 2>&1
 cp -r /etc/httpd/* $hst_backups/httpd > /dev/null 2>&1
-rm -f /etc/httpd/conf.d/* > /dev/null 2>&1
+rm -f /etc/httpd/conf.h.d/* > /dev/null 2>&1
 
 # Backup PHP-FPM configuration
 systemctl stop php*-fpm > /dev/null 2>&1
@@ -846,11 +839,13 @@ if [ "$exim" = 'no' ]; then
 	software=$(echo "$software" | sed -e "s/exim//")
 	software=$(echo "$software" | sed -e "s/dovecot//")
 	software=$(echo "$software" | sed -e "s/clamd//")
+	software=$(echo "$software" | sed -e "s/clamav//")
 	software=$(echo "$software" | sed -e "s/spamassassin//")
 	software=$(echo "$software" | sed -e "s/dovecot-pigeonhole//")
 fi
 if [ "$clamd" = 'no' ]; then
 	software=$(echo "$software" | sed -e "s/clamd//")
+	software=$(echo "$software" | sed -e "s/clamav//")
 fi
 if [ "$spamd" = 'no' ]; then
 	software=$(echo "$software" | sed -e "s/spamassassin//")
@@ -894,11 +889,6 @@ if [ "$phpfpm" = 'yes' ]; then
 	software=$(echo "$software" | sed -e "s/mod_fcgid//")
 	software=$(echo "$software" | sed -e "s/php${php_v}-php.${arch}//")
 fi
-if [ "$raven" = 'no' ]; then
-	software=$(echo "$software" | sed -e "s/httpd-itk//")
-	software=$(echo "$software" | sed -e "s/mod_ruid2//")
-	software=$(echo "$software" | sed -e "s/mod_suphp//")
-fi
 if [ -d "$withrpms" ]; then
 	software=$(echo "$software" | sed -e "s/hestia-nginx//")
 	software=$(echo "$software" | sed -e "s/hestia-php//")
@@ -909,12 +899,21 @@ fi
 #                     Install packages                     #
 #----------------------------------------------------------#
 
+if [ "$iptables" = 'yes' ]; then
+	if [ -f /etc/redhat-release ]; then
+		dnf install iptables-nft -y
+		systemctl stop firewalld
+		systemctl disable firewalld
+		systemctl enable nftables --now
+	fi
+fi
+
 # Installing rpm packages
 echo "The installer is now downloading and installing all required packages."
 echo -ne "NOTE: This process may take 10 to 15 minutes to complete, please wait... "
 echo
 
-dnf -y install $software >> $LOG
+dnf -y install $software >> $LOG &
 BACK_PID=$!
 
 # Check if package installation is done, print a spinner
@@ -1137,7 +1136,7 @@ if [ "$exim" = 'yes' ]; then
 fi
 
 # Cron daemon
-write_config_value "CRON_SYSTEM" "cron"
+write_config_value "CRON_SYSTEM" "crond"
 
 # Firewall stack
 if [ "$iptables" = 'yes' ]; then
@@ -1213,8 +1212,8 @@ $HESTIA/bin/v-change-sys-hostname $servername > /dev/null 2>&1
 
 # Generating SSL certificate
 echo "[ * ] Generating default self-signed SSL certificate..."
-$HESTIA/bin/v-generate-ssl-cert $(hostname) '' 'US' 'California' \
-	'San Francisco' 'Hestia Control Panel' 'IT' > /tmp/hst.pem
+$HESTIA/bin/v-generate-ssl-cert $(hostname) '' 'RU' 'Moscow' \
+	'Moscow' 'Hestia Control Panel' 'IT' > /tmp/hst.pem
 
 # Parsing certificate file
 crt_end=$(grep -n "END CERTIFICATE-" /tmp/hst.pem | cut -f 1 -d:)
@@ -1321,13 +1320,14 @@ check_result $? "nginx start failed"
 if [ "$apache" = 'yes' ]; then
 	echo "[ * ] Configuring Apache Web Server..."
 
-	mkdir -p /etc/httpd/conf.d
-	mkdir -p /etc/httpd/conf.d/domains
+	mkdir -p /etc/httpd/conf.h.d
+	mkdir -p /etc/httpd/conf.h.d/domains
 
 	# Copy configuration files
-	cp -f $HESTIA_INSTALL_DIR/httpd/httpd.conf /etc/httpd/
-	cp -f $HESTIA_INSTALL_DIR/httpd/status.conf /etc/httpd/conf.d/hestia-status.conf
+	cp -f $HESTIA_INSTALL_DIR/httpd/httpd.conf /etc/httpd/conf/
+	cp -f $HESTIA_INSTALL_DIR/httpd/status.conf /etc/httpd/conf.h.d/hestia-status.conf
 	cp -f $HESTIA_INSTALL_DIR/logrotate/httpd /etc/logrotate.d/
+	cp -f $HESTIA_INSTALL_DIR/httpd/hestiacp-httpd.conf /usr/lib/systemd/system/httpd.service.d/
 
 	# Enable needed modules
 	if [ "$nginx" = "no" ]; then
@@ -1346,7 +1346,7 @@ if [ "$apache" = 'yes' ]; then
 		# Disable prefork and php, enable event
 		sed 's/LoadModule mpm_prefork_module/#LoadModule mpm_prefork_module/' -i /etc/httpd/conf.modules.d/00-mpm.conf
 		sed 's/#LoadModule mpm_event_module/LoadModule mpm_event_module/' -i /etc/httpd/conf.modules.d/00-mpm.conf
-		cp -f $HESTIA_INSTALL_DIR/httpd/hestia-event.conf /etc/httpd/conf.d/
+		cp -f $HESTIA_INSTALL_DIR/httpd/hestia-event.conf /etc/httpd/conf.h.d/
 	fi
 
 	if [ ! -d /etc/httpd/sites-available ]; then
@@ -1354,7 +1354,7 @@ if [ "$apache" = 'yes' ]; then
 	fi
 	echo "# Powered by hestia" > /etc/httpd/sites-available/default
 	echo "# Powered by hestia" > /etc/httpd/sites-available/default-ssl
-	echo "# Powered by hestia" > /etc/httpd/ports.conf
+	echo "# Powered by hestia" > /etc/httpd/conf/ports.conf
 	# echo -e "/home\npublic_html/cgi-bin" > /etc/httpd/suexec/www-data
 	touch /var/log/httpd/access.log /var/log/httpd/error.log
 	mkdir -p /var/log/httpd/domains
@@ -1389,6 +1389,7 @@ if [ "$phpfpm" = "yes" ]; then
 	systemctl enable php${php_v}-php-fpm --now >> $LOG
 	check_result $? "php-fpm start failed"
 	# Set default php version to $php_v
+	alternatives --install /usr/bin/php php /usr/bin/php$php_v 1 > /dev/null 2>&1
 	alternatives --set php /usr/bin/php$php_v > /dev/null 2>&1
 fi
 
@@ -1464,6 +1465,9 @@ if [ "$mysql" = 'yes' ] || [ "$mysql8" = 'yes' ]; then
 		mysql_install_db >> $LOG
 	fi
 
+	mkdir /var/log/mysql/
+	chown mysql:mysql /var/log/mysql/
+
 	# Remove symbolic link
 	rm -f /etc/my.cnf
 	# Configuring MariaDB
@@ -1529,7 +1533,7 @@ if [ "$mysql" = 'yes' ] || [ "$mysql8" = 'yes' ]; then
 
 	# Configuring Apache2 for PHPMYADMIN
 	if [ "$apache" = 'yes' ]; then
-		touch /etc/httpd/conf.d/phpmyadmin.inc
+		touch /etc/httpd/conf.h.d/phpmyadmin.inc
 	fi
 
 	# Overwrite old files
@@ -1592,7 +1596,7 @@ if [ "$postgresql" = 'yes' ]; then
 	ln -s /etc/phppgadmin/config.inc.php /usr/share/phppgadmin/conf/
 	# Configuring phpPgAdmin
 	if [ "$apache" = 'yes' ]; then
-		cp -f $HESTIA_INSTALL_DIR/pga/phppgadmin.conf /etc/httpd/conf.d/phppgadmin.inc
+		cp -f $HESTIA_INSTALL_DIR/pga/phppgadmin.conf /etc/httpd/conf.h.d/phppgadmin.inc
 	fi
 	cp -f $HESTIA_INSTALL_DIR/pga/config.inc.php /etc/phppgadmin/
 
@@ -1679,10 +1683,16 @@ fi
 #----------------------------------------------------------#
 
 if [ "$clamd" = 'yes' ]; then
+    useradd clamav -m -d /var/lib/clamavnew -r -s /sbin/nologin
 	gpasswd -a clamav mail > /dev/null 2>&1
 	gpasswd -a clamav exim > /dev/null 2>&1
 	cp -f $HESTIA_INSTALL_DIR/clamav/clamd.conf /etc/clamd.d/daemon.conf
 	cp -f $HESTIA_INSTALL_DIR/clamav/clamd.tmpfiles /etc/tmpfiles.d/clamav.conf
+	cp -f $HESTIA_INSTALL_DIR/clamav/freshclam.conf /etc/freshclam.conf
+	touch /var/log/freshclam.log
+	chown clamav:clamav /var/log/freshclam.log
+	rm -f /var/lib/clamav/freshclam.dat
+	mkdir -p /var/log/clamav
     systemd-tmpfiles --create
 
 	echo -ne "[ * ] Installing ClamAV anti-virus definitions... "
@@ -1739,6 +1749,9 @@ if [ "$fail2ban" = 'yes' ]; then
 	if [ -f /etc/fail2ban/jail.d/00-firewalld.conf ]; then
 		cat /dev/null > /etc/fail2ban/jail.d/00-firewalld.conf
 	fi
+
+	sed -i "s/^backend[ ]*=[ ]*auto/backend = systemd/gi" /etc/fail2ban/jail.conf
+
 	systemctl enable fail2ban --now
 	check_result $? "fail2ban start failed"
 fi
@@ -1856,6 +1869,9 @@ curl -s https://rclone.org/install.sh | bash > /dev/null 2>&1
 
 # Configuring system IPs
 echo "[ * ] Configuring System IP..."
+if [ "$nopublicip" = 'yes' ]; then
+	touch $HESTIA/conf/nopublickip
+fi
 $HESTIA/bin/v-update-sys-ip > /dev/null 2>&1
 
 # Get primary IP
@@ -1874,11 +1890,14 @@ if [ "$iptables" = 'yes' ]; then
 fi
 
 # Get public IP
-pub_ip=$(curl --ipv4 -s https://ip.hestiacp.com/)
+pub_ip=$ip
+if [ "$nopublicip" = 'no' ]; then
+	pub_ip=$(curl --ipv4 -s https://ip.hestiacp.com/)
 
-if [ -n "$pub_ip" ] && [ "$pub_ip" != "$ip" ]; then
-	$HESTIA/bin/v-change-sys-ip-nat $ip $pub_ip > /dev/null 2>&1
-	ip=$pub_ip
+	if [ -n "$pub_ip" ] && [ "$pub_ip" != "$ip" ]; then
+		$HESTIA/bin/v-change-sys-ip-nat $ip $pub_ip > /dev/null 2>&1
+		ip=$pub_ip
+	fi
 fi
 
 # Configuring mod_remoteip
@@ -1900,6 +1919,14 @@ if [ "$apache" = 'yes' ] && [ "$nginx" = 'yes' ]; then
 	systemctl restart httpd
 fi
 
+#install oneshot service for hestia
+echo "[ * ] Configuring One Shot Service..."
+$HESTIA/bin/v-oneshot-service
+if [ ! -e /etc/systemd/system/hestiacp-prepare.service ]; then
+	cp -f $HESTIA_INSTALL_DIR/oneshot/hestiacp-prepare.service /etc/systemd/system/
+	systemctl enable hestiacp-prepare.service --now
+fi
+
 # Adding default domain
 $HESTIA/bin/v-add-web-domain admin $servername $ip
 check_result $? "can't create $servername domain"
@@ -1908,7 +1935,7 @@ check_result $? "can't create $servername domain"
 export SCHEDULED_RESTART="yes"
 command="sudo $HESTIA/bin/v-update-sys-queue restart"
 $HESTIA/bin/v-add-cron-job 'admin' '*/2' '*' '*' '*' '*' "$command"
-systemctl restart cron
+systemctl restart crond
 
 command="sudo $HESTIA/bin/v-update-sys-queue daily"
 $HESTIA/bin/v-add-cron-job 'admin' '10' '00' '*' '*' '*' "$command"
@@ -1954,8 +1981,21 @@ dnf clean all
 dnf makecache
 dnf -y upgrade >> $LOG &
 BACK_PID=$!
+
+# Check if package installation is done, print a spinner
+spin_i=1
+while kill -0 $BACK_PID > /dev/null 2>&1; do
+	printf "\b${spinner:spin_i++%${#spinner}:1}"
+	sleep 0.5
+done
+
+# Do a blank echo to get the \n back
 echo
 
+# Check Installation result
+wait $BACK_PID
+check_result $? "dnf upgrade failed"
+
 # Starting Hestia service
 systemctl enable hestia --now
 check_result $? "hestia start failed"
diff --git a/install/hst-install-ubuntu.sh b/install/hst-install-ubuntu.sh
index 7bf3722..47b4f6c 100755
--- a/install/hst-install-ubuntu.sh
+++ b/install/hst-install-ubuntu.sh
@@ -434,7 +434,7 @@ fi
 
 # Validate whether installation script matches release version before continuing with install
 if [ -z "$withdebs" ] || [ ! -d "$withdebs" ]; then
-	release_branch_ver=$(curl -s https://raw.githubusercontent.com/hestiacp/hestiacp/release/src/deb/hestia/control | grep "Version:" | awk '{print $2}')
+	release_branch_ver=$(curl -s https://dev.putey.net/bayrepo/hestiacp/raw/branch/master/src/deb/hestia/control | grep "Version:" | awk '{print $2}')
 	if [ "$HESTIA_INSTALL_VER" != "$release_branch_ver" ]; then
 		echo
 		echo -e "\e[91mInstallation aborted\e[0m"
@@ -442,7 +442,7 @@ if [ -z "$withdebs" ] || [ ! -d "$withdebs" ]; then
 		echo -e "\e[33mERROR: Install script version does not match package version!\e[0m"
 		echo -e "\e[33mPlease download the installer from the release branch in order to continue:\e[0m"
 		echo ""
-		echo -e "\e[33mhttps://raw.githubusercontent.com/hestiacp/hestiacp/release/install/hst-install.sh\e[0m"
+		echo -e "\e[33mhttps://dev.putey.net/bayrepo/hestiacp/raw/branch/master/install/hst-install.sh\e[0m"
 		echo ""
 		echo -e "\e[33mTo test pre-release versions, build the .deb packages and re-run the installer:\e[0m"
 		echo -e "  \e[33m./hst_autocompile.sh \e[1m--hestia branchname no\e[21m\e[0m"
diff --git a/install/hst-install.sh b/install/hst-install.sh
index 288eeac..f8c7bda 100755
--- a/install/hst-install.sh
+++ b/install/hst-install.sh
@@ -61,7 +61,7 @@ elif [ -e "/etc/os-release" ] && [ -e "/etc/redhat-release" ]; then
 	type=$(grep "^ID=" /etc/os-release | cut -f 2 -d '"')
 	VERSION=$type
 	# TODO: Not sure if this required
-	if [[ "$type" =~ ^(rhel|almalinux|eurolinux|ol|rocky|centos)$ ]]; then
+	if [[ "$type" =~ ^(rhel|almalinux|eurolinux|ol|rocky|centos|msvsphere)$ ]]; then
 		release=$(rpm --eval='%rhel')
 	fi
 else
@@ -90,7 +90,7 @@ check_wget_curl() {
 	# Check wget
 	if [ -e '/usr/bin/wget' ]; then
 		if [ -e '/etc/redhat-release' ]; then
-			wget -q https://raw.githubusercontent.com/raven-kg/hestiacp/hcp-rhel-rx/install/hst-install-rhel.sh -O hst-install-rhel.sh
+			wget -q https://dev.putey.net/bayrepo/hestiacp/raw/branch/master/install/hst-install-rhel.sh -O hst-install-rhel.sh
 			if [ "$?" -eq '0' ]; then
 				bash hst-install-rhel.sh $*
 				exit
@@ -99,7 +99,7 @@ check_wget_curl() {
 				exit 1
 			fi
 		else
-			wget -q https://raw.githubusercontent.com/hestiacp/hestiacp/release/install/hst-install-$type.sh -O hst-install-$type.sh
+			wget -q https://dev.putey.net/bayrepo/hestiacp/raw/branch/master/install/hst-install-$type.sh -O hst-install-$type.sh
 			if [ "$?" -eq '0' ]; then
 				bash hst-install-$type.sh $*
 				exit
@@ -113,7 +113,7 @@ check_wget_curl() {
 	# Check curl
 	if [ -e '/usr/bin/curl' ]; then
 		if [ -e '/etc/redhat-release' ]; then
-			curl -s -O https://raw.githubusercontent.com/raven-kg/hestiacp/hcp-rhel-rx/install/hst-install-rhel.sh
+			curl -s -O https://dev.putey.net/bayrepo/hestiacp/raw/branch/master/install/hst-install-rhel.sh
 			if [ "$?" -eq '0' ]; then
 				bash hst-install-rhel.sh $*
 				exit
@@ -122,7 +122,7 @@ check_wget_curl() {
 				exit 1
 			fi
 		else
-			curl -s -O https://raw.githubusercontent.com/hestiacp/hestiacp/release/install/hst-install-$type.sh
+			curl -s -O https://dev.putey.net/bayrepo/hestiacp/raw/branch/master/install/hst-install-$type.sh
 			if [ "$?" -eq '0' ]; then
 				bash hst-install-$type.sh $*
 				exit
diff --git a/install/rpm/clamav/clamd.conf b/install/rpm/clamav/clamd.conf
index 048a0ad..4820e8a 100644
--- a/install/rpm/clamav/clamd.conf
+++ b/install/rpm/clamav/clamd.conf
@@ -23,7 +23,7 @@ LogFacility LOG_LOCAL6
 LogClean false
 LogVerbose true
 PidFile /run/clamav/clamd.pid
-DatabaseDirectory /var/lib/clamav
+DatabaseDirectory /var/lib/clamavnew
 SelfCheck 3600
 Foreground false
 Debug false
diff --git a/install/rpm/clamav/freshclam.conf b/install/rpm/clamav/freshclam.conf
index 0f8fc4a..66ed1bd 100644
--- a/install/rpm/clamav/freshclam.conf
+++ b/install/rpm/clamav/freshclam.conf
@@ -1,210 +1,15 @@
-##
-## Example config file for freshclam
-## Please read the freshclam.conf(5) manual before editing this file.
-##
-
-
-# Comment or remove the line below.
-#Example
-
-# Path to the database directory.
-# WARNING: It must match clamd.conf's directive!
-# Default: hardcoded (depends on installation options)
-#DatabaseDirectory /var/lib/clamav
-
-# Path to the log file (make sure it has proper permissions)
-# Default: disabled
-#UpdateLogFile /var/log/freshclam.log
-
-# Maximum size of the log file.
-# Value of 0 disables the limit.
-# You may use 'M' or 'm' for megabytes (1M = 1m = 1048576 bytes)
-# and 'K' or 'k' for kilobytes (1K = 1k = 1024 bytes).
-# in bytes just don't use modifiers. If LogFileMaxSize is enabled,
-# log rotation (the LogRotate option) will always be enabled.
-# Default: 1M
-#LogFileMaxSize 2M
-
-# Log time with each message.
-# Default: no
-#LogTime yes
-
-# Enable verbose logging.
-# Default: no
+UpdateLogFile /var/log/freshclam.log
+PrivateMirror https://clamav-mirror.ru/
+PrivateMirror http://mirror.truenetwork.ru/clamav/
+ScriptedUpdates no
+LogFileMaxSize 80M
+LogTime yes
 #LogVerbose yes
-
-# Use system logger (can work together with UpdateLogFile).
-# Default: no
-#LogSyslog yes
-
-# Specify the type of syslog messages - please refer to 'man syslog'
-# for facility names.
-# Default: LOG_LOCAL6
-#LogFacility LOG_MAIL
-
-# Enable log rotation. Always enabled when LogFileMaxSize is enabled.
-# Default: no
-#LogRotate yes
-
-# This option allows you to save the process identifier of the daemon
-# Default: disabled
-#PidFile /run/freshclam.pid
+LogRotate yes
+#PidFile /var/run/freshclam.pid
 
 # By default when started freshclam drops privileges and switches to the
 # "clamav" user. This directive allows you to change the database owner.
 # Default: clamav (may depend on installation options)
 DatabaseOwner clamav
-
-# Use DNS to verify virus database version. Freshclam uses DNS TXT records
-# to verify database and software versions. With this directive you can change
-# the database verification domain.
-# WARNING: Do not touch it unless you're configuring freshclam to use your
-# own database verification domain.
-# Default: current.cvd.clamav.net
-#DNSDatabaseInfo current.cvd.clamav.net
-
-# database.clamav.net is now the primary domain name to be used world-wide.
-# Now that CloudFlare is being used as our Content Delivery Network (CDN),
-# this one domain name works world-wide to direct freshclam to the closest
-# geographic endpoint.
-# If the old db.XY.clamav.net domains are set, freshclam will automatically
-# use database.clamav.net instead.
-DatabaseMirror database.clamav.net
-
-# How many attempts to make before giving up.
-# Default: 3 (per mirror)
-#MaxAttempts 5
-
-# With this option you can control scripted updates. It's highly recommended
-# to keep it enabled.
-# Default: yes
-#ScriptedUpdates yes
-
-# By default freshclam will keep the local databases (.cld) uncompressed to
-# make their handling faster. With this option you can enable the compression;
-# the change will take effect with the next database update.
-# Default: no
-#CompressLocalDatabase no
-
-# With this option you can provide custom sources for database files.
-# This option can be used multiple times. Support for:
-#   http(s)://, ftp(s)://, or file://
-# Default: no custom URLs
-#DatabaseCustomURL http://myserver.example.com/mysigs.ndb
-#DatabaseCustomURL https://myserver.example.com/mysigs.ndb
-#DatabaseCustomURL https://myserver.example.com:4567/whitelist.wdb
-#DatabaseCustomURL ftp://myserver.example.com/example.ldb
-#DatabaseCustomURL ftps://myserver.example.com:4567/example.ndb
-#DatabaseCustomURL file:///mnt/nfs/local.hdb
-
-# This option allows you to easily point freshclam to private mirrors.
-# If PrivateMirror is set, freshclam does not attempt to use DNS
-# to determine whether its databases are out-of-date, instead it will
-# use the If-Modified-Since request or directly check the headers of the
-# remote database files. For each database, freshclam first attempts
-# to download the CLD file. If that fails, it tries to download the
-# CVD file. This option overrides DatabaseMirror, DNSDatabaseInfo
-# and ScriptedUpdates. It can be used multiple times to provide
-# fall-back mirrors.
-# Default: disabled
-#PrivateMirror mirror1.example.com
-#PrivateMirror mirror2.example.com
-
-# Number of database checks per day.
-# Default: 12 (every two hours)
-#Checks 24
-
-# Proxy settings
-# The HTTPProxyServer may be prefixed with [scheme]:// to specify which kind
-# of proxy is used.
-#   http://     HTTP Proxy. Default when no scheme or proxy type is specified.
-#   https://    HTTPS Proxy. (Added in 7.52.0 for OpenSSL, GnuTLS and NSS)
-#   socks4://   SOCKS4 Proxy.
-#   socks4a://  SOCKS4a Proxy. Proxy resolves URL hostname.
-#   socks5://   SOCKS5 Proxy.
-#   socks5h://  SOCKS5 Proxy. Proxy resolves URL hostname.
-# Default: disabled
-#HTTPProxyServer https://proxy.example.com
-#HTTPProxyPort 1234
-#HTTPProxyUsername myusername
-#HTTPProxyPassword mypass
-
-# If your servers are behind a firewall/proxy which applies User-Agent
-# filtering you can use this option to force the use of a different
-# User-Agent header.
-# Default: clamav/version_number
-#HTTPUserAgent SomeUserAgentIdString
-
-# Use aaa.bbb.ccc.ddd as client address for downloading databases. Useful for
-# multi-homed systems.
-# Default: Use OS'es default outgoing IP address.
-#LocalIPAddress aaa.bbb.ccc.ddd
-
-# Send the RELOAD command to clamd.
-# Default: no
-#NotifyClamd /path/to/clamd.conf
-
-# Run command after successful database update.
-# Default: disabled
-#OnUpdateExecute command
-
-# Run command when database update process fails.
-# Default: disabled
-#OnErrorExecute command
-
-# Run command when freshclam reports outdated version.
-# In the command string %v will be replaced by the new version number.
-# Default: disabled
-#OnOutdatedExecute command
-
-# Don't fork into background.
-# Default: no
-#Foreground yes
-
-# Enable debug messages in libclamav.
-# Default: no
-#Debug yes
-
-# Timeout in seconds when connecting to database server.
-# Default: 30
-#ConnectTimeout 60
-
-# Timeout in seconds when reading from database server.
-# Default: 0
-#ReceiveTimeout 1800
-
-# With this option enabled, freshclam will attempt to load new
-# databases into memory to make sure they are properly handled
-# by libclamav before replacing the old ones.
-# Default: yes
-#TestDatabases yes
-
-# This option enables support for Google Safe Browsing. When activated for
-# the first time, freshclam will download a new database file
-# (safebrowsing.cvd) which will be automatically loaded by clamd and
-# clamscan during the next reload, provided that the heuristic phishing
-# detection is turned on. This database includes information about websites
-# that may be phishing sites or possible sources of malware. When using this
-# option, it's mandatory to run freshclam at least every 30 minutes.
-# Freshclam uses the ClamAV's mirror infrastructure to distribute the
-# database and its updates but all the contents are provided under Google's
-# terms of use.
-# See https://transparencyreport.google.com/safe-browsing/overview
-# and https://www.clamav.net/documents/safebrowsing for more information.
-# Default: no
-#SafeBrowsing yes
-
-# This option enables downloading of bytecode.cvd, which includes additional
-# detection mechanisms and improvements to the ClamAV engine.
-# Default: yes
-#Bytecode no
-
-# Include an optional signature databases (opt-in).
-# This option can be used multiple times.
-#ExtraDatabase dbname1
-#ExtraDatabase dbname2
-
-# Exclude a standard signature database (opt-out).
-# This option can be used multiple times.
-#ExcludeDatabase dbname1
-#ExcludeDatabase dbname2
+DatabaseDirectory /var/lib/clamavnew
diff --git a/install/rpm/fail2ban/jail.local b/install/rpm/fail2ban/jail.local
index 7e8b67c..c2d3f9b 100644
--- a/install/rpm/fail2ban/jail.local
+++ b/install/rpm/fail2ban/jail.local
@@ -35,7 +35,7 @@ maxretry = 5
 enabled  = true
 filter   = hestia
 action   = hestia[name=HESTIA]
-logpath  = /var/log/hestia/secure
+logpath  = /var/log/messages
 maxretry = 5
 
 [roundcube-auth]
diff --git a/install/rpm/filemanager/filegator/backend/Services/Archiver/Adapters/HestiaZipArchiver.php b/install/rpm/filemanager/filegator/backend/Services/Archiver/Adapters/HestiaZipArchiver.php
new file mode 100644
index 0000000..49529aa
--- /dev/null
+++ b/install/rpm/filemanager/filegator/backend/Services/Archiver/Adapters/HestiaZipArchiver.php
@@ -0,0 +1,48 @@
+<?php
+
+namespace Filegator\Services\Archiver\Adapters;
+
+use Filegator\Container\Container;
+use Filegator\Services\Archiver\ArchiverInterface;
+use Filegator\Services\Service;
+use Filegator\Services\Storage\Filesystem as Storage;
+use Filegator\Services\Tmpfs\TmpfsInterface;
+use function Hestiacp\quoteshellarg\quoteshellarg;
+
+class HestiaZipArchiver extends ZipArchiver implements Service, ArchiverInterface {
+	protected $container;
+
+	public function __construct(TmpfsInterface $tmpfs, Container $container) {
+		$this->tmpfs = $tmpfs;
+		$this->container = $container;
+	}
+
+	public function uncompress(string $source, string $destination, Storage $storage) {
+		$auth = $this->container->get("Filegator\Services\Auth\AuthInterface");
+
+		$v_user = basename($auth->user()->getUsername());
+
+		if (!strlen($v_user)) {
+			return;
+		}
+
+		if (strpos($source, "/home") === false) {
+			$source = "/home/$v_user/" . $source;
+		}
+
+		if (strpos($destination, "/home") === false) {
+			$destination = "/home/$v_user/" . $destination;
+		}
+
+		exec(
+			"sudo /usr/local/hestia/bin/v-extract-fs-archive " .
+				quoteshellarg($v_user) .
+				" " .
+				quoteshellarg($source) .
+				" " .
+				quoteshellarg($destination),
+			$output,
+			$return_var,
+		);
+	}
+}
diff --git a/install/rpm/filemanager/filegator/backend/Services/Auth/Adapters/HestiaAuth.php b/install/rpm/filemanager/filegator/backend/Services/Auth/Adapters/HestiaAuth.php
new file mode 100644
index 0000000..799387d
--- /dev/null
+++ b/install/rpm/filemanager/filegator/backend/Services/Auth/Adapters/HestiaAuth.php
@@ -0,0 +1,122 @@
+<?php
+
+/*
+ * This file is part of the FileGator package.
+ *
+ * (c) Milos Stojanovic <alcalbg@gmail.com>
+ *
+ * For the full copyright and license information, please view the LICENSE file
+ */
+
+namespace Filegator\Services\Auth\Adapters;
+
+use Filegator\Services\Auth\AuthInterface;
+use Filegator\Services\Auth\User;
+use Filegator\Services\Auth\UsersCollection;
+use Filegator\Services\Service;
+use function Hestiacp\quoteshellarg\quoteshellarg;
+
+/**
+ * @codeCoverageIgnore
+ */
+class HestiaAuth implements Service, AuthInterface {
+	protected $permissions = [];
+
+	protected $private_repos = false;
+
+	protected $hestia_user = "";
+
+	public function init(array $config = []) {
+		if (isset($_SESSION["user"])) {
+			$v_user = $_SESSION["user"];
+		}
+		if (!empty($_SESSION["look"])) {
+			if (isset($_SESSION["look"]) && $_SESSION["userContext"] === "admin") {
+				$v_user = $_SESSION["look"];
+			}
+			if (
+				$_SESSION["look"] == "admin" &&
+				$_SESSION["POLICY_SYSTEM_PROTECTED_ADMIN"] == "yes"
+			) {
+				// Go away do not login
+				header("Location: /");
+				exit();
+			}
+		}
+		$this->hestia_user = $v_user;
+		$this->permissions = isset($config["permissions"]) ? (array) $config["permissions"] : [];
+		$this->private_repos = isset($config["private_repos"])
+			? (bool) $config["private_repos"]
+			: false;
+	}
+
+	public function user(): ?User {
+		$cmd = "/usr/bin/sudo /usr/local/hestia/bin/v-list-user";
+		exec($cmd . " " . quoteshellarg($this->hestia_user) . " json", $output, $return_var);
+
+		if ($return_var == 0) {
+			$data = json_decode(implode("", $output), true);
+			$hestia_user_info = $data[$this->hestia_user];
+			return $this->transformUser($hestia_user_info);
+		}
+
+		return $this->getGuest();
+	}
+
+	public function transformUser($hstuser): User {
+		$user = new User();
+		$user->setUsername($this->hestia_user);
+		$user->setName($this->hestia_user . " (" . $hstuser["NAME"] . ")");
+		$user->setRole("user");
+		$user->setPermissions($this->permissions);
+		$user->setHomedir("/");
+		return $user;
+	}
+
+	public function authenticate($username, $password): bool {
+		# Auth is handled by Hestia
+		return false;
+	}
+
+	public function forget() {
+		// Logout return to Hestia
+		return $this->getGuest();
+	}
+
+	public function store(User $user) {
+		return null; // not used
+	}
+
+	public function update($username, User $user, $password = ""): User {
+		// Password change is handled by Hestia
+		return $this->user();
+	}
+
+	public function add(User $user, $password): User {
+		return new User(); // not used
+	}
+
+	public function delete(User $user) {
+		return true; // not used
+	}
+
+	public function find($username): ?User {
+		return null; // not used
+	}
+
+	public function allUsers(): UsersCollection {
+		return new UsersCollection(); // not used
+	}
+
+	public function getGuest(): User {
+		$guest = new User();
+
+		$guest->setUsername("guest");
+		$guest->setName("Guest");
+		$guest->setRole("guest");
+		$guest->setHomedir("/");
+		$guest->setPermissions([]);
+
+		return $guest;
+	}
+}
diff --git a/install/rpm/filemanager/filegator/backend/Services/Session/Adapters/SessionStorage.php b/install/rpm/filemanager/filegator/backend/Services/Session/Adapters/SessionStorage.php
new file mode 100644
index 0000000..320b7bc
--- /dev/null
+++ b/install/rpm/filemanager/filegator/backend/Services/Session/Adapters/SessionStorage.php
@@ -0,0 +1,64 @@
+<?php
+
+/*
+ * This file is part of the FileGator package.
+ *
+ * (c) Milos Stojanovic <alcalbg@gmail.com>
+ *
+ * For the full copyright and license information, please view the LICENSE file
+ */
+
+namespace Filegator\Services\Session\Adapters;
+
+use Filegator\Kernel\Request;
+use Filegator\Services\Service;
+use Filegator\Services\Session\Session;
+use Filegator\Services\Session\SessionStorageInterface;
+
+class SessionStorage implements Service, SessionStorageInterface {
+	protected $request;
+
+	protected $config;
+
+	public function __construct(Request $request) {
+		$this->request = $request;
+	}
+
+	public function init(array $config = []) {
+		// we don't have a previous session attached
+		if (!$this->getSession()) {
+			$handler = $config["handler"];
+			$session = new Session($handler());
+			//$session->setName('filegator');
+			$this->setSession($session);
+		}
+	}
+
+	public function save() {
+		$this->getSession()->save();
+	}
+
+	public function set(string $key, $data) {
+		return $this->getSession()->set($key, $data);
+	}
+
+	public function get(string $key, $default = null) {
+		return $this->getSession() ? $this->getSession()->get($key, $default) : $default;
+	}
+
+	public function invalidate() {
+		if (!$this->getSession()->isStarted()) {
+			$this->getSession()->start();
+		}
+
+		$this->getSession()->invalidate();
+	}
+
+	private function setSession(Session $session) {
+		return $this->request->setSession($session);
+	}
+
+	private function getSession(): ?Session {
+		return $this->request->getSession();
+	}
+}
diff --git a/install/rpm/filemanager/filegator/composer.json b/install/rpm/filemanager/filegator/composer.json
new file mode 100644
index 0000000..f95bb82
--- /dev/null
+++ b/install/rpm/filemanager/filegator/composer.json
@@ -0,0 +1,47 @@
+{
+	"name": "filegator/filegator",
+	"description": "Filegator",
+	"license": "MIT",
+	"type": "project",
+	"config": {
+		"platform": {
+			"php": "7.2.5"
+		}
+	},
+	"require": {
+		"php": "^7.2",
+		"monolog/monolog": "^1.24",
+		"nikic/fast-route": "^1.3",
+		"symfony/security-csrf": "^4.4",
+		"symfony/http-foundation": "^4.4",
+		"dibi/dibi": "^4.1",
+		"php-di/php-di": "^6.0",
+		"rakit/validation": "^1.1",
+		"league/flysystem": "^1.1",
+		"league/flysystem-ziparchive": "^1.0",
+		"league/flysystem-sftp": "^1.0",
+		"hestiacp/phpquoteshellarg": "^1.0"
+	},
+	"authors": [
+		{
+			"name": "Milos Stojanovic",
+			"email": "alcalbg@gmail.com"
+		}
+	],
+	"autoload": {
+		"psr-4": {
+			"Filegator\\": "backend"
+		}
+	},
+	"autoload-dev": {
+		"psr-4": {
+			"Tests\\": "tests/backend/"
+		}
+	},
+	"require-dev": {
+		"phpunit/phpunit": "^8.0",
+		"symfony/var-dumper": "^4.4",
+		"league/flysystem-memory": "^1.0",
+		"phpstan/phpstan": "^0.11.8"
+	}
+}
diff --git a/install/rpm/filemanager/filegator/composer.lock b/install/rpm/filemanager/filegator/composer.lock
new file mode 100644
index 0000000..94e36a4
--- /dev/null
+++ b/install/rpm/filemanager/filegator/composer.lock
@@ -0,0 +1,4771 @@
+{
+	"_readme": [
+		"This file locks the dependencies of your project to a known state",
+		"Read more about it at https://getcomposer.org/doc/01-basic-usage.md#installing-dependencies",
+		"This file is @generated automatically"
+	],
+	"content-hash": "2804e81bca9a58669546bcb9ce9ff709",
+	"packages": [
+		{
+			"name": "dibi/dibi",
+			"version": "v4.2.7",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/dg/dibi.git",
+				"reference": "7fa05f381b23fdc59af98caeb03b1ae8ed1e03ed"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/dg/dibi/zipball/7fa05f381b23fdc59af98caeb03b1ae8ed1e03ed",
+				"reference": "7fa05f381b23fdc59af98caeb03b1ae8ed1e03ed",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.2"
+			},
+			"replace": {
+				"dg/dibi": "*"
+			},
+			"require-dev": {
+				"nette/di": "^3.0",
+				"nette/tester": "~2.0",
+				"phpstan/phpstan": "^0.12",
+				"tracy/tracy": "~2.2"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "4.2-dev"
+				}
+			},
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause",
+				"GPL-2.0-only",
+				"GPL-3.0-only"
+			],
+			"authors": [
+				{
+					"name": "David Grudl",
+					"homepage": "https://davidgrudl.com"
+				}
+			],
+			"description": "Dibi is Database Abstraction Library for PHP",
+			"homepage": "https://dibiphp.com",
+			"keywords": [
+				"access",
+				"database",
+				"dbal",
+				"mssql",
+				"mysql",
+				"odbc",
+				"oracle",
+				"pdo",
+				"postgresql",
+				"sqlite",
+				"sqlsrv"
+			],
+			"support": {
+				"issues": "https://github.com/dg/dibi/issues",
+				"source": "https://github.com/dg/dibi/tree/v4.2.7"
+			},
+			"time": "2022-11-18T03:40:51+00:00"
+		},
+		{
+			"name": "hestiacp/phpquoteshellarg",
+			"version": "v1.0.1-p3",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/hestiacp/phpquoteshellarg.git",
+				"reference": "89cbab9b81b4482127a7bd521ccb6394dd8cda37"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/hestiacp/phpquoteshellarg/zipball/89cbab9b81b4482127a7bd521ccb6394dd8cda37",
+				"reference": "89cbab9b81b4482127a7bd521ccb6394dd8cda37",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.2"
+			},
+			"type": "library",
+			"autoload": {
+				"files": [
+					"src/Hestiacp/quoteshellarg/quoteshellarg.php"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"Unlicense"
+			],
+			"description": "Improved escape shell arguments for support of special charactars",
+			"homepage": "https://github.com/hestiacp",
+			"keywords": [
+				"escapeshellarg",
+				"quoteshellarg"
+			],
+			"support": {
+				"source": "https://github.com/hestiacp/phpquoteshellarg/tree/v1.0.1-p3"
+			},
+			"time": "2022-07-17T14:48:05+00:00"
+		},
+		{
+			"name": "league/flysystem",
+			"version": "1.1.10",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/thephpleague/flysystem.git",
+				"reference": "3239285c825c152bcc315fe0e87d6b55f5972ed1"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/thephpleague/flysystem/zipball/3239285c825c152bcc315fe0e87d6b55f5972ed1",
+				"reference": "3239285c825c152bcc315fe0e87d6b55f5972ed1",
+				"shasum": ""
+			},
+			"require": {
+				"ext-fileinfo": "*",
+				"league/mime-type-detection": "^1.3",
+				"php": "^7.2.5 || ^8.0"
+			},
+			"conflict": {
+				"league/flysystem-sftp": "<1.0.6"
+			},
+			"require-dev": {
+				"phpspec/prophecy": "^1.11.1",
+				"phpunit/phpunit": "^8.5.8"
+			},
+			"suggest": {
+				"ext-ftp": "Allows you to use FTP server storage",
+				"ext-openssl": "Allows you to use FTPS server storage",
+				"league/flysystem-aws-s3-v2": "Allows you to use S3 storage with AWS SDK v2",
+				"league/flysystem-aws-s3-v3": "Allows you to use S3 storage with AWS SDK v3",
+				"league/flysystem-azure": "Allows you to use Windows Azure Blob storage",
+				"league/flysystem-cached-adapter": "Flysystem adapter decorator for metadata caching",
+				"league/flysystem-eventable-filesystem": "Allows you to use EventableFilesystem",
+				"league/flysystem-rackspace": "Allows you to use Rackspace Cloud Files",
+				"league/flysystem-sftp": "Allows you to use SFTP server storage via phpseclib",
+				"league/flysystem-webdav": "Allows you to use WebDAV storage",
+				"league/flysystem-ziparchive": "Allows you to use ZipArchive adapter",
+				"spatie/flysystem-dropbox": "Allows you to use Dropbox storage",
+				"srmklive/flysystem-dropbox-v2": "Allows you to use Dropbox storage for PHP 5 applications"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "1.1-dev"
+				}
+			},
+			"autoload": {
+				"psr-4": {
+					"League\\Flysystem\\": "src/"
+				}
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "Frank de Jonge",
+					"email": "info@frenky.net"
+				}
+			],
+			"description": "Filesystem abstraction: Many filesystems, one API.",
+			"keywords": [
+				"Cloud Files",
+				"WebDAV",
+				"abstraction",
+				"aws",
+				"cloud",
+				"copy.com",
+				"dropbox",
+				"file systems",
+				"files",
+				"filesystem",
+				"filesystems",
+				"ftp",
+				"rackspace",
+				"remote",
+				"s3",
+				"sftp",
+				"storage"
+			],
+			"support": {
+				"issues": "https://github.com/thephpleague/flysystem/issues",
+				"source": "https://github.com/thephpleague/flysystem/tree/1.1.10"
+			},
+			"funding": [
+				{
+					"url": "https://offset.earth/frankdejonge",
+					"type": "other"
+				}
+			],
+			"time": "2022-10-04T09:16:37+00:00"
+		},
+		{
+			"name": "league/flysystem-sftp",
+			"version": "1.1.0",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/thephpleague/flysystem-sftp.git",
+				"reference": "36fb893d10bb799fa6aa7199e37e84314c9fd97d"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/thephpleague/flysystem-sftp/zipball/36fb893d10bb799fa6aa7199e37e84314c9fd97d",
+				"reference": "36fb893d10bb799fa6aa7199e37e84314c9fd97d",
+				"shasum": ""
+			},
+			"require": {
+				"league/flysystem": "~1.0",
+				"php": ">=5.6.0",
+				"phpseclib/phpseclib": "~2.0"
+			},
+			"require-dev": {
+				"mockery/mockery": "0.9.*",
+				"phpunit/phpunit": "^5.7.25"
+			},
+			"type": "library",
+			"autoload": {
+				"psr-4": {
+					"League\\Flysystem\\Sftp\\": "src/"
+				}
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "Frank de Jonge",
+					"email": "info@frenky.net"
+				}
+			],
+			"description": "Flysystem adapter for SFTP",
+			"support": {
+				"issues": "https://github.com/thephpleague/flysystem-sftp/issues",
+				"source": "https://github.com/thephpleague/flysystem-sftp/tree/1.1.0"
+			},
+			"funding": [
+				{
+					"url": "https://offset.earth/frankdejonge",
+					"type": "custom"
+				},
+				{
+					"url": "https://github.com/frankdejonge",
+					"type": "github"
+				},
+				{
+					"url": "https://tidelift.com/funding/github/packagist/league/flysystem",
+					"type": "tidelift"
+				}
+			],
+			"abandoned": "league/flysystem-sftp-v3",
+			"time": "2022-01-04T22:02:01+00:00"
+		},
+		{
+			"name": "league/flysystem-ziparchive",
+			"version": "1.0.3",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/thephpleague/flysystem-ziparchive.git",
+				"reference": "c6d7c7ea23a57ee802d533ab9eb9f19dd5c5fc45"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/thephpleague/flysystem-ziparchive/zipball/c6d7c7ea23a57ee802d533ab9eb9f19dd5c5fc45",
+				"reference": "c6d7c7ea23a57ee802d533ab9eb9f19dd5c5fc45",
+				"shasum": ""
+			},
+			"require": {
+				"ext-zip": "*",
+				"league/flysystem": "~1.0",
+				"php": ">=5.4.0"
+			},
+			"require-dev": {
+				"mockery/mockery": "0.9.*",
+				"phpunit/phpunit": "~4.0"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "1.0-dev"
+				}
+			},
+			"autoload": {
+				"psr-4": {
+					"League\\Flysystem\\ZipArchive\\": "src/"
+				}
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "Frank de Jonge",
+					"email": "info@frenky.net"
+				}
+			],
+			"description": "Flysystem adapter for ZipArchive's",
+			"support": {
+				"issues": "https://github.com/thephpleague/flysystem-ziparchive/issues",
+				"source": "https://github.com/thephpleague/flysystem-ziparchive/tree/master"
+			},
+			"time": "2016-12-20T08:36:16+00:00"
+		},
+		{
+			"name": "league/mime-type-detection",
+			"version": "1.11.0",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/thephpleague/mime-type-detection.git",
+				"reference": "ff6248ea87a9f116e78edd6002e39e5128a0d4dd"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/thephpleague/mime-type-detection/zipball/ff6248ea87a9f116e78edd6002e39e5128a0d4dd",
+				"reference": "ff6248ea87a9f116e78edd6002e39e5128a0d4dd",
+				"shasum": ""
+			},
+			"require": {
+				"ext-fileinfo": "*",
+				"php": "^7.2 || ^8.0"
+			},
+			"require-dev": {
+				"friendsofphp/php-cs-fixer": "^3.2",
+				"phpstan/phpstan": "^0.12.68",
+				"phpunit/phpunit": "^8.5.8 || ^9.3"
+			},
+			"type": "library",
+			"autoload": {
+				"psr-4": {
+					"League\\MimeTypeDetection\\": "src"
+				}
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "Frank de Jonge",
+					"email": "info@frankdejonge.nl"
+				}
+			],
+			"description": "Mime-type detection for Flysystem",
+			"support": {
+				"issues": "https://github.com/thephpleague/mime-type-detection/issues",
+				"source": "https://github.com/thephpleague/mime-type-detection/tree/1.11.0"
+			},
+			"funding": [
+				{
+					"url": "https://github.com/frankdejonge",
+					"type": "github"
+				},
+				{
+					"url": "https://tidelift.com/funding/github/packagist/league/flysystem",
+					"type": "tidelift"
+				}
+			],
+			"time": "2022-04-17T13:12:02+00:00"
+		},
+		{
+			"name": "monolog/monolog",
+			"version": "1.27.1",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/Seldaek/monolog.git",
+				"reference": "904713c5929655dc9b97288b69cfeedad610c9a1"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/Seldaek/monolog/zipball/904713c5929655dc9b97288b69cfeedad610c9a1",
+				"reference": "904713c5929655dc9b97288b69cfeedad610c9a1",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=5.3.0",
+				"psr/log": "~1.0"
+			},
+			"provide": {
+				"psr/log-implementation": "1.0.0"
+			},
+			"require-dev": {
+				"aws/aws-sdk-php": "^2.4.9 || ^3.0",
+				"doctrine/couchdb": "~1.0@dev",
+				"graylog2/gelf-php": "~1.0",
+				"php-amqplib/php-amqplib": "~2.4",
+				"php-console/php-console": "^3.1.3",
+				"phpstan/phpstan": "^0.12.59",
+				"phpunit/phpunit": "~4.5",
+				"ruflin/elastica": ">=0.90 <3.0",
+				"sentry/sentry": "^0.13",
+				"swiftmailer/swiftmailer": "^5.3|^6.0"
+			},
+			"suggest": {
+				"aws/aws-sdk-php": "Allow sending log messages to AWS services like DynamoDB",
+				"doctrine/couchdb": "Allow sending log messages to a CouchDB server",
+				"ext-amqp": "Allow sending log messages to an AMQP server (1.0+ required)",
+				"ext-mongo": "Allow sending log messages to a MongoDB server",
+				"graylog2/gelf-php": "Allow sending log messages to a GrayLog2 server",
+				"mongodb/mongodb": "Allow sending log messages to a MongoDB server via PHP Driver",
+				"php-amqplib/php-amqplib": "Allow sending log messages to an AMQP server using php-amqplib",
+				"php-console/php-console": "Allow sending log messages to Google Chrome",
+				"rollbar/rollbar": "Allow sending log messages to Rollbar",
+				"ruflin/elastica": "Allow sending log messages to an Elastic Search server",
+				"sentry/sentry": "Allow sending log messages to a Sentry server"
+			},
+			"type": "library",
+			"autoload": {
+				"psr-4": {
+					"Monolog\\": "src/Monolog"
+				}
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "Jordi Boggiano",
+					"email": "j.boggiano@seld.be",
+					"homepage": "http://seld.be"
+				}
+			],
+			"description": "Sends your logs to files, sockets, inboxes, databases and various web services",
+			"homepage": "http://github.com/Seldaek/monolog",
+			"keywords": [
+				"log",
+				"logging",
+				"psr-3"
+			],
+			"support": {
+				"issues": "https://github.com/Seldaek/monolog/issues",
+				"source": "https://github.com/Seldaek/monolog/tree/1.27.1"
+			},
+			"funding": [
+				{
+					"url": "https://github.com/Seldaek",
+					"type": "github"
+				},
+				{
+					"url": "https://tidelift.com/funding/github/packagist/monolog/monolog",
+					"type": "tidelift"
+				}
+			],
+			"time": "2022-06-09T08:53:42+00:00"
+		},
+		{
+			"name": "nikic/fast-route",
+			"version": "v1.3.0",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/nikic/FastRoute.git",
+				"reference": "181d480e08d9476e61381e04a71b34dc0432e812"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/nikic/FastRoute/zipball/181d480e08d9476e61381e04a71b34dc0432e812",
+				"reference": "181d480e08d9476e61381e04a71b34dc0432e812",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=5.4.0"
+			},
+			"require-dev": {
+				"phpunit/phpunit": "^4.8.35|~5.7"
+			},
+			"type": "library",
+			"autoload": {
+				"files": [
+					"src/functions.php"
+				],
+				"psr-4": {
+					"FastRoute\\": "src/"
+				}
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause"
+			],
+			"authors": [
+				{
+					"name": "Nikita Popov",
+					"email": "nikic@php.net"
+				}
+			],
+			"description": "Fast request router for PHP",
+			"keywords": [
+				"router",
+				"routing"
+			],
+			"support": {
+				"issues": "https://github.com/nikic/FastRoute/issues",
+				"source": "https://github.com/nikic/FastRoute/tree/master"
+			},
+			"time": "2018-02-13T20:26:39+00:00"
+		},
+		{
+			"name": "opis/closure",
+			"version": "3.6.3",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/opis/closure.git",
+				"reference": "3d81e4309d2a927abbe66df935f4bb60082805ad"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/opis/closure/zipball/3d81e4309d2a927abbe66df935f4bb60082805ad",
+				"reference": "3d81e4309d2a927abbe66df935f4bb60082805ad",
+				"shasum": ""
+			},
+			"require": {
+				"php": "^5.4 || ^7.0 || ^8.0"
+			},
+			"require-dev": {
+				"jeremeamia/superclosure": "^2.0",
+				"phpunit/phpunit": "^4.0 || ^5.0 || ^6.0 || ^7.0 || ^8.0 || ^9.0"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "3.6.x-dev"
+				}
+			},
+			"autoload": {
+				"files": [
+					"functions.php"
+				],
+				"psr-4": {
+					"Opis\\Closure\\": "src/"
+				}
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "Marius Sarca",
+					"email": "marius.sarca@gmail.com"
+				},
+				{
+					"name": "Sorin Sarca",
+					"email": "sarca_sorin@hotmail.com"
+				}
+			],
+			"description": "A library that can be used to serialize closures (anonymous functions) and arbitrary objects.",
+			"homepage": "https://opis.io/closure",
+			"keywords": [
+				"anonymous functions",
+				"closure",
+				"function",
+				"serializable",
+				"serialization",
+				"serialize"
+			],
+			"support": {
+				"issues": "https://github.com/opis/closure/issues",
+				"source": "https://github.com/opis/closure/tree/3.6.3"
+			},
+			"time": "2022-01-27T09:35:39+00:00"
+		},
+		{
+			"name": "php-di/invoker",
+			"version": "2.0.0",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/PHP-DI/Invoker.git",
+				"reference": "540c27c86f663e20fe39a24cd72fa76cdb21d41a"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/PHP-DI/Invoker/zipball/540c27c86f663e20fe39a24cd72fa76cdb21d41a",
+				"reference": "540c27c86f663e20fe39a24cd72fa76cdb21d41a",
+				"shasum": ""
+			},
+			"require": {
+				"psr/container": "~1.0"
+			},
+			"require-dev": {
+				"athletic/athletic": "~0.1.8",
+				"phpunit/phpunit": "~4.5"
+			},
+			"type": "library",
+			"autoload": {
+				"psr-4": {
+					"Invoker\\": "src/"
+				}
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"description": "Generic and extensible callable invoker",
+			"homepage": "https://github.com/PHP-DI/Invoker",
+			"keywords": [
+				"callable",
+				"dependency",
+				"dependency-injection",
+				"injection",
+				"invoke",
+				"invoker"
+			],
+			"support": {
+				"issues": "https://github.com/PHP-DI/Invoker/issues",
+				"source": "https://github.com/PHP-DI/Invoker/tree/master"
+			},
+			"time": "2017-03-20T19:28:22+00:00"
+		},
+		{
+			"name": "php-di/php-di",
+			"version": "6.3.5",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/PHP-DI/PHP-DI.git",
+				"reference": "b8126d066ce144765300ee0ab040c1ed6c9ef588"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/PHP-DI/PHP-DI/zipball/b8126d066ce144765300ee0ab040c1ed6c9ef588",
+				"reference": "b8126d066ce144765300ee0ab040c1ed6c9ef588",
+				"shasum": ""
+			},
+			"require": {
+				"opis/closure": "^3.5.5",
+				"php": ">=7.2.0",
+				"php-di/invoker": "^2.0",
+				"php-di/phpdoc-reader": "^2.0.1",
+				"psr/container": "^1.0"
+			},
+			"provide": {
+				"psr/container-implementation": "^1.0"
+			},
+			"require-dev": {
+				"doctrine/annotations": "~1.2",
+				"friendsofphp/php-cs-fixer": "^2.4",
+				"mnapoli/phpunit-easymock": "^1.2",
+				"ocramius/proxy-manager": "^2.0.2",
+				"phpstan/phpstan": "^0.12",
+				"phpunit/phpunit": "^8.5|^9.0"
+			},
+			"suggest": {
+				"doctrine/annotations": "Install it if you want to use annotations (version ~1.2)",
+				"ocramius/proxy-manager": "Install it if you want to use lazy injection (version ~2.0)"
+			},
+			"type": "library",
+			"autoload": {
+				"files": [
+					"src/functions.php"
+				],
+				"psr-4": {
+					"DI\\": "src/"
+				}
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"description": "The dependency injection container for humans",
+			"homepage": "https://php-di.org/",
+			"keywords": [
+				"PSR-11",
+				"container",
+				"container-interop",
+				"dependency injection",
+				"di",
+				"ioc",
+				"psr11"
+			],
+			"support": {
+				"issues": "https://github.com/PHP-DI/PHP-DI/issues",
+				"source": "https://github.com/PHP-DI/PHP-DI/tree/6.3.5"
+			},
+			"funding": [
+				{
+					"url": "https://github.com/mnapoli",
+					"type": "github"
+				},
+				{
+					"url": "https://tidelift.com/funding/github/packagist/php-di/php-di",
+					"type": "tidelift"
+				}
+			],
+			"time": "2021-09-02T09:49:58+00:00"
+		},
+		{
+			"name": "php-di/phpdoc-reader",
+			"version": "2.2.1",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/PHP-DI/PhpDocReader.git",
+				"reference": "66daff34cbd2627740ffec9469ffbac9f8c8185c"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/PHP-DI/PhpDocReader/zipball/66daff34cbd2627740ffec9469ffbac9f8c8185c",
+				"reference": "66daff34cbd2627740ffec9469ffbac9f8c8185c",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.2.0"
+			},
+			"require-dev": {
+				"mnapoli/hard-mode": "~0.3.0",
+				"phpunit/phpunit": "^8.5|^9.0"
+			},
+			"type": "library",
+			"autoload": {
+				"psr-4": {
+					"PhpDocReader\\": "src/PhpDocReader"
+				}
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"description": "PhpDocReader parses @var and @param values in PHP docblocks (supports namespaced class names with the same resolution rules as PHP)",
+			"keywords": [
+				"phpdoc",
+				"reflection"
+			],
+			"support": {
+				"issues": "https://github.com/PHP-DI/PhpDocReader/issues",
+				"source": "https://github.com/PHP-DI/PhpDocReader/tree/2.2.1"
+			},
+			"time": "2020-10-12T12:39:22+00:00"
+		},
+		{
+			"name": "phpseclib/phpseclib",
+			"version": "2.0.41",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/phpseclib/phpseclib.git",
+				"reference": "7e763c6f97ec1fcb37c46aa8ecfc20a2c71d9c1b"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/phpseclib/phpseclib/zipball/7e763c6f97ec1fcb37c46aa8ecfc20a2c71d9c1b",
+				"reference": "7e763c6f97ec1fcb37c46aa8ecfc20a2c71d9c1b",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=5.3.3"
+			},
+			"require-dev": {
+				"phing/phing": "~2.7",
+				"phpunit/phpunit": "^4.8.35|^5.7|^6.0|^9.4",
+				"squizlabs/php_codesniffer": "~2.0"
+			},
+			"suggest": {
+				"ext-gmp": "Install the GMP (GNU Multiple Precision) extension in order to speed up arbitrary precision integer arithmetic operations.",
+				"ext-libsodium": "SSH2/SFTP can make use of some algorithms provided by the libsodium-php extension.",
+				"ext-mcrypt": "Install the Mcrypt extension in order to speed up a few other cryptographic operations.",
+				"ext-openssl": "Install the OpenSSL extension in order to speed up a wide variety of cryptographic operations.",
+				"ext-xml": "Install the XML extension to load XML formatted public keys."
+			},
+			"type": "library",
+			"autoload": {
+				"files": [
+					"phpseclib/bootstrap.php"
+				],
+				"psr-4": {
+					"phpseclib\\": "phpseclib/"
+				}
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "Jim Wigginton",
+					"email": "terrafrost@php.net",
+					"role": "Lead Developer"
+				},
+				{
+					"name": "Patrick Monnerat",
+					"email": "pm@datasphere.ch",
+					"role": "Developer"
+				},
+				{
+					"name": "Andreas Fischer",
+					"email": "bantu@phpbb.com",
+					"role": "Developer"
+				},
+				{
+					"name": "Hans-Jrgen Petrich",
+					"email": "petrich@tronic-media.com",
+					"role": "Developer"
+				},
+				{
+					"name": "Graham Campbell",
+					"email": "graham@alt-three.com",
+					"role": "Developer"
+				}
+			],
+			"description": "PHP Secure Communications Library - Pure-PHP implementations of RSA, AES, SSH2, SFTP, X.509 etc.",
+			"homepage": "http://phpseclib.sourceforge.net",
+			"keywords": [
+				"BigInteger",
+				"aes",
+				"asn.1",
+				"asn1",
+				"blowfish",
+				"crypto",
+				"cryptography",
+				"encryption",
+				"rsa",
+				"security",
+				"sftp",
+				"signature",
+				"signing",
+				"ssh",
+				"twofish",
+				"x.509",
+				"x509"
+			],
+			"support": {
+				"issues": "https://github.com/phpseclib/phpseclib/issues",
+				"source": "https://github.com/phpseclib/phpseclib/tree/2.0.41"
+			},
+			"funding": [
+				{
+					"url": "https://github.com/terrafrost",
+					"type": "github"
+				},
+				{
+					"url": "https://www.patreon.com/phpseclib",
+					"type": "patreon"
+				},
+				{
+					"url": "https://tidelift.com/funding/github/packagist/phpseclib/phpseclib",
+					"type": "tidelift"
+				}
+			],
+			"time": "2022-12-23T16:44:18+00:00"
+		},
+		{
+			"name": "psr/container",
+			"version": "1.1.1",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/php-fig/container.git",
+				"reference": "8622567409010282b7aeebe4bb841fe98b58dcaf"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/php-fig/container/zipball/8622567409010282b7aeebe4bb841fe98b58dcaf",
+				"reference": "8622567409010282b7aeebe4bb841fe98b58dcaf",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.2.0"
+			},
+			"type": "library",
+			"autoload": {
+				"psr-4": {
+					"Psr\\Container\\": "src/"
+				}
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "PHP-FIG",
+					"homepage": "https://www.php-fig.org/"
+				}
+			],
+			"description": "Common Container Interface (PHP FIG PSR-11)",
+			"homepage": "https://github.com/php-fig/container",
+			"keywords": [
+				"PSR-11",
+				"container",
+				"container-interface",
+				"container-interop",
+				"psr"
+			],
+			"support": {
+				"issues": "https://github.com/php-fig/container/issues",
+				"source": "https://github.com/php-fig/container/tree/1.1.1"
+			},
+			"time": "2021-03-05T17:36:06+00:00"
+		},
+		{
+			"name": "psr/event-dispatcher",
+			"version": "1.0.0",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/php-fig/event-dispatcher.git",
+				"reference": "dbefd12671e8a14ec7f180cab83036ed26714bb0"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/php-fig/event-dispatcher/zipball/dbefd12671e8a14ec7f180cab83036ed26714bb0",
+				"reference": "dbefd12671e8a14ec7f180cab83036ed26714bb0",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.2.0"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "1.0.x-dev"
+				}
+			},
+			"autoload": {
+				"psr-4": {
+					"Psr\\EventDispatcher\\": "src/"
+				}
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "PHP-FIG",
+					"homepage": "http://www.php-fig.org/"
+				}
+			],
+			"description": "Standard interfaces for event handling.",
+			"keywords": [
+				"events",
+				"psr",
+				"psr-14"
+			],
+			"support": {
+				"issues": "https://github.com/php-fig/event-dispatcher/issues",
+				"source": "https://github.com/php-fig/event-dispatcher/tree/1.0.0"
+			},
+			"time": "2019-01-08T18:20:26+00:00"
+		},
+		{
+			"name": "psr/log",
+			"version": "1.1.4",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/php-fig/log.git",
+				"reference": "d49695b909c3b7628b6289db5479a1c204601f11"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/php-fig/log/zipball/d49695b909c3b7628b6289db5479a1c204601f11",
+				"reference": "d49695b909c3b7628b6289db5479a1c204601f11",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=5.3.0"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "1.1.x-dev"
+				}
+			},
+			"autoload": {
+				"psr-4": {
+					"Psr\\Log\\": "Psr/Log/"
+				}
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "PHP-FIG",
+					"homepage": "https://www.php-fig.org/"
+				}
+			],
+			"description": "Common interface for logging libraries",
+			"homepage": "https://github.com/php-fig/log",
+			"keywords": [
+				"log",
+				"psr",
+				"psr-3"
+			],
+			"support": {
+				"source": "https://github.com/php-fig/log/tree/1.1.4"
+			},
+			"time": "2021-05-03T11:20:27+00:00"
+		},
+		{
+			"name": "rakit/validation",
+			"version": "v1.4.0",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/rakit/validation.git",
+				"reference": "ff003a35cdf5030a5f2482299f4c93f344a35b29"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/rakit/validation/zipball/ff003a35cdf5030a5f2482299f4c93f344a35b29",
+				"reference": "ff003a35cdf5030a5f2482299f4c93f344a35b29",
+				"shasum": ""
+			},
+			"require": {
+				"ext-mbstring": "*",
+				"php": ">=7.0"
+			},
+			"require-dev": {
+				"php-coveralls/php-coveralls": "^2.2",
+				"phpunit/phpunit": "^6.5",
+				"squizlabs/php_codesniffer": "^3"
+			},
+			"type": "library",
+			"autoload": {
+				"psr-4": {
+					"Rakit\\Validation\\": "src"
+				}
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "Muhammad Syifa",
+					"email": "emsifa@gmail.com"
+				}
+			],
+			"description": "PHP Laravel like standalone validation library",
+			"support": {
+				"issues": "https://github.com/rakit/validation/issues",
+				"source": "https://github.com/rakit/validation/tree/v1.4.0"
+			},
+			"time": "2020-08-27T05:07:01+00:00"
+		},
+		{
+			"name": "symfony/deprecation-contracts",
+			"version": "v2.5.2",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/symfony/deprecation-contracts.git",
+				"reference": "e8b495ea28c1d97b5e0c121748d6f9b53d075c66"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/symfony/deprecation-contracts/zipball/e8b495ea28c1d97b5e0c121748d6f9b53d075c66",
+				"reference": "e8b495ea28c1d97b5e0c121748d6f9b53d075c66",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.1"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-main": "2.5-dev"
+				},
+				"thanks": {
+					"name": "symfony/contracts",
+					"url": "https://github.com/symfony/contracts"
+				}
+			},
+			"autoload": {
+				"files": [
+					"function.php"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "Nicolas Grekas",
+					"email": "p@tchwork.com"
+				},
+				{
+					"name": "Symfony Community",
+					"homepage": "https://symfony.com/contributors"
+				}
+			],
+			"description": "A generic function and convention to trigger deprecation notices",
+			"homepage": "https://symfony.com",
+			"support": {
+				"source": "https://github.com/symfony/deprecation-contracts/tree/v2.5.2"
+			},
+			"funding": [
+				{
+					"url": "https://symfony.com/sponsor",
+					"type": "custom"
+				},
+				{
+					"url": "https://github.com/fabpot",
+					"type": "github"
+				},
+				{
+					"url": "https://tidelift.com/funding/github/packagist/symfony/symfony",
+					"type": "tidelift"
+				}
+			],
+			"time": "2022-01-02T09:53:40+00:00"
+		},
+		{
+			"name": "symfony/event-dispatcher-contracts",
+			"version": "v2.5.2",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/symfony/event-dispatcher-contracts.git",
+				"reference": "f98b54df6ad059855739db6fcbc2d36995283fe1"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/symfony/event-dispatcher-contracts/zipball/f98b54df6ad059855739db6fcbc2d36995283fe1",
+				"reference": "f98b54df6ad059855739db6fcbc2d36995283fe1",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.2.5",
+				"psr/event-dispatcher": "^1"
+			},
+			"suggest": {
+				"symfony/event-dispatcher-implementation": ""
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-main": "2.5-dev"
+				},
+				"thanks": {
+					"name": "symfony/contracts",
+					"url": "https://github.com/symfony/contracts"
+				}
+			},
+			"autoload": {
+				"psr-4": {
+					"Symfony\\Contracts\\EventDispatcher\\": ""
+				}
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "Nicolas Grekas",
+					"email": "p@tchwork.com"
+				},
+				{
+					"name": "Symfony Community",
+					"homepage": "https://symfony.com/contributors"
+				}
+			],
+			"description": "Generic abstractions related to dispatching event",
+			"homepage": "https://symfony.com",
+			"keywords": [
+				"abstractions",
+				"contracts",
+				"decoupling",
+				"interfaces",
+				"interoperability",
+				"standards"
+			],
+			"support": {
+				"source": "https://github.com/symfony/event-dispatcher-contracts/tree/v2.5.2"
+			},
+			"funding": [
+				{
+					"url": "https://symfony.com/sponsor",
+					"type": "custom"
+				},
+				{
+					"url": "https://github.com/fabpot",
+					"type": "github"
+				},
+				{
+					"url": "https://tidelift.com/funding/github/packagist/symfony/symfony",
+					"type": "tidelift"
+				}
+			],
+			"time": "2022-01-02T09:53:40+00:00"
+		},
+		{
+			"name": "symfony/http-foundation",
+			"version": "v4.4.49",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/symfony/http-foundation.git",
+				"reference": "191413c7b832c015bb38eae963f2e57498c3c173"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/symfony/http-foundation/zipball/191413c7b832c015bb38eae963f2e57498c3c173",
+				"reference": "191413c7b832c015bb38eae963f2e57498c3c173",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.1.3",
+				"symfony/mime": "^4.3|^5.0",
+				"symfony/polyfill-mbstring": "~1.1",
+				"symfony/polyfill-php80": "^1.16"
+			},
+			"require-dev": {
+				"predis/predis": "~1.0",
+				"symfony/expression-language": "^3.4|^4.0|^5.0"
+			},
+			"type": "library",
+			"autoload": {
+				"psr-4": {
+					"Symfony\\Component\\HttpFoundation\\": ""
+				},
+				"exclude-from-classmap": [
+					"/Tests/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "Fabien Potencier",
+					"email": "fabien@symfony.com"
+				},
+				{
+					"name": "Symfony Community",
+					"homepage": "https://symfony.com/contributors"
+				}
+			],
+			"description": "Defines an object-oriented layer for the HTTP specification",
+			"homepage": "https://symfony.com",
+			"support": {
+				"source": "https://github.com/symfony/http-foundation/tree/v4.4.49"
+			},
+			"funding": [
+				{
+					"url": "https://symfony.com/sponsor",
+					"type": "custom"
+				},
+				{
+					"url": "https://github.com/fabpot",
+					"type": "github"
+				},
+				{
+					"url": "https://tidelift.com/funding/github/packagist/symfony/symfony",
+					"type": "tidelift"
+				}
+			],
+			"time": "2022-11-04T16:17:57+00:00"
+		},
+		{
+			"name": "symfony/mime",
+			"version": "v5.4.19",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/symfony/mime.git",
+				"reference": "a858429a9c704edc53fe057228cf9ca282ba48eb"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/symfony/mime/zipball/a858429a9c704edc53fe057228cf9ca282ba48eb",
+				"reference": "a858429a9c704edc53fe057228cf9ca282ba48eb",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.2.5",
+				"symfony/deprecation-contracts": "^2.1|^3",
+				"symfony/polyfill-intl-idn": "^1.10",
+				"symfony/polyfill-mbstring": "^1.0",
+				"symfony/polyfill-php80": "^1.16"
+			},
+			"conflict": {
+				"egulias/email-validator": "~3.0.0",
+				"phpdocumentor/reflection-docblock": "<3.2.2",
+				"phpdocumentor/type-resolver": "<1.4.0",
+				"symfony/mailer": "<4.4",
+				"symfony/serializer": "<5.4.14|>=6.0,<6.0.14|>=6.1,<6.1.6"
+			},
+			"require-dev": {
+				"egulias/email-validator": "^2.1.10|^3.1|^4",
+				"phpdocumentor/reflection-docblock": "^3.0|^4.0|^5.0",
+				"symfony/dependency-injection": "^4.4|^5.0|^6.0",
+				"symfony/property-access": "^4.4|^5.1|^6.0",
+				"symfony/property-info": "^4.4|^5.1|^6.0",
+				"symfony/serializer": "^5.4.14|~6.0.14|^6.1.6"
+			},
+			"type": "library",
+			"autoload": {
+				"psr-4": {
+					"Symfony\\Component\\Mime\\": ""
+				},
+				"exclude-from-classmap": [
+					"/Tests/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "Fabien Potencier",
+					"email": "fabien@symfony.com"
+				},
+				{
+					"name": "Symfony Community",
+					"homepage": "https://symfony.com/contributors"
+				}
+			],
+			"description": "Allows manipulating MIME messages",
+			"homepage": "https://symfony.com",
+			"keywords": [
+				"mime",
+				"mime-type"
+			],
+			"support": {
+				"source": "https://github.com/symfony/mime/tree/v5.4.19"
+			},
+			"funding": [
+				{
+					"url": "https://symfony.com/sponsor",
+					"type": "custom"
+				},
+				{
+					"url": "https://github.com/fabpot",
+					"type": "github"
+				},
+				{
+					"url": "https://tidelift.com/funding/github/packagist/symfony/symfony",
+					"type": "tidelift"
+				}
+			],
+			"time": "2023-01-09T05:43:46+00:00"
+		},
+		{
+			"name": "symfony/polyfill-intl-idn",
+			"version": "v1.27.0",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/symfony/polyfill-intl-idn.git",
+				"reference": "639084e360537a19f9ee352433b84ce831f3d2da"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/symfony/polyfill-intl-idn/zipball/639084e360537a19f9ee352433b84ce831f3d2da",
+				"reference": "639084e360537a19f9ee352433b84ce831f3d2da",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.1",
+				"symfony/polyfill-intl-normalizer": "^1.10",
+				"symfony/polyfill-php72": "^1.10"
+			},
+			"suggest": {
+				"ext-intl": "For best performance"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-main": "1.27-dev"
+				},
+				"thanks": {
+					"name": "symfony/polyfill",
+					"url": "https://github.com/symfony/polyfill"
+				}
+			},
+			"autoload": {
+				"files": [
+					"bootstrap.php"
+				],
+				"psr-4": {
+					"Symfony\\Polyfill\\Intl\\Idn\\": ""
+				}
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "Laurent Bassin",
+					"email": "laurent@bassin.info"
+				},
+				{
+					"name": "Trevor Rowbotham",
+					"email": "trevor.rowbotham@pm.me"
+				},
+				{
+					"name": "Symfony Community",
+					"homepage": "https://symfony.com/contributors"
+				}
+			],
+			"description": "Symfony polyfill for intl's idn_to_ascii and idn_to_utf8 functions",
+			"homepage": "https://symfony.com",
+			"keywords": [
+				"compatibility",
+				"idn",
+				"intl",
+				"polyfill",
+				"portable",
+				"shim"
+			],
+			"support": {
+				"source": "https://github.com/symfony/polyfill-intl-idn/tree/v1.27.0"
+			},
+			"funding": [
+				{
+					"url": "https://symfony.com/sponsor",
+					"type": "custom"
+				},
+				{
+					"url": "https://github.com/fabpot",
+					"type": "github"
+				},
+				{
+					"url": "https://tidelift.com/funding/github/packagist/symfony/symfony",
+					"type": "tidelift"
+				}
+			],
+			"time": "2022-11-03T14:55:06+00:00"
+		},
+		{
+			"name": "symfony/polyfill-intl-normalizer",
+			"version": "v1.27.0",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/symfony/polyfill-intl-normalizer.git",
+				"reference": "19bd1e4fcd5b91116f14d8533c57831ed00571b6"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/symfony/polyfill-intl-normalizer/zipball/19bd1e4fcd5b91116f14d8533c57831ed00571b6",
+				"reference": "19bd1e4fcd5b91116f14d8533c57831ed00571b6",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.1"
+			},
+			"suggest": {
+				"ext-intl": "For best performance"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-main": "1.27-dev"
+				},
+				"thanks": {
+					"name": "symfony/polyfill",
+					"url": "https://github.com/symfony/polyfill"
+				}
+			},
+			"autoload": {
+				"files": [
+					"bootstrap.php"
+				],
+				"psr-4": {
+					"Symfony\\Polyfill\\Intl\\Normalizer\\": ""
+				},
+				"classmap": [
+					"Resources/stubs"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "Nicolas Grekas",
+					"email": "p@tchwork.com"
+				},
+				{
+					"name": "Symfony Community",
+					"homepage": "https://symfony.com/contributors"
+				}
+			],
+			"description": "Symfony polyfill for intl's Normalizer class and related functions",
+			"homepage": "https://symfony.com",
+			"keywords": [
+				"compatibility",
+				"intl",
+				"normalizer",
+				"polyfill",
+				"portable",
+				"shim"
+			],
+			"support": {
+				"source": "https://github.com/symfony/polyfill-intl-normalizer/tree/v1.27.0"
+			},
+			"funding": [
+				{
+					"url": "https://symfony.com/sponsor",
+					"type": "custom"
+				},
+				{
+					"url": "https://github.com/fabpot",
+					"type": "github"
+				},
+				{
+					"url": "https://tidelift.com/funding/github/packagist/symfony/symfony",
+					"type": "tidelift"
+				}
+			],
+			"time": "2022-11-03T14:55:06+00:00"
+		},
+		{
+			"name": "symfony/polyfill-mbstring",
+			"version": "v1.27.0",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/symfony/polyfill-mbstring.git",
+				"reference": "8ad114f6b39e2c98a8b0e3bd907732c207c2b534"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/symfony/polyfill-mbstring/zipball/8ad114f6b39e2c98a8b0e3bd907732c207c2b534",
+				"reference": "8ad114f6b39e2c98a8b0e3bd907732c207c2b534",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.1"
+			},
+			"provide": {
+				"ext-mbstring": "*"
+			},
+			"suggest": {
+				"ext-mbstring": "For best performance"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-main": "1.27-dev"
+				},
+				"thanks": {
+					"name": "symfony/polyfill",
+					"url": "https://github.com/symfony/polyfill"
+				}
+			},
+			"autoload": {
+				"files": [
+					"bootstrap.php"
+				],
+				"psr-4": {
+					"Symfony\\Polyfill\\Mbstring\\": ""
+				}
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "Nicolas Grekas",
+					"email": "p@tchwork.com"
+				},
+				{
+					"name": "Symfony Community",
+					"homepage": "https://symfony.com/contributors"
+				}
+			],
+			"description": "Symfony polyfill for the Mbstring extension",
+			"homepage": "https://symfony.com",
+			"keywords": [
+				"compatibility",
+				"mbstring",
+				"polyfill",
+				"portable",
+				"shim"
+			],
+			"support": {
+				"source": "https://github.com/symfony/polyfill-mbstring/tree/v1.27.0"
+			},
+			"funding": [
+				{
+					"url": "https://symfony.com/sponsor",
+					"type": "custom"
+				},
+				{
+					"url": "https://github.com/fabpot",
+					"type": "github"
+				},
+				{
+					"url": "https://tidelift.com/funding/github/packagist/symfony/symfony",
+					"type": "tidelift"
+				}
+			],
+			"time": "2022-11-03T14:55:06+00:00"
+		},
+		{
+			"name": "symfony/polyfill-php72",
+			"version": "v1.27.0",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/symfony/polyfill-php72.git",
+				"reference": "869329b1e9894268a8a61dabb69153029b7a8c97"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/symfony/polyfill-php72/zipball/869329b1e9894268a8a61dabb69153029b7a8c97",
+				"reference": "869329b1e9894268a8a61dabb69153029b7a8c97",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.1"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-main": "1.27-dev"
+				},
+				"thanks": {
+					"name": "symfony/polyfill",
+					"url": "https://github.com/symfony/polyfill"
+				}
+			},
+			"autoload": {
+				"files": [
+					"bootstrap.php"
+				],
+				"psr-4": {
+					"Symfony\\Polyfill\\Php72\\": ""
+				}
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "Nicolas Grekas",
+					"email": "p@tchwork.com"
+				},
+				{
+					"name": "Symfony Community",
+					"homepage": "https://symfony.com/contributors"
+				}
+			],
+			"description": "Symfony polyfill backporting some PHP 7.2+ features to lower PHP versions",
+			"homepage": "https://symfony.com",
+			"keywords": [
+				"compatibility",
+				"polyfill",
+				"portable",
+				"shim"
+			],
+			"support": {
+				"source": "https://github.com/symfony/polyfill-php72/tree/v1.27.0"
+			},
+			"funding": [
+				{
+					"url": "https://symfony.com/sponsor",
+					"type": "custom"
+				},
+				{
+					"url": "https://github.com/fabpot",
+					"type": "github"
+				},
+				{
+					"url": "https://tidelift.com/funding/github/packagist/symfony/symfony",
+					"type": "tidelift"
+				}
+			],
+			"time": "2022-11-03T14:55:06+00:00"
+		},
+		{
+			"name": "symfony/polyfill-php80",
+			"version": "v1.27.0",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/symfony/polyfill-php80.git",
+				"reference": "7a6ff3f1959bb01aefccb463a0f2cd3d3d2fd936"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/symfony/polyfill-php80/zipball/7a6ff3f1959bb01aefccb463a0f2cd3d3d2fd936",
+				"reference": "7a6ff3f1959bb01aefccb463a0f2cd3d3d2fd936",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.1"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-main": "1.27-dev"
+				},
+				"thanks": {
+					"name": "symfony/polyfill",
+					"url": "https://github.com/symfony/polyfill"
+				}
+			},
+			"autoload": {
+				"files": [
+					"bootstrap.php"
+				],
+				"psr-4": {
+					"Symfony\\Polyfill\\Php80\\": ""
+				},
+				"classmap": [
+					"Resources/stubs"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "Ion Bazan",
+					"email": "ion.bazan@gmail.com"
+				},
+				{
+					"name": "Nicolas Grekas",
+					"email": "p@tchwork.com"
+				},
+				{
+					"name": "Symfony Community",
+					"homepage": "https://symfony.com/contributors"
+				}
+			],
+			"description": "Symfony polyfill backporting some PHP 8.0+ features to lower PHP versions",
+			"homepage": "https://symfony.com",
+			"keywords": [
+				"compatibility",
+				"polyfill",
+				"portable",
+				"shim"
+			],
+			"support": {
+				"source": "https://github.com/symfony/polyfill-php80/tree/v1.27.0"
+			},
+			"funding": [
+				{
+					"url": "https://symfony.com/sponsor",
+					"type": "custom"
+				},
+				{
+					"url": "https://github.com/fabpot",
+					"type": "github"
+				},
+				{
+					"url": "https://tidelift.com/funding/github/packagist/symfony/symfony",
+					"type": "tidelift"
+				}
+			],
+			"time": "2022-11-03T14:55:06+00:00"
+		},
+		{
+			"name": "symfony/security-core",
+			"version": "v5.2.14",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/symfony/security-core.git",
+				"reference": "4ce2b1e532fb3bb591ad4efa8cc43afc9242a247"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/symfony/security-core/zipball/4ce2b1e532fb3bb591ad4efa8cc43afc9242a247",
+				"reference": "4ce2b1e532fb3bb591ad4efa8cc43afc9242a247",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.2.5",
+				"symfony/deprecation-contracts": "^2.1",
+				"symfony/event-dispatcher-contracts": "^1.1|^2",
+				"symfony/polyfill-php80": "^1.16",
+				"symfony/service-contracts": "^1.1.6|^2"
+			},
+			"conflict": {
+				"symfony/event-dispatcher": "<4.4",
+				"symfony/ldap": "<4.4",
+				"symfony/security-guard": "<4.4",
+				"symfony/validator": "<5.2"
+			},
+			"require-dev": {
+				"psr/container": "^1.0|^2.0",
+				"psr/log": "^1|^2|^3",
+				"symfony/event-dispatcher": "^4.4|^5.0",
+				"symfony/expression-language": "^4.4|^5.0",
+				"symfony/http-foundation": "^4.4|^5.0",
+				"symfony/ldap": "^4.4|^5.0",
+				"symfony/translation": "^4.4|^5.0",
+				"symfony/validator": "^5.2"
+			},
+			"suggest": {
+				"psr/container-implementation": "To instantiate the Security class",
+				"symfony/event-dispatcher": "",
+				"symfony/expression-language": "For using the expression voter",
+				"symfony/http-foundation": "",
+				"symfony/ldap": "For using LDAP integration",
+				"symfony/validator": "For using the user password constraint"
+			},
+			"type": "library",
+			"autoload": {
+				"psr-4": {
+					"Symfony\\Component\\Security\\Core\\": ""
+				},
+				"exclude-from-classmap": [
+					"/Tests/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "Fabien Potencier",
+					"email": "fabien@symfony.com"
+				},
+				{
+					"name": "Symfony Community",
+					"homepage": "https://symfony.com/contributors"
+				}
+			],
+			"description": "Symfony Security Component - Core Library",
+			"homepage": "https://symfony.com",
+			"support": {
+				"source": "https://github.com/symfony/security-core/tree/v5.2.14"
+			},
+			"funding": [
+				{
+					"url": "https://symfony.com/sponsor",
+					"type": "custom"
+				},
+				{
+					"url": "https://github.com/fabpot",
+					"type": "github"
+				},
+				{
+					"url": "https://tidelift.com/funding/github/packagist/symfony/symfony",
+					"type": "tidelift"
+				}
+			],
+			"time": "2021-07-29T06:36:20+00:00"
+		},
+		{
+			"name": "symfony/security-csrf",
+			"version": "v4.4.37",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/symfony/security-csrf.git",
+				"reference": "45c956ef58135091f53732646a0acd28034f02c0"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/symfony/security-csrf/zipball/45c956ef58135091f53732646a0acd28034f02c0",
+				"reference": "45c956ef58135091f53732646a0acd28034f02c0",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.1.3",
+				"symfony/polyfill-php80": "^1.16",
+				"symfony/security-core": "^3.4|^4.0|^5.0"
+			},
+			"conflict": {
+				"symfony/http-foundation": "<3.4"
+			},
+			"require-dev": {
+				"symfony/http-foundation": "^3.4|^4.0|^5.0"
+			},
+			"suggest": {
+				"symfony/http-foundation": "For using the class SessionTokenStorage."
+			},
+			"type": "library",
+			"autoload": {
+				"psr-4": {
+					"Symfony\\Component\\Security\\Csrf\\": ""
+				},
+				"exclude-from-classmap": [
+					"/Tests/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "Fabien Potencier",
+					"email": "fabien@symfony.com"
+				},
+				{
+					"name": "Symfony Community",
+					"homepage": "https://symfony.com/contributors"
+				}
+			],
+			"description": "Symfony Security Component - CSRF Library",
+			"homepage": "https://symfony.com",
+			"support": {
+				"source": "https://github.com/symfony/security-csrf/tree/v4.4.37"
+			},
+			"funding": [
+				{
+					"url": "https://symfony.com/sponsor",
+					"type": "custom"
+				},
+				{
+					"url": "https://github.com/fabpot",
+					"type": "github"
+				},
+				{
+					"url": "https://tidelift.com/funding/github/packagist/symfony/symfony",
+					"type": "tidelift"
+				}
+			],
+			"time": "2022-01-02T09:41:36+00:00"
+		},
+		{
+			"name": "symfony/service-contracts",
+			"version": "v2.5.2",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/symfony/service-contracts.git",
+				"reference": "4b426aac47d6427cc1a1d0f7e2ac724627f5966c"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/symfony/service-contracts/zipball/4b426aac47d6427cc1a1d0f7e2ac724627f5966c",
+				"reference": "4b426aac47d6427cc1a1d0f7e2ac724627f5966c",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.2.5",
+				"psr/container": "^1.1",
+				"symfony/deprecation-contracts": "^2.1|^3"
+			},
+			"conflict": {
+				"ext-psr": "<1.1|>=2"
+			},
+			"suggest": {
+				"symfony/service-implementation": ""
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-main": "2.5-dev"
+				},
+				"thanks": {
+					"name": "symfony/contracts",
+					"url": "https://github.com/symfony/contracts"
+				}
+			},
+			"autoload": {
+				"psr-4": {
+					"Symfony\\Contracts\\Service\\": ""
+				}
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "Nicolas Grekas",
+					"email": "p@tchwork.com"
+				},
+				{
+					"name": "Symfony Community",
+					"homepage": "https://symfony.com/contributors"
+				}
+			],
+			"description": "Generic abstractions related to writing services",
+			"homepage": "https://symfony.com",
+			"keywords": [
+				"abstractions",
+				"contracts",
+				"decoupling",
+				"interfaces",
+				"interoperability",
+				"standards"
+			],
+			"support": {
+				"source": "https://github.com/symfony/service-contracts/tree/v2.5.2"
+			},
+			"funding": [
+				{
+					"url": "https://symfony.com/sponsor",
+					"type": "custom"
+				},
+				{
+					"url": "https://github.com/fabpot",
+					"type": "github"
+				},
+				{
+					"url": "https://tidelift.com/funding/github/packagist/symfony/symfony",
+					"type": "tidelift"
+				}
+			],
+			"time": "2022-05-30T19:17:29+00:00"
+		}
+	],
+	"packages-dev": [
+		{
+			"name": "composer/package-versions-deprecated",
+			"version": "1.11.99.5",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/composer/package-versions-deprecated.git",
+				"reference": "b4f54f74ef3453349c24a845d22392cd31e65f1d"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/composer/package-versions-deprecated/zipball/b4f54f74ef3453349c24a845d22392cd31e65f1d",
+				"reference": "b4f54f74ef3453349c24a845d22392cd31e65f1d",
+				"shasum": ""
+			},
+			"require": {
+				"composer-plugin-api": "^1.1.0 || ^2.0",
+				"php": "^7 || ^8"
+			},
+			"replace": {
+				"ocramius/package-versions": "1.11.99"
+			},
+			"require-dev": {
+				"composer/composer": "^1.9.3 || ^2.0@dev",
+				"ext-zip": "^1.13",
+				"phpunit/phpunit": "^6.5 || ^7"
+			},
+			"type": "composer-plugin",
+			"extra": {
+				"class": "PackageVersions\\Installer",
+				"branch-alias": {
+					"dev-master": "1.x-dev"
+				}
+			},
+			"autoload": {
+				"psr-4": {
+					"PackageVersions\\": "src/PackageVersions"
+				}
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "Marco Pivetta",
+					"email": "ocramius@gmail.com"
+				},
+				{
+					"name": "Jordi Boggiano",
+					"email": "j.boggiano@seld.be"
+				}
+			],
+			"description": "Composer plugin that provides efficient querying for installed package versions (no runtime IO)",
+			"support": {
+				"issues": "https://github.com/composer/package-versions-deprecated/issues",
+				"source": "https://github.com/composer/package-versions-deprecated/tree/1.11.99.5"
+			},
+			"funding": [
+				{
+					"url": "https://packagist.com",
+					"type": "custom"
+				},
+				{
+					"url": "https://github.com/composer",
+					"type": "github"
+				},
+				{
+					"url": "https://tidelift.com/funding/github/packagist/composer/composer",
+					"type": "tidelift"
+				}
+			],
+			"time": "2022-01-17T14:14:24+00:00"
+		},
+		{
+			"name": "composer/xdebug-handler",
+			"version": "1.4.6",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/composer/xdebug-handler.git",
+				"reference": "f27e06cd9675801df441b3656569b328e04aa37c"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/composer/xdebug-handler/zipball/f27e06cd9675801df441b3656569b328e04aa37c",
+				"reference": "f27e06cd9675801df441b3656569b328e04aa37c",
+				"shasum": ""
+			},
+			"require": {
+				"php": "^5.3.2 || ^7.0 || ^8.0",
+				"psr/log": "^1.0"
+			},
+			"require-dev": {
+				"phpstan/phpstan": "^0.12.55",
+				"symfony/phpunit-bridge": "^4.2 || ^5"
+			},
+			"type": "library",
+			"autoload": {
+				"psr-4": {
+					"Composer\\XdebugHandler\\": "src"
+				}
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "John Stevenson",
+					"email": "john-stevenson@blueyonder.co.uk"
+				}
+			],
+			"description": "Restarts a process without Xdebug.",
+			"keywords": [
+				"Xdebug",
+				"performance"
+			],
+			"support": {
+				"irc": "irc://irc.freenode.org/composer",
+				"issues": "https://github.com/composer/xdebug-handler/issues",
+				"source": "https://github.com/composer/xdebug-handler/tree/1.4.6"
+			},
+			"funding": [
+				{
+					"url": "https://packagist.com",
+					"type": "custom"
+				},
+				{
+					"url": "https://github.com/composer",
+					"type": "github"
+				},
+				{
+					"url": "https://tidelift.com/funding/github/packagist/composer/composer",
+					"type": "tidelift"
+				}
+			],
+			"time": "2021-03-25T17:01:18+00:00"
+		},
+		{
+			"name": "doctrine/instantiator",
+			"version": "1.5.0",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/doctrine/instantiator.git",
+				"reference": "0a0fa9780f5d4e507415a065172d26a98d02047b"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/doctrine/instantiator/zipball/0a0fa9780f5d4e507415a065172d26a98d02047b",
+				"reference": "0a0fa9780f5d4e507415a065172d26a98d02047b",
+				"shasum": ""
+			},
+			"require": {
+				"php": "^7.1 || ^8.0"
+			},
+			"require-dev": {
+				"doctrine/coding-standard": "^9 || ^11",
+				"ext-pdo": "*",
+				"ext-phar": "*",
+				"phpbench/phpbench": "^0.16 || ^1",
+				"phpstan/phpstan": "^1.4",
+				"phpstan/phpstan-phpunit": "^1",
+				"phpunit/phpunit": "^7.5 || ^8.5 || ^9.5",
+				"vimeo/psalm": "^4.30 || ^5.4"
+			},
+			"type": "library",
+			"autoload": {
+				"psr-4": {
+					"Doctrine\\Instantiator\\": "src/Doctrine/Instantiator/"
+				}
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "Marco Pivetta",
+					"email": "ocramius@gmail.com",
+					"homepage": "https://ocramius.github.io/"
+				}
+			],
+			"description": "A small, lightweight utility to instantiate objects in PHP without invoking their constructors",
+			"homepage": "https://www.doctrine-project.org/projects/instantiator.html",
+			"keywords": [
+				"constructor",
+				"instantiate"
+			],
+			"support": {
+				"issues": "https://github.com/doctrine/instantiator/issues",
+				"source": "https://github.com/doctrine/instantiator/tree/1.5.0"
+			},
+			"funding": [
+				{
+					"url": "https://www.doctrine-project.org/sponsorship.html",
+					"type": "custom"
+				},
+				{
+					"url": "https://www.patreon.com/phpdoctrine",
+					"type": "patreon"
+				},
+				{
+					"url": "https://tidelift.com/funding/github/packagist/doctrine%2Finstantiator",
+					"type": "tidelift"
+				}
+			],
+			"time": "2022-12-30T00:15:36+00:00"
+		},
+		{
+			"name": "jean85/pretty-package-versions",
+			"version": "1.6.0",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/Jean85/pretty-package-versions.git",
+				"reference": "1e0104b46f045868f11942aea058cd7186d6c303"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/Jean85/pretty-package-versions/zipball/1e0104b46f045868f11942aea058cd7186d6c303",
+				"reference": "1e0104b46f045868f11942aea058cd7186d6c303",
+				"shasum": ""
+			},
+			"require": {
+				"composer/package-versions-deprecated": "^1.8.0",
+				"php": "^7.0|^8.0"
+			},
+			"require-dev": {
+				"phpunit/phpunit": "^6.0|^8.5|^9.2"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "1.x-dev"
+				}
+			},
+			"autoload": {
+				"psr-4": {
+					"Jean85\\": "src/"
+				}
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "Alessandro Lai",
+					"email": "alessandro.lai85@gmail.com"
+				}
+			],
+			"description": "A wrapper for ocramius/package-versions to get pretty versions strings",
+			"keywords": [
+				"composer",
+				"package",
+				"release",
+				"versions"
+			],
+			"support": {
+				"issues": "https://github.com/Jean85/pretty-package-versions/issues",
+				"source": "https://github.com/Jean85/pretty-package-versions/tree/1.6.0"
+			},
+			"time": "2021-02-04T16:20:16+00:00"
+		},
+		{
+			"name": "league/flysystem-memory",
+			"version": "1.0.2",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/thephpleague/flysystem-memory.git",
+				"reference": "d0e87477c32e29f999b4de05e64c1adcddb51757"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/thephpleague/flysystem-memory/zipball/d0e87477c32e29f999b4de05e64c1adcddb51757",
+				"reference": "d0e87477c32e29f999b4de05e64c1adcddb51757",
+				"shasum": ""
+			},
+			"require": {
+				"league/flysystem": "~1.0"
+			},
+			"require-dev": {
+				"phpunit/phpunit": "^5.7.10"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "1.0-dev"
+				}
+			},
+			"autoload": {
+				"psr-4": {
+					"League\\Flysystem\\Memory\\": "src/"
+				}
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "Chris Leppanen",
+					"email": "chris.leppanen@gmail.com",
+					"role": "Developer"
+				}
+			],
+			"description": "An in-memory adapter for Flysystem.",
+			"homepage": "https://github.com/thephpleague/flysystem-memory",
+			"keywords": [
+				"Flysystem",
+				"adapter",
+				"memory"
+			],
+			"support": {
+				"issues": "https://github.com/thephpleague/flysystem-memory/issues",
+				"source": "https://github.com/thephpleague/flysystem-memory/tree/1.0.2"
+			},
+			"time": "2019-05-30T21:34:13+00:00"
+		},
+		{
+			"name": "myclabs/deep-copy",
+			"version": "1.11.0",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/myclabs/DeepCopy.git",
+				"reference": "14daed4296fae74d9e3201d2c4925d1acb7aa614"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/myclabs/DeepCopy/zipball/14daed4296fae74d9e3201d2c4925d1acb7aa614",
+				"reference": "14daed4296fae74d9e3201d2c4925d1acb7aa614",
+				"shasum": ""
+			},
+			"require": {
+				"php": "^7.1 || ^8.0"
+			},
+			"conflict": {
+				"doctrine/collections": "<1.6.8",
+				"doctrine/common": "<2.13.3 || >=3,<3.2.2"
+			},
+			"require-dev": {
+				"doctrine/collections": "^1.6.8",
+				"doctrine/common": "^2.13.3 || ^3.2.2",
+				"phpunit/phpunit": "^7.5.20 || ^8.5.23 || ^9.5.13"
+			},
+			"type": "library",
+			"autoload": {
+				"files": [
+					"src/DeepCopy/deep_copy.php"
+				],
+				"psr-4": {
+					"DeepCopy\\": "src/DeepCopy/"
+				}
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"description": "Create deep copies (clones) of your objects",
+			"keywords": [
+				"clone",
+				"copy",
+				"duplicate",
+				"object",
+				"object graph"
+			],
+			"support": {
+				"issues": "https://github.com/myclabs/DeepCopy/issues",
+				"source": "https://github.com/myclabs/DeepCopy/tree/1.11.0"
+			},
+			"funding": [
+				{
+					"url": "https://tidelift.com/funding/github/packagist/myclabs/deep-copy",
+					"type": "tidelift"
+				}
+			],
+			"time": "2022-03-03T13:19:32+00:00"
+		},
+		{
+			"name": "nette/bootstrap",
+			"version": "v3.1.4",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/nette/bootstrap.git",
+				"reference": "1a7965b4ee401ad0e3f673b9c016d2481afdc280"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/nette/bootstrap/zipball/1a7965b4ee401ad0e3f673b9c016d2481afdc280",
+				"reference": "1a7965b4ee401ad0e3f673b9c016d2481afdc280",
+				"shasum": ""
+			},
+			"require": {
+				"nette/di": "^3.0.5",
+				"nette/utils": "^3.2.1 || ^4.0",
+				"php": ">=7.2 <8.3"
+			},
+			"conflict": {
+				"tracy/tracy": "<2.6"
+			},
+			"require-dev": {
+				"latte/latte": "^2.8",
+				"nette/application": "^3.1",
+				"nette/caching": "^3.0",
+				"nette/database": "^3.0",
+				"nette/forms": "^3.0",
+				"nette/http": "^3.0",
+				"nette/mail": "^3.0",
+				"nette/robot-loader": "^3.0",
+				"nette/safe-stream": "^2.2",
+				"nette/security": "^3.0",
+				"nette/tester": "^2.0",
+				"phpstan/phpstan-nette": "^0.12",
+				"tracy/tracy": "^2.6"
+			},
+			"suggest": {
+				"nette/robot-loader": "to use Configurator::createRobotLoader()",
+				"tracy/tracy": "to use Configurator::enableTracy()"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "3.1-dev"
+				}
+			},
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause",
+				"GPL-2.0-only",
+				"GPL-3.0-only"
+			],
+			"authors": [
+				{
+					"name": "David Grudl",
+					"homepage": "https://davidgrudl.com"
+				},
+				{
+					"name": "Nette Community",
+					"homepage": "https://nette.org/contributors"
+				}
+			],
+			"description": "  Nette Bootstrap: the simple way to configure and bootstrap your Nette application.",
+			"homepage": "https://nette.org",
+			"keywords": [
+				"bootstrapping",
+				"configurator",
+				"nette"
+			],
+			"support": {
+				"issues": "https://github.com/nette/bootstrap/issues",
+				"source": "https://github.com/nette/bootstrap/tree/v3.1.4"
+			},
+			"time": "2022-12-14T15:23:02+00:00"
+		},
+		{
+			"name": "nette/di",
+			"version": "v3.1.1",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/nette/di.git",
+				"reference": "4799ee684453bf5e70df1e87bec80bfbfc0e7d13"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/nette/di/zipball/4799ee684453bf5e70df1e87bec80bfbfc0e7d13",
+				"reference": "4799ee684453bf5e70df1e87bec80bfbfc0e7d13",
+				"shasum": ""
+			},
+			"require": {
+				"ext-tokenizer": "*",
+				"nette/neon": "^3.3 || ^4.0",
+				"nette/php-generator": "^3.5.4 || ^4.0",
+				"nette/robot-loader": "^3.2 || ~4.0.0",
+				"nette/schema": "^1.2",
+				"nette/utils": "^3.2.5 || ~4.0.0",
+				"php": ">=7.2 <8.3"
+			},
+			"require-dev": {
+				"nette/tester": "^2.4",
+				"phpstan/phpstan": "^1.0",
+				"tracy/tracy": "^2.9"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "3.1-dev"
+				}
+			},
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause",
+				"GPL-2.0-only",
+				"GPL-3.0-only"
+			],
+			"authors": [
+				{
+					"name": "David Grudl",
+					"homepage": "https://davidgrudl.com"
+				},
+				{
+					"name": "Nette Community",
+					"homepage": "https://nette.org/contributors"
+				}
+			],
+			"description": " Nette Dependency Injection Container: Flexible, compiled and full-featured DIC with perfectly usable autowiring and support for all new PHP features.",
+			"homepage": "https://nette.org",
+			"keywords": [
+				"compiled",
+				"di",
+				"dic",
+				"factory",
+				"ioc",
+				"nette",
+				"static"
+			],
+			"support": {
+				"issues": "https://github.com/nette/di/issues",
+				"source": "https://github.com/nette/di/tree/v3.1.1"
+			},
+			"time": "2023-01-16T03:38:02+00:00"
+		},
+		{
+			"name": "nette/finder",
+			"version": "v2.6.0",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/nette/finder.git",
+				"reference": "991aefb42860abeab8e003970c3809a9d83cb932"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/nette/finder/zipball/991aefb42860abeab8e003970c3809a9d83cb932",
+				"reference": "991aefb42860abeab8e003970c3809a9d83cb932",
+				"shasum": ""
+			},
+			"require": {
+				"nette/utils": "^2.4 || ^3.0",
+				"php": ">=7.1"
+			},
+			"conflict": {
+				"nette/nette": "<2.2"
+			},
+			"require-dev": {
+				"nette/tester": "^2.0",
+				"phpstan/phpstan": "^0.12",
+				"tracy/tracy": "^2.3"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "2.6-dev"
+				}
+			},
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause",
+				"GPL-2.0-only",
+				"GPL-3.0-only"
+			],
+			"authors": [
+				{
+					"name": "David Grudl",
+					"homepage": "https://davidgrudl.com"
+				},
+				{
+					"name": "Nette Community",
+					"homepage": "https://nette.org/contributors"
+				}
+			],
+			"description": " Nette Finder: find files and directories with an intuitive API.",
+			"homepage": "https://nette.org",
+			"keywords": [
+				"filesystem",
+				"glob",
+				"iterator",
+				"nette"
+			],
+			"support": {
+				"issues": "https://github.com/nette/finder/issues",
+				"source": "https://github.com/nette/finder/tree/v2.6.0"
+			},
+			"time": "2022-10-13T01:31:15+00:00"
+		},
+		{
+			"name": "nette/neon",
+			"version": "v3.3.3",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/nette/neon.git",
+				"reference": "22e384da162fab42961d48eb06c06d3ad0c11b95"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/nette/neon/zipball/22e384da162fab42961d48eb06c06d3ad0c11b95",
+				"reference": "22e384da162fab42961d48eb06c06d3ad0c11b95",
+				"shasum": ""
+			},
+			"require": {
+				"ext-json": "*",
+				"php": ">=7.1"
+			},
+			"require-dev": {
+				"nette/tester": "^2.0",
+				"phpstan/phpstan": "^0.12",
+				"tracy/tracy": "^2.7"
+			},
+			"bin": [
+				"bin/neon-lint"
+			],
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "3.3-dev"
+				}
+			},
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause",
+				"GPL-2.0-only",
+				"GPL-3.0-only"
+			],
+			"authors": [
+				{
+					"name": "David Grudl",
+					"homepage": "https://davidgrudl.com"
+				},
+				{
+					"name": "Nette Community",
+					"homepage": "https://nette.org/contributors"
+				}
+			],
+			"description": " Nette NEON: encodes and decodes NEON file format.",
+			"homepage": "https://ne-on.org",
+			"keywords": [
+				"export",
+				"import",
+				"neon",
+				"nette",
+				"yaml"
+			],
+			"support": {
+				"issues": "https://github.com/nette/neon/issues",
+				"source": "https://github.com/nette/neon/tree/v3.3.3"
+			},
+			"time": "2022-03-10T02:04:26+00:00"
+		},
+		{
+			"name": "nette/php-generator",
+			"version": "v3.6.9",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/nette/php-generator.git",
+				"reference": "d31782f7bd2ae84ad06f863391ec3fb77ca4d0a6"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/nette/php-generator/zipball/d31782f7bd2ae84ad06f863391ec3fb77ca4d0a6",
+				"reference": "d31782f7bd2ae84ad06f863391ec3fb77ca4d0a6",
+				"shasum": ""
+			},
+			"require": {
+				"nette/utils": "^3.1.2",
+				"php": ">=7.2 <8.3"
+			},
+			"require-dev": {
+				"nette/tester": "^2.4",
+				"nikic/php-parser": "^4.13",
+				"phpstan/phpstan": "^0.12",
+				"tracy/tracy": "^2.8"
+			},
+			"suggest": {
+				"nikic/php-parser": "to use ClassType::withBodiesFrom() & GlobalFunction::withBodyFrom()"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "3.6-dev"
+				}
+			},
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause",
+				"GPL-2.0-only",
+				"GPL-3.0-only"
+			],
+			"authors": [
+				{
+					"name": "David Grudl",
+					"homepage": "https://davidgrudl.com"
+				},
+				{
+					"name": "Nette Community",
+					"homepage": "https://nette.org/contributors"
+				}
+			],
+			"description": " Nette PHP Generator: generates neat PHP code for you. Supports new PHP 8.1 features.",
+			"homepage": "https://nette.org",
+			"keywords": [
+				"code",
+				"nette",
+				"php",
+				"scaffolding"
+			],
+			"support": {
+				"issues": "https://github.com/nette/php-generator/issues",
+				"source": "https://github.com/nette/php-generator/tree/v3.6.9"
+			},
+			"time": "2022-10-04T11:49:47+00:00"
+		},
+		{
+			"name": "nette/robot-loader",
+			"version": "v3.4.2",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/nette/robot-loader.git",
+				"reference": "970c8f82be98ec54180c88a468cd2b057855d993"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/nette/robot-loader/zipball/970c8f82be98ec54180c88a468cd2b057855d993",
+				"reference": "970c8f82be98ec54180c88a468cd2b057855d993",
+				"shasum": ""
+			},
+			"require": {
+				"ext-tokenizer": "*",
+				"nette/finder": "^2.5 || ^3.0",
+				"nette/utils": "^3.0",
+				"php": ">=7.1"
+			},
+			"require-dev": {
+				"nette/tester": "^2.0",
+				"phpstan/phpstan": "^0.12",
+				"tracy/tracy": "^2.3"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "3.4-dev"
+				}
+			},
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause",
+				"GPL-2.0-only",
+				"GPL-3.0-only"
+			],
+			"authors": [
+				{
+					"name": "David Grudl",
+					"homepage": "https://davidgrudl.com"
+				},
+				{
+					"name": "Nette Community",
+					"homepage": "https://nette.org/contributors"
+				}
+			],
+			"description": " Nette RobotLoader: high performance and comfortable autoloader that will search and autoload classes within your application.",
+			"homepage": "https://nette.org",
+			"keywords": [
+				"autoload",
+				"class",
+				"interface",
+				"nette",
+				"trait"
+			],
+			"support": {
+				"issues": "https://github.com/nette/robot-loader/issues",
+				"source": "https://github.com/nette/robot-loader/tree/v3.4.2"
+			},
+			"time": "2022-12-14T15:41:06+00:00"
+		},
+		{
+			"name": "nette/schema",
+			"version": "v1.2.3",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/nette/schema.git",
+				"reference": "abbdbb70e0245d5f3bf77874cea1dfb0c930d06f"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/nette/schema/zipball/abbdbb70e0245d5f3bf77874cea1dfb0c930d06f",
+				"reference": "abbdbb70e0245d5f3bf77874cea1dfb0c930d06f",
+				"shasum": ""
+			},
+			"require": {
+				"nette/utils": "^2.5.7 || ^3.1.5 ||  ^4.0",
+				"php": ">=7.1 <8.3"
+			},
+			"require-dev": {
+				"nette/tester": "^2.3 || ^2.4",
+				"phpstan/phpstan-nette": "^1.0",
+				"tracy/tracy": "^2.7"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "1.2-dev"
+				}
+			},
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause",
+				"GPL-2.0-only",
+				"GPL-3.0-only"
+			],
+			"authors": [
+				{
+					"name": "David Grudl",
+					"homepage": "https://davidgrudl.com"
+				},
+				{
+					"name": "Nette Community",
+					"homepage": "https://nette.org/contributors"
+				}
+			],
+			"description": " Nette Schema: validating data structures against a given Schema.",
+			"homepage": "https://nette.org",
+			"keywords": [
+				"config",
+				"nette"
+			],
+			"support": {
+				"issues": "https://github.com/nette/schema/issues",
+				"source": "https://github.com/nette/schema/tree/v1.2.3"
+			},
+			"time": "2022-10-13T01:24:26+00:00"
+		},
+		{
+			"name": "nette/utils",
+			"version": "v3.2.9",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/nette/utils.git",
+				"reference": "c91bac3470c34b2ecd5400f6e6fdf0b64a836a5c"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/nette/utils/zipball/c91bac3470c34b2ecd5400f6e6fdf0b64a836a5c",
+				"reference": "c91bac3470c34b2ecd5400f6e6fdf0b64a836a5c",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.2 <8.3"
+			},
+			"conflict": {
+				"nette/di": "<3.0.6"
+			},
+			"require-dev": {
+				"jetbrains/phpstorm-attributes": "dev-master",
+				"nette/tester": "~2.0",
+				"phpstan/phpstan": "^1.0",
+				"tracy/tracy": "^2.3"
+			},
+			"suggest": {
+				"ext-gd": "to use Image",
+				"ext-iconv": "to use Strings::webalize(), toAscii(), chr() and reverse()",
+				"ext-intl": "to use Strings::webalize(), toAscii(), normalize() and compare()",
+				"ext-json": "to use Nette\\Utils\\Json",
+				"ext-mbstring": "to use Strings::lower() etc...",
+				"ext-tokenizer": "to use Nette\\Utils\\Reflection::getUseStatements()",
+				"ext-xml": "to use Strings::length() etc. when mbstring is not available"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "3.2-dev"
+				}
+			},
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause",
+				"GPL-2.0-only",
+				"GPL-3.0-only"
+			],
+			"authors": [
+				{
+					"name": "David Grudl",
+					"homepage": "https://davidgrudl.com"
+				},
+				{
+					"name": "Nette Community",
+					"homepage": "https://nette.org/contributors"
+				}
+			],
+			"description": "  Nette Utils: lightweight utilities for string & array manipulation, image handling, safe JSON encoding/decoding, validation, slug or strong password generating etc.",
+			"homepage": "https://nette.org",
+			"keywords": [
+				"array",
+				"core",
+				"datetime",
+				"images",
+				"json",
+				"nette",
+				"paginator",
+				"password",
+				"slugify",
+				"string",
+				"unicode",
+				"utf-8",
+				"utility",
+				"validation"
+			],
+			"support": {
+				"issues": "https://github.com/nette/utils/issues",
+				"source": "https://github.com/nette/utils/tree/v3.2.9"
+			},
+			"time": "2023-01-18T03:26:20+00:00"
+		},
+		{
+			"name": "nikic/php-parser",
+			"version": "v4.15.3",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/nikic/PHP-Parser.git",
+				"reference": "570e980a201d8ed0236b0a62ddf2c9cbb2034039"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/nikic/PHP-Parser/zipball/570e980a201d8ed0236b0a62ddf2c9cbb2034039",
+				"reference": "570e980a201d8ed0236b0a62ddf2c9cbb2034039",
+				"shasum": ""
+			},
+			"require": {
+				"ext-tokenizer": "*",
+				"php": ">=7.0"
+			},
+			"require-dev": {
+				"ircmaxell/php-yacc": "^0.0.7",
+				"phpunit/phpunit": "^6.5 || ^7.0 || ^8.0 || ^9.0"
+			},
+			"bin": [
+				"bin/php-parse"
+			],
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "4.9-dev"
+				}
+			},
+			"autoload": {
+				"psr-4": {
+					"PhpParser\\": "lib/PhpParser"
+				}
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause"
+			],
+			"authors": [
+				{
+					"name": "Nikita Popov"
+				}
+			],
+			"description": "A PHP parser written in PHP",
+			"keywords": [
+				"parser",
+				"php"
+			],
+			"support": {
+				"issues": "https://github.com/nikic/PHP-Parser/issues",
+				"source": "https://github.com/nikic/PHP-Parser/tree/v4.15.3"
+			},
+			"time": "2023-01-16T22:05:37+00:00"
+		},
+		{
+			"name": "phar-io/manifest",
+			"version": "2.0.3",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/phar-io/manifest.git",
+				"reference": "97803eca37d319dfa7826cc2437fc020857acb53"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/phar-io/manifest/zipball/97803eca37d319dfa7826cc2437fc020857acb53",
+				"reference": "97803eca37d319dfa7826cc2437fc020857acb53",
+				"shasum": ""
+			},
+			"require": {
+				"ext-dom": "*",
+				"ext-phar": "*",
+				"ext-xmlwriter": "*",
+				"phar-io/version": "^3.0.1",
+				"php": "^7.2 || ^8.0"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "2.0.x-dev"
+				}
+			},
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause"
+			],
+			"authors": [
+				{
+					"name": "Arne Blankerts",
+					"email": "arne@blankerts.de",
+					"role": "Developer"
+				},
+				{
+					"name": "Sebastian Heuer",
+					"email": "sebastian@phpeople.de",
+					"role": "Developer"
+				},
+				{
+					"name": "Sebastian Bergmann",
+					"email": "sebastian@phpunit.de",
+					"role": "Developer"
+				}
+			],
+			"description": "Component for reading phar.io manifest information from a PHP Archive (PHAR)",
+			"support": {
+				"issues": "https://github.com/phar-io/manifest/issues",
+				"source": "https://github.com/phar-io/manifest/tree/2.0.3"
+			},
+			"time": "2021-07-20T11:28:43+00:00"
+		},
+		{
+			"name": "phar-io/version",
+			"version": "3.2.1",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/phar-io/version.git",
+				"reference": "4f7fd7836c6f332bb2933569e566a0d6c4cbed74"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/phar-io/version/zipball/4f7fd7836c6f332bb2933569e566a0d6c4cbed74",
+				"reference": "4f7fd7836c6f332bb2933569e566a0d6c4cbed74",
+				"shasum": ""
+			},
+			"require": {
+				"php": "^7.2 || ^8.0"
+			},
+			"type": "library",
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause"
+			],
+			"authors": [
+				{
+					"name": "Arne Blankerts",
+					"email": "arne@blankerts.de",
+					"role": "Developer"
+				},
+				{
+					"name": "Sebastian Heuer",
+					"email": "sebastian@phpeople.de",
+					"role": "Developer"
+				},
+				{
+					"name": "Sebastian Bergmann",
+					"email": "sebastian@phpunit.de",
+					"role": "Developer"
+				}
+			],
+			"description": "Library for handling version information and constraints",
+			"support": {
+				"issues": "https://github.com/phar-io/version/issues",
+				"source": "https://github.com/phar-io/version/tree/3.2.1"
+			},
+			"time": "2022-02-21T01:04:05+00:00"
+		},
+		{
+			"name": "phpstan/phpdoc-parser",
+			"version": "0.3.5",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/phpstan/phpdoc-parser.git",
+				"reference": "8c4ef2aefd9788238897b678a985e1d5c8df6db4"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/phpstan/phpdoc-parser/zipball/8c4ef2aefd9788238897b678a985e1d5c8df6db4",
+				"reference": "8c4ef2aefd9788238897b678a985e1d5c8df6db4",
+				"shasum": ""
+			},
+			"require": {
+				"php": "~7.1"
+			},
+			"require-dev": {
+				"consistence/coding-standard": "^3.5",
+				"jakub-onderka/php-parallel-lint": "^0.9.2",
+				"phing/phing": "^2.16.0",
+				"phpstan/phpstan": "^0.10",
+				"phpunit/phpunit": "^6.3",
+				"slevomat/coding-standard": "^4.7.2",
+				"squizlabs/php_codesniffer": "^3.3.2",
+				"symfony/process": "^3.4 || ^4.0"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "0.3-dev"
+				}
+			},
+			"autoload": {
+				"psr-4": {
+					"PHPStan\\PhpDocParser\\": [
+						"src/"
+					]
+				}
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"description": "PHPDoc parser with support for nullable, intersection and generic types",
+			"support": {
+				"issues": "https://github.com/phpstan/phpdoc-parser/issues",
+				"source": "https://github.com/phpstan/phpdoc-parser/tree/master"
+			},
+			"time": "2019-06-07T19:13:52+00:00"
+		},
+		{
+			"name": "phpstan/phpstan",
+			"version": "0.11.20",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/phpstan/phpstan.git",
+				"reference": "938dcc03a005280e1a9587ec7684345bff06ebfc"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/phpstan/phpstan/zipball/938dcc03a005280e1a9587ec7684345bff06ebfc",
+				"reference": "938dcc03a005280e1a9587ec7684345bff06ebfc",
+				"shasum": ""
+			},
+			"require": {
+				"composer/xdebug-handler": "^1.3.0",
+				"jean85/pretty-package-versions": "^1.0.3",
+				"nette/bootstrap": "^2.4 || ^3.0",
+				"nette/di": "^2.4.7 || ^3.0",
+				"nette/neon": "^2.4.3 || ^3.0",
+				"nette/robot-loader": "^3.0.1",
+				"nette/schema": "^1.0",
+				"nette/utils": "^2.4.5 || ^3.0",
+				"nikic/php-parser": "^4.2.3",
+				"php": "~7.1",
+				"phpstan/phpdoc-parser": "^0.3.5",
+				"symfony/console": "~3.2 || ~4.0",
+				"symfony/finder": "~3.2 || ~4.0"
+			},
+			"conflict": {
+				"symfony/console": "3.4.16 || 4.1.5"
+			},
+			"require-dev": {
+				"brianium/paratest": "^2.0 || ^3.0",
+				"consistence/coding-standard": "^3.5",
+				"dealerdirect/phpcodesniffer-composer-installer": "^0.4.4",
+				"ext-intl": "*",
+				"ext-mysqli": "*",
+				"ext-simplexml": "*",
+				"ext-soap": "*",
+				"ext-zip": "*",
+				"jakub-onderka/php-parallel-lint": "^1.0",
+				"localheinz/composer-normalize": "^1.1.0",
+				"phing/phing": "^2.16.0",
+				"phpstan/phpstan-deprecation-rules": "^0.11",
+				"phpstan/phpstan-php-parser": "^0.11",
+				"phpstan/phpstan-phpunit": "^0.11",
+				"phpstan/phpstan-strict-rules": "^0.11",
+				"phpunit/phpunit": "^7.5.14 || ^8.0",
+				"slevomat/coding-standard": "^4.7.2",
+				"squizlabs/php_codesniffer": "^3.3.2"
+			},
+			"bin": [
+				"bin/phpstan"
+			],
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "0.11-dev"
+				}
+			},
+			"autoload": {
+				"psr-4": {
+					"PHPStan\\": [
+						"src/"
+					]
+				}
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"description": "PHPStan - PHP Static Analysis Tool",
+			"support": {
+				"issues": "https://github.com/phpstan/phpstan/issues",
+				"source": "https://github.com/phpstan/phpstan/tree/0.11.20"
+			},
+			"funding": [
+				{
+					"url": "https://github.com/ondrejmirtes",
+					"type": "github"
+				},
+				{
+					"url": "https://www.patreon.com/phpstan",
+					"type": "patreon"
+				},
+				{
+					"url": "https://tidelift.com/funding/github/packagist/phpstan/phpstan",
+					"type": "tidelift"
+				}
+			],
+			"time": "2020-10-12T14:33:05+00:00"
+		},
+		{
+			"name": "phpunit/php-code-coverage",
+			"version": "7.0.15",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/sebastianbergmann/php-code-coverage.git",
+				"reference": "819f92bba8b001d4363065928088de22f25a3a48"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/sebastianbergmann/php-code-coverage/zipball/819f92bba8b001d4363065928088de22f25a3a48",
+				"reference": "819f92bba8b001d4363065928088de22f25a3a48",
+				"shasum": ""
+			},
+			"require": {
+				"ext-dom": "*",
+				"ext-xmlwriter": "*",
+				"php": ">=7.2",
+				"phpunit/php-file-iterator": "^2.0.2",
+				"phpunit/php-text-template": "^1.2.1",
+				"phpunit/php-token-stream": "^3.1.3 || ^4.0",
+				"sebastian/code-unit-reverse-lookup": "^1.0.1",
+				"sebastian/environment": "^4.2.2",
+				"sebastian/version": "^2.0.1",
+				"theseer/tokenizer": "^1.1.3"
+			},
+			"require-dev": {
+				"phpunit/phpunit": "^8.2.2"
+			},
+			"suggest": {
+				"ext-xdebug": "^2.7.2"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "7.0-dev"
+				}
+			},
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause"
+			],
+			"authors": [
+				{
+					"name": "Sebastian Bergmann",
+					"email": "sebastian@phpunit.de",
+					"role": "lead"
+				}
+			],
+			"description": "Library that provides collection, processing, and rendering functionality for PHP code coverage information.",
+			"homepage": "https://github.com/sebastianbergmann/php-code-coverage",
+			"keywords": [
+				"coverage",
+				"testing",
+				"xunit"
+			],
+			"support": {
+				"issues": "https://github.com/sebastianbergmann/php-code-coverage/issues",
+				"source": "https://github.com/sebastianbergmann/php-code-coverage/tree/7.0.15"
+			},
+			"funding": [
+				{
+					"url": "https://github.com/sebastianbergmann",
+					"type": "github"
+				}
+			],
+			"time": "2021-07-26T12:20:09+00:00"
+		},
+		{
+			"name": "phpunit/php-file-iterator",
+			"version": "2.0.5",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/sebastianbergmann/php-file-iterator.git",
+				"reference": "42c5ba5220e6904cbfe8b1a1bda7c0cfdc8c12f5"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/sebastianbergmann/php-file-iterator/zipball/42c5ba5220e6904cbfe8b1a1bda7c0cfdc8c12f5",
+				"reference": "42c5ba5220e6904cbfe8b1a1bda7c0cfdc8c12f5",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.1"
+			},
+			"require-dev": {
+				"phpunit/phpunit": "^8.5"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "2.0.x-dev"
+				}
+			},
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause"
+			],
+			"authors": [
+				{
+					"name": "Sebastian Bergmann",
+					"email": "sebastian@phpunit.de",
+					"role": "lead"
+				}
+			],
+			"description": "FilterIterator implementation that filters files based on a list of suffixes.",
+			"homepage": "https://github.com/sebastianbergmann/php-file-iterator/",
+			"keywords": [
+				"filesystem",
+				"iterator"
+			],
+			"support": {
+				"issues": "https://github.com/sebastianbergmann/php-file-iterator/issues",
+				"source": "https://github.com/sebastianbergmann/php-file-iterator/tree/2.0.5"
+			},
+			"funding": [
+				{
+					"url": "https://github.com/sebastianbergmann",
+					"type": "github"
+				}
+			],
+			"time": "2021-12-02T12:42:26+00:00"
+		},
+		{
+			"name": "phpunit/php-text-template",
+			"version": "1.2.1",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/sebastianbergmann/php-text-template.git",
+				"reference": "31f8b717e51d9a2afca6c9f046f5d69fc27c8686"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/sebastianbergmann/php-text-template/zipball/31f8b717e51d9a2afca6c9f046f5d69fc27c8686",
+				"reference": "31f8b717e51d9a2afca6c9f046f5d69fc27c8686",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=5.3.3"
+			},
+			"type": "library",
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause"
+			],
+			"authors": [
+				{
+					"name": "Sebastian Bergmann",
+					"email": "sebastian@phpunit.de",
+					"role": "lead"
+				}
+			],
+			"description": "Simple template engine.",
+			"homepage": "https://github.com/sebastianbergmann/php-text-template/",
+			"keywords": [
+				"template"
+			],
+			"support": {
+				"issues": "https://github.com/sebastianbergmann/php-text-template/issues",
+				"source": "https://github.com/sebastianbergmann/php-text-template/tree/1.2.1"
+			},
+			"time": "2015-06-21T13:50:34+00:00"
+		},
+		{
+			"name": "phpunit/php-timer",
+			"version": "2.1.3",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/sebastianbergmann/php-timer.git",
+				"reference": "2454ae1765516d20c4ffe103d85a58a9a3bd5662"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/sebastianbergmann/php-timer/zipball/2454ae1765516d20c4ffe103d85a58a9a3bd5662",
+				"reference": "2454ae1765516d20c4ffe103d85a58a9a3bd5662",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.1"
+			},
+			"require-dev": {
+				"phpunit/phpunit": "^8.5"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "2.1-dev"
+				}
+			},
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause"
+			],
+			"authors": [
+				{
+					"name": "Sebastian Bergmann",
+					"email": "sebastian@phpunit.de",
+					"role": "lead"
+				}
+			],
+			"description": "Utility class for timing",
+			"homepage": "https://github.com/sebastianbergmann/php-timer/",
+			"keywords": [
+				"timer"
+			],
+			"support": {
+				"issues": "https://github.com/sebastianbergmann/php-timer/issues",
+				"source": "https://github.com/sebastianbergmann/php-timer/tree/2.1.3"
+			},
+			"funding": [
+				{
+					"url": "https://github.com/sebastianbergmann",
+					"type": "github"
+				}
+			],
+			"time": "2020-11-30T08:20:02+00:00"
+		},
+		{
+			"name": "phpunit/php-token-stream",
+			"version": "3.1.3",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/sebastianbergmann/php-token-stream.git",
+				"reference": "9c1da83261628cb24b6a6df371b6e312b3954768"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/sebastianbergmann/php-token-stream/zipball/9c1da83261628cb24b6a6df371b6e312b3954768",
+				"reference": "9c1da83261628cb24b6a6df371b6e312b3954768",
+				"shasum": ""
+			},
+			"require": {
+				"ext-tokenizer": "*",
+				"php": ">=7.1"
+			},
+			"require-dev": {
+				"phpunit/phpunit": "^7.0"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "3.1-dev"
+				}
+			},
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause"
+			],
+			"authors": [
+				{
+					"name": "Sebastian Bergmann",
+					"email": "sebastian@phpunit.de"
+				}
+			],
+			"description": "Wrapper around PHP's tokenizer extension.",
+			"homepage": "https://github.com/sebastianbergmann/php-token-stream/",
+			"keywords": [
+				"tokenizer"
+			],
+			"support": {
+				"issues": "https://github.com/sebastianbergmann/php-token-stream/issues",
+				"source": "https://github.com/sebastianbergmann/php-token-stream/tree/3.1.3"
+			},
+			"funding": [
+				{
+					"url": "https://github.com/sebastianbergmann",
+					"type": "github"
+				}
+			],
+			"abandoned": true,
+			"time": "2021-07-26T12:15:06+00:00"
+		},
+		{
+			"name": "phpunit/phpunit",
+			"version": "8.5.32",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/sebastianbergmann/phpunit.git",
+				"reference": "375686930d05c9fd7d20f6e5fc38121e8d7a9d55"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/sebastianbergmann/phpunit/zipball/375686930d05c9fd7d20f6e5fc38121e8d7a9d55",
+				"reference": "375686930d05c9fd7d20f6e5fc38121e8d7a9d55",
+				"shasum": ""
+			},
+			"require": {
+				"doctrine/instantiator": "^1.3.1",
+				"ext-dom": "*",
+				"ext-json": "*",
+				"ext-libxml": "*",
+				"ext-mbstring": "*",
+				"ext-xml": "*",
+				"ext-xmlwriter": "*",
+				"myclabs/deep-copy": "^1.10.0",
+				"phar-io/manifest": "^2.0.3",
+				"phar-io/version": "^3.0.2",
+				"php": ">=7.2",
+				"phpunit/php-code-coverage": "^7.0.12",
+				"phpunit/php-file-iterator": "^2.0.4",
+				"phpunit/php-text-template": "^1.2.1",
+				"phpunit/php-timer": "^2.1.2",
+				"sebastian/comparator": "^3.0.5",
+				"sebastian/diff": "^3.0.2",
+				"sebastian/environment": "^4.2.3",
+				"sebastian/exporter": "^3.1.5",
+				"sebastian/global-state": "^3.0.0",
+				"sebastian/object-enumerator": "^3.0.3",
+				"sebastian/resource-operations": "^2.0.1",
+				"sebastian/type": "^1.1.3",
+				"sebastian/version": "^2.0.1"
+			},
+			"suggest": {
+				"ext-soap": "*",
+				"ext-xdebug": "*",
+				"phpunit/php-invoker": "^2.0.0"
+			},
+			"bin": [
+				"phpunit"
+			],
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "8.5-dev"
+				}
+			},
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause"
+			],
+			"authors": [
+				{
+					"name": "Sebastian Bergmann",
+					"email": "sebastian@phpunit.de",
+					"role": "lead"
+				}
+			],
+			"description": "The PHP Unit Testing framework.",
+			"homepage": "https://phpunit.de/",
+			"keywords": [
+				"phpunit",
+				"testing",
+				"xunit"
+			],
+			"support": {
+				"issues": "https://github.com/sebastianbergmann/phpunit/issues",
+				"source": "https://github.com/sebastianbergmann/phpunit/tree/8.5.32"
+			},
+			"funding": [
+				{
+					"url": "https://phpunit.de/sponsors.html",
+					"type": "custom"
+				},
+				{
+					"url": "https://github.com/sebastianbergmann",
+					"type": "github"
+				},
+				{
+					"url": "https://tidelift.com/funding/github/packagist/phpunit/phpunit",
+					"type": "tidelift"
+				}
+			],
+			"time": "2023-01-26T08:30:25+00:00"
+		},
+		{
+			"name": "sebastian/code-unit-reverse-lookup",
+			"version": "1.0.2",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/sebastianbergmann/code-unit-reverse-lookup.git",
+				"reference": "1de8cd5c010cb153fcd68b8d0f64606f523f7619"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/sebastianbergmann/code-unit-reverse-lookup/zipball/1de8cd5c010cb153fcd68b8d0f64606f523f7619",
+				"reference": "1de8cd5c010cb153fcd68b8d0f64606f523f7619",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=5.6"
+			},
+			"require-dev": {
+				"phpunit/phpunit": "^8.5"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "1.0.x-dev"
+				}
+			},
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause"
+			],
+			"authors": [
+				{
+					"name": "Sebastian Bergmann",
+					"email": "sebastian@phpunit.de"
+				}
+			],
+			"description": "Looks up which function or method a line of code belongs to",
+			"homepage": "https://github.com/sebastianbergmann/code-unit-reverse-lookup/",
+			"support": {
+				"issues": "https://github.com/sebastianbergmann/code-unit-reverse-lookup/issues",
+				"source": "https://github.com/sebastianbergmann/code-unit-reverse-lookup/tree/1.0.2"
+			},
+			"funding": [
+				{
+					"url": "https://github.com/sebastianbergmann",
+					"type": "github"
+				}
+			],
+			"time": "2020-11-30T08:15:22+00:00"
+		},
+		{
+			"name": "sebastian/comparator",
+			"version": "3.0.5",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/sebastianbergmann/comparator.git",
+				"reference": "1dc7ceb4a24aede938c7af2a9ed1de09609ca770"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/sebastianbergmann/comparator/zipball/1dc7ceb4a24aede938c7af2a9ed1de09609ca770",
+				"reference": "1dc7ceb4a24aede938c7af2a9ed1de09609ca770",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.1",
+				"sebastian/diff": "^3.0",
+				"sebastian/exporter": "^3.1"
+			},
+			"require-dev": {
+				"phpunit/phpunit": "^8.5"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "3.0-dev"
+				}
+			},
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause"
+			],
+			"authors": [
+				{
+					"name": "Sebastian Bergmann",
+					"email": "sebastian@phpunit.de"
+				},
+				{
+					"name": "Jeff Welch",
+					"email": "whatthejeff@gmail.com"
+				},
+				{
+					"name": "Volker Dusch",
+					"email": "github@wallbash.com"
+				},
+				{
+					"name": "Bernhard Schussek",
+					"email": "bschussek@2bepublished.at"
+				}
+			],
+			"description": "Provides the functionality to compare PHP values for equality",
+			"homepage": "https://github.com/sebastianbergmann/comparator",
+			"keywords": [
+				"comparator",
+				"compare",
+				"equality"
+			],
+			"support": {
+				"issues": "https://github.com/sebastianbergmann/comparator/issues",
+				"source": "https://github.com/sebastianbergmann/comparator/tree/3.0.5"
+			},
+			"funding": [
+				{
+					"url": "https://github.com/sebastianbergmann",
+					"type": "github"
+				}
+			],
+			"time": "2022-09-14T12:31:48+00:00"
+		},
+		{
+			"name": "sebastian/diff",
+			"version": "3.0.3",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/sebastianbergmann/diff.git",
+				"reference": "14f72dd46eaf2f2293cbe79c93cc0bc43161a211"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/sebastianbergmann/diff/zipball/14f72dd46eaf2f2293cbe79c93cc0bc43161a211",
+				"reference": "14f72dd46eaf2f2293cbe79c93cc0bc43161a211",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.1"
+			},
+			"require-dev": {
+				"phpunit/phpunit": "^7.5 || ^8.0",
+				"symfony/process": "^2 || ^3.3 || ^4"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "3.0-dev"
+				}
+			},
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause"
+			],
+			"authors": [
+				{
+					"name": "Sebastian Bergmann",
+					"email": "sebastian@phpunit.de"
+				},
+				{
+					"name": "Kore Nordmann",
+					"email": "mail@kore-nordmann.de"
+				}
+			],
+			"description": "Diff implementation",
+			"homepage": "https://github.com/sebastianbergmann/diff",
+			"keywords": [
+				"diff",
+				"udiff",
+				"unidiff",
+				"unified diff"
+			],
+			"support": {
+				"issues": "https://github.com/sebastianbergmann/diff/issues",
+				"source": "https://github.com/sebastianbergmann/diff/tree/3.0.3"
+			},
+			"funding": [
+				{
+					"url": "https://github.com/sebastianbergmann",
+					"type": "github"
+				}
+			],
+			"time": "2020-11-30T07:59:04+00:00"
+		},
+		{
+			"name": "sebastian/environment",
+			"version": "4.2.4",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/sebastianbergmann/environment.git",
+				"reference": "d47bbbad83711771f167c72d4e3f25f7fcc1f8b0"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/sebastianbergmann/environment/zipball/d47bbbad83711771f167c72d4e3f25f7fcc1f8b0",
+				"reference": "d47bbbad83711771f167c72d4e3f25f7fcc1f8b0",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.1"
+			},
+			"require-dev": {
+				"phpunit/phpunit": "^7.5"
+			},
+			"suggest": {
+				"ext-posix": "*"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "4.2-dev"
+				}
+			},
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause"
+			],
+			"authors": [
+				{
+					"name": "Sebastian Bergmann",
+					"email": "sebastian@phpunit.de"
+				}
+			],
+			"description": "Provides functionality to handle HHVM/PHP environments",
+			"homepage": "http://www.github.com/sebastianbergmann/environment",
+			"keywords": [
+				"Xdebug",
+				"environment",
+				"hhvm"
+			],
+			"support": {
+				"issues": "https://github.com/sebastianbergmann/environment/issues",
+				"source": "https://github.com/sebastianbergmann/environment/tree/4.2.4"
+			},
+			"funding": [
+				{
+					"url": "https://github.com/sebastianbergmann",
+					"type": "github"
+				}
+			],
+			"time": "2020-11-30T07:53:42+00:00"
+		},
+		{
+			"name": "sebastian/exporter",
+			"version": "3.1.5",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/sebastianbergmann/exporter.git",
+				"reference": "73a9676f2833b9a7c36968f9d882589cd75511e6"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/sebastianbergmann/exporter/zipball/73a9676f2833b9a7c36968f9d882589cd75511e6",
+				"reference": "73a9676f2833b9a7c36968f9d882589cd75511e6",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.0",
+				"sebastian/recursion-context": "^3.0"
+			},
+			"require-dev": {
+				"ext-mbstring": "*",
+				"phpunit/phpunit": "^8.5"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "3.1.x-dev"
+				}
+			},
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause"
+			],
+			"authors": [
+				{
+					"name": "Sebastian Bergmann",
+					"email": "sebastian@phpunit.de"
+				},
+				{
+					"name": "Jeff Welch",
+					"email": "whatthejeff@gmail.com"
+				},
+				{
+					"name": "Volker Dusch",
+					"email": "github@wallbash.com"
+				},
+				{
+					"name": "Adam Harvey",
+					"email": "aharvey@php.net"
+				},
+				{
+					"name": "Bernhard Schussek",
+					"email": "bschussek@gmail.com"
+				}
+			],
+			"description": "Provides the functionality to export PHP variables for visualization",
+			"homepage": "http://www.github.com/sebastianbergmann/exporter",
+			"keywords": [
+				"export",
+				"exporter"
+			],
+			"support": {
+				"issues": "https://github.com/sebastianbergmann/exporter/issues",
+				"source": "https://github.com/sebastianbergmann/exporter/tree/3.1.5"
+			},
+			"funding": [
+				{
+					"url": "https://github.com/sebastianbergmann",
+					"type": "github"
+				}
+			],
+			"time": "2022-09-14T06:00:17+00:00"
+		},
+		{
+			"name": "sebastian/global-state",
+			"version": "3.0.2",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/sebastianbergmann/global-state.git",
+				"reference": "de036ec91d55d2a9e0db2ba975b512cdb1c23921"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/sebastianbergmann/global-state/zipball/de036ec91d55d2a9e0db2ba975b512cdb1c23921",
+				"reference": "de036ec91d55d2a9e0db2ba975b512cdb1c23921",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.2",
+				"sebastian/object-reflector": "^1.1.1",
+				"sebastian/recursion-context": "^3.0"
+			},
+			"require-dev": {
+				"ext-dom": "*",
+				"phpunit/phpunit": "^8.0"
+			},
+			"suggest": {
+				"ext-uopz": "*"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "3.0-dev"
+				}
+			},
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause"
+			],
+			"authors": [
+				{
+					"name": "Sebastian Bergmann",
+					"email": "sebastian@phpunit.de"
+				}
+			],
+			"description": "Snapshotting of global state",
+			"homepage": "http://www.github.com/sebastianbergmann/global-state",
+			"keywords": [
+				"global state"
+			],
+			"support": {
+				"issues": "https://github.com/sebastianbergmann/global-state/issues",
+				"source": "https://github.com/sebastianbergmann/global-state/tree/3.0.2"
+			},
+			"funding": [
+				{
+					"url": "https://github.com/sebastianbergmann",
+					"type": "github"
+				}
+			],
+			"time": "2022-02-10T06:55:38+00:00"
+		},
+		{
+			"name": "sebastian/object-enumerator",
+			"version": "3.0.4",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/sebastianbergmann/object-enumerator.git",
+				"reference": "e67f6d32ebd0c749cf9d1dbd9f226c727043cdf2"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/sebastianbergmann/object-enumerator/zipball/e67f6d32ebd0c749cf9d1dbd9f226c727043cdf2",
+				"reference": "e67f6d32ebd0c749cf9d1dbd9f226c727043cdf2",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.0",
+				"sebastian/object-reflector": "^1.1.1",
+				"sebastian/recursion-context": "^3.0"
+			},
+			"require-dev": {
+				"phpunit/phpunit": "^6.0"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "3.0.x-dev"
+				}
+			},
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause"
+			],
+			"authors": [
+				{
+					"name": "Sebastian Bergmann",
+					"email": "sebastian@phpunit.de"
+				}
+			],
+			"description": "Traverses array structures and object graphs to enumerate all referenced objects",
+			"homepage": "https://github.com/sebastianbergmann/object-enumerator/",
+			"support": {
+				"issues": "https://github.com/sebastianbergmann/object-enumerator/issues",
+				"source": "https://github.com/sebastianbergmann/object-enumerator/tree/3.0.4"
+			},
+			"funding": [
+				{
+					"url": "https://github.com/sebastianbergmann",
+					"type": "github"
+				}
+			],
+			"time": "2020-11-30T07:40:27+00:00"
+		},
+		{
+			"name": "sebastian/object-reflector",
+			"version": "1.1.2",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/sebastianbergmann/object-reflector.git",
+				"reference": "9b8772b9cbd456ab45d4a598d2dd1a1bced6363d"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/sebastianbergmann/object-reflector/zipball/9b8772b9cbd456ab45d4a598d2dd1a1bced6363d",
+				"reference": "9b8772b9cbd456ab45d4a598d2dd1a1bced6363d",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.0"
+			},
+			"require-dev": {
+				"phpunit/phpunit": "^6.0"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "1.1-dev"
+				}
+			},
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause"
+			],
+			"authors": [
+				{
+					"name": "Sebastian Bergmann",
+					"email": "sebastian@phpunit.de"
+				}
+			],
+			"description": "Allows reflection of object attributes, including inherited and non-public ones",
+			"homepage": "https://github.com/sebastianbergmann/object-reflector/",
+			"support": {
+				"issues": "https://github.com/sebastianbergmann/object-reflector/issues",
+				"source": "https://github.com/sebastianbergmann/object-reflector/tree/1.1.2"
+			},
+			"funding": [
+				{
+					"url": "https://github.com/sebastianbergmann",
+					"type": "github"
+				}
+			],
+			"time": "2020-11-30T07:37:18+00:00"
+		},
+		{
+			"name": "sebastian/recursion-context",
+			"version": "3.0.1",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/sebastianbergmann/recursion-context.git",
+				"reference": "367dcba38d6e1977be014dc4b22f47a484dac7fb"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/sebastianbergmann/recursion-context/zipball/367dcba38d6e1977be014dc4b22f47a484dac7fb",
+				"reference": "367dcba38d6e1977be014dc4b22f47a484dac7fb",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.0"
+			},
+			"require-dev": {
+				"phpunit/phpunit": "^6.0"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "3.0.x-dev"
+				}
+			},
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause"
+			],
+			"authors": [
+				{
+					"name": "Sebastian Bergmann",
+					"email": "sebastian@phpunit.de"
+				},
+				{
+					"name": "Jeff Welch",
+					"email": "whatthejeff@gmail.com"
+				},
+				{
+					"name": "Adam Harvey",
+					"email": "aharvey@php.net"
+				}
+			],
+			"description": "Provides functionality to recursively process PHP variables",
+			"homepage": "http://www.github.com/sebastianbergmann/recursion-context",
+			"support": {
+				"issues": "https://github.com/sebastianbergmann/recursion-context/issues",
+				"source": "https://github.com/sebastianbergmann/recursion-context/tree/3.0.1"
+			},
+			"funding": [
+				{
+					"url": "https://github.com/sebastianbergmann",
+					"type": "github"
+				}
+			],
+			"time": "2020-11-30T07:34:24+00:00"
+		},
+		{
+			"name": "sebastian/resource-operations",
+			"version": "2.0.2",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/sebastianbergmann/resource-operations.git",
+				"reference": "31d35ca87926450c44eae7e2611d45a7a65ea8b3"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/sebastianbergmann/resource-operations/zipball/31d35ca87926450c44eae7e2611d45a7a65ea8b3",
+				"reference": "31d35ca87926450c44eae7e2611d45a7a65ea8b3",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.1"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "2.0-dev"
+				}
+			},
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause"
+			],
+			"authors": [
+				{
+					"name": "Sebastian Bergmann",
+					"email": "sebastian@phpunit.de"
+				}
+			],
+			"description": "Provides a list of PHP built-in functions that operate on resources",
+			"homepage": "https://www.github.com/sebastianbergmann/resource-operations",
+			"support": {
+				"issues": "https://github.com/sebastianbergmann/resource-operations/issues",
+				"source": "https://github.com/sebastianbergmann/resource-operations/tree/2.0.2"
+			},
+			"funding": [
+				{
+					"url": "https://github.com/sebastianbergmann",
+					"type": "github"
+				}
+			],
+			"time": "2020-11-30T07:30:19+00:00"
+		},
+		{
+			"name": "sebastian/type",
+			"version": "1.1.4",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/sebastianbergmann/type.git",
+				"reference": "0150cfbc4495ed2df3872fb31b26781e4e077eb4"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/sebastianbergmann/type/zipball/0150cfbc4495ed2df3872fb31b26781e4e077eb4",
+				"reference": "0150cfbc4495ed2df3872fb31b26781e4e077eb4",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.2"
+			},
+			"require-dev": {
+				"phpunit/phpunit": "^8.2"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "1.1-dev"
+				}
+			},
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause"
+			],
+			"authors": [
+				{
+					"name": "Sebastian Bergmann",
+					"email": "sebastian@phpunit.de",
+					"role": "lead"
+				}
+			],
+			"description": "Collection of value objects that represent the types of the PHP type system",
+			"homepage": "https://github.com/sebastianbergmann/type",
+			"support": {
+				"issues": "https://github.com/sebastianbergmann/type/issues",
+				"source": "https://github.com/sebastianbergmann/type/tree/1.1.4"
+			},
+			"funding": [
+				{
+					"url": "https://github.com/sebastianbergmann",
+					"type": "github"
+				}
+			],
+			"time": "2020-11-30T07:25:11+00:00"
+		},
+		{
+			"name": "sebastian/version",
+			"version": "2.0.1",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/sebastianbergmann/version.git",
+				"reference": "99732be0ddb3361e16ad77b68ba41efc8e979019"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/sebastianbergmann/version/zipball/99732be0ddb3361e16ad77b68ba41efc8e979019",
+				"reference": "99732be0ddb3361e16ad77b68ba41efc8e979019",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=5.6"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-master": "2.0.x-dev"
+				}
+			},
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause"
+			],
+			"authors": [
+				{
+					"name": "Sebastian Bergmann",
+					"email": "sebastian@phpunit.de",
+					"role": "lead"
+				}
+			],
+			"description": "Library that helps with managing the version number of Git-hosted PHP projects",
+			"homepage": "https://github.com/sebastianbergmann/version",
+			"support": {
+				"issues": "https://github.com/sebastianbergmann/version/issues",
+				"source": "https://github.com/sebastianbergmann/version/tree/master"
+			},
+			"time": "2016-10-03T07:35:21+00:00"
+		},
+		{
+			"name": "symfony/console",
+			"version": "v4.4.49",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/symfony/console.git",
+				"reference": "33fa45ffc81fdcc1ca368d4946da859c8cdb58d9"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/symfony/console/zipball/33fa45ffc81fdcc1ca368d4946da859c8cdb58d9",
+				"reference": "33fa45ffc81fdcc1ca368d4946da859c8cdb58d9",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.1.3",
+				"symfony/polyfill-mbstring": "~1.0",
+				"symfony/polyfill-php73": "^1.8",
+				"symfony/polyfill-php80": "^1.16",
+				"symfony/service-contracts": "^1.1|^2"
+			},
+			"conflict": {
+				"psr/log": ">=3",
+				"symfony/dependency-injection": "<3.4",
+				"symfony/event-dispatcher": "<4.3|>=5",
+				"symfony/lock": "<4.4",
+				"symfony/process": "<3.3"
+			},
+			"provide": {
+				"psr/log-implementation": "1.0|2.0"
+			},
+			"require-dev": {
+				"psr/log": "^1|^2",
+				"symfony/config": "^3.4|^4.0|^5.0",
+				"symfony/dependency-injection": "^3.4|^4.0|^5.0",
+				"symfony/event-dispatcher": "^4.3",
+				"symfony/lock": "^4.4|^5.0",
+				"symfony/process": "^3.4|^4.0|^5.0",
+				"symfony/var-dumper": "^4.3|^5.0"
+			},
+			"suggest": {
+				"psr/log": "For using the console logger",
+				"symfony/event-dispatcher": "",
+				"symfony/lock": "",
+				"symfony/process": ""
+			},
+			"type": "library",
+			"autoload": {
+				"psr-4": {
+					"Symfony\\Component\\Console\\": ""
+				},
+				"exclude-from-classmap": [
+					"/Tests/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "Fabien Potencier",
+					"email": "fabien@symfony.com"
+				},
+				{
+					"name": "Symfony Community",
+					"homepage": "https://symfony.com/contributors"
+				}
+			],
+			"description": "Eases the creation of beautiful and testable command line interfaces",
+			"homepage": "https://symfony.com",
+			"support": {
+				"source": "https://github.com/symfony/console/tree/v4.4.49"
+			},
+			"funding": [
+				{
+					"url": "https://symfony.com/sponsor",
+					"type": "custom"
+				},
+				{
+					"url": "https://github.com/fabpot",
+					"type": "github"
+				},
+				{
+					"url": "https://tidelift.com/funding/github/packagist/symfony/symfony",
+					"type": "tidelift"
+				}
+			],
+			"time": "2022-11-05T17:10:16+00:00"
+		},
+		{
+			"name": "symfony/finder",
+			"version": "v4.4.44",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/symfony/finder.git",
+				"reference": "66bd787edb5e42ff59d3523f623895af05043e4f"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/symfony/finder/zipball/66bd787edb5e42ff59d3523f623895af05043e4f",
+				"reference": "66bd787edb5e42ff59d3523f623895af05043e4f",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.1.3",
+				"symfony/polyfill-php80": "^1.16"
+			},
+			"type": "library",
+			"autoload": {
+				"psr-4": {
+					"Symfony\\Component\\Finder\\": ""
+				},
+				"exclude-from-classmap": [
+					"/Tests/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "Fabien Potencier",
+					"email": "fabien@symfony.com"
+				},
+				{
+					"name": "Symfony Community",
+					"homepage": "https://symfony.com/contributors"
+				}
+			],
+			"description": "Finds files and directories via an intuitive fluent interface",
+			"homepage": "https://symfony.com",
+			"support": {
+				"source": "https://github.com/symfony/finder/tree/v4.4.44"
+			},
+			"funding": [
+				{
+					"url": "https://symfony.com/sponsor",
+					"type": "custom"
+				},
+				{
+					"url": "https://github.com/fabpot",
+					"type": "github"
+				},
+				{
+					"url": "https://tidelift.com/funding/github/packagist/symfony/symfony",
+					"type": "tidelift"
+				}
+			],
+			"time": "2022-07-29T07:35:46+00:00"
+		},
+		{
+			"name": "symfony/polyfill-php73",
+			"version": "v1.27.0",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/symfony/polyfill-php73.git",
+				"reference": "9e8ecb5f92152187c4799efd3c96b78ccab18ff9"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/symfony/polyfill-php73/zipball/9e8ecb5f92152187c4799efd3c96b78ccab18ff9",
+				"reference": "9e8ecb5f92152187c4799efd3c96b78ccab18ff9",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.1"
+			},
+			"type": "library",
+			"extra": {
+				"branch-alias": {
+					"dev-main": "1.27-dev"
+				},
+				"thanks": {
+					"name": "symfony/polyfill",
+					"url": "https://github.com/symfony/polyfill"
+				}
+			},
+			"autoload": {
+				"files": [
+					"bootstrap.php"
+				],
+				"psr-4": {
+					"Symfony\\Polyfill\\Php73\\": ""
+				},
+				"classmap": [
+					"Resources/stubs"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "Nicolas Grekas",
+					"email": "p@tchwork.com"
+				},
+				{
+					"name": "Symfony Community",
+					"homepage": "https://symfony.com/contributors"
+				}
+			],
+			"description": "Symfony polyfill backporting some PHP 7.3+ features to lower PHP versions",
+			"homepage": "https://symfony.com",
+			"keywords": [
+				"compatibility",
+				"polyfill",
+				"portable",
+				"shim"
+			],
+			"support": {
+				"source": "https://github.com/symfony/polyfill-php73/tree/v1.27.0"
+			},
+			"funding": [
+				{
+					"url": "https://symfony.com/sponsor",
+					"type": "custom"
+				},
+				{
+					"url": "https://github.com/fabpot",
+					"type": "github"
+				},
+				{
+					"url": "https://tidelift.com/funding/github/packagist/symfony/symfony",
+					"type": "tidelift"
+				}
+			],
+			"time": "2022-11-03T14:55:06+00:00"
+		},
+		{
+			"name": "symfony/var-dumper",
+			"version": "v4.4.47",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/symfony/var-dumper.git",
+				"reference": "1069c7a3fca74578022fab6f81643248d02f8e63"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/symfony/var-dumper/zipball/1069c7a3fca74578022fab6f81643248d02f8e63",
+				"reference": "1069c7a3fca74578022fab6f81643248d02f8e63",
+				"shasum": ""
+			},
+			"require": {
+				"php": ">=7.1.3",
+				"symfony/polyfill-mbstring": "~1.0",
+				"symfony/polyfill-php72": "~1.5",
+				"symfony/polyfill-php80": "^1.16"
+			},
+			"conflict": {
+				"phpunit/phpunit": "<4.8.35|<5.4.3,>=5.0",
+				"symfony/console": "<3.4"
+			},
+			"require-dev": {
+				"ext-iconv": "*",
+				"symfony/console": "^3.4|^4.0|^5.0",
+				"symfony/process": "^4.4|^5.0",
+				"twig/twig": "^1.43|^2.13|^3.0.4"
+			},
+			"suggest": {
+				"ext-iconv": "To convert non-UTF-8 strings to UTF-8 (or symfony/polyfill-iconv in case ext-iconv cannot be used).",
+				"ext-intl": "To show region name in time zone dump",
+				"symfony/console": "To use the ServerDumpCommand and/or the bin/var-dump-server script"
+			},
+			"bin": [
+				"Resources/bin/var-dump-server"
+			],
+			"type": "library",
+			"autoload": {
+				"files": [
+					"Resources/functions/dump.php"
+				],
+				"psr-4": {
+					"Symfony\\Component\\VarDumper\\": ""
+				},
+				"exclude-from-classmap": [
+					"/Tests/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"MIT"
+			],
+			"authors": [
+				{
+					"name": "Nicolas Grekas",
+					"email": "p@tchwork.com"
+				},
+				{
+					"name": "Symfony Community",
+					"homepage": "https://symfony.com/contributors"
+				}
+			],
+			"description": "Provides mechanisms for walking through any arbitrary PHP variable",
+			"homepage": "https://symfony.com",
+			"keywords": [
+				"debug",
+				"dump"
+			],
+			"support": {
+				"source": "https://github.com/symfony/var-dumper/tree/v4.4.47"
+			},
+			"funding": [
+				{
+					"url": "https://symfony.com/sponsor",
+					"type": "custom"
+				},
+				{
+					"url": "https://github.com/fabpot",
+					"type": "github"
+				},
+				{
+					"url": "https://tidelift.com/funding/github/packagist/symfony/symfony",
+					"type": "tidelift"
+				}
+			],
+			"time": "2022-10-03T15:15:11+00:00"
+		},
+		{
+			"name": "theseer/tokenizer",
+			"version": "1.2.1",
+			"source": {
+				"type": "git",
+				"url": "https://github.com/theseer/tokenizer.git",
+				"reference": "34a41e998c2183e22995f158c581e7b5e755ab9e"
+			},
+			"dist": {
+				"type": "zip",
+				"url": "https://api.github.com/repos/theseer/tokenizer/zipball/34a41e998c2183e22995f158c581e7b5e755ab9e",
+				"reference": "34a41e998c2183e22995f158c581e7b5e755ab9e",
+				"shasum": ""
+			},
+			"require": {
+				"ext-dom": "*",
+				"ext-tokenizer": "*",
+				"ext-xmlwriter": "*",
+				"php": "^7.2 || ^8.0"
+			},
+			"type": "library",
+			"autoload": {
+				"classmap": [
+					"src/"
+				]
+			},
+			"notification-url": "https://packagist.org/downloads/",
+			"license": [
+				"BSD-3-Clause"
+			],
+			"authors": [
+				{
+					"name": "Arne Blankerts",
+					"email": "arne@blankerts.de",
+					"role": "Developer"
+				}
+			],
+			"description": "A small library for converting tokenized PHP source code into XML and potentially other formats",
+			"support": {
+				"issues": "https://github.com/theseer/tokenizer/issues",
+				"source": "https://github.com/theseer/tokenizer/tree/1.2.1"
+			},
+			"funding": [
+				{
+					"url": "https://github.com/theseer",
+					"type": "github"
+				}
+			],
+			"time": "2021-07-28T10:34:58+00:00"
+		}
+	],
+	"aliases": [],
+	"minimum-stability": "stable",
+	"stability-flags": [],
+	"prefer-stable": false,
+	"prefer-lowest": false,
+	"platform": {
+		"php": "^7.2"
+	},
+	"platform-dev": [],
+	"platform-overrides": {
+		"php": "7.2.5"
+	},
+	"plugin-api-version": "2.3.0"
+}
diff --git a/install/rpm/filemanager/filegator/configuration.php b/install/rpm/filemanager/filegator/configuration.php
new file mode 100644
index 0000000..3298d8c
--- /dev/null
+++ b/install/rpm/filemanager/filegator/configuration.php
@@ -0,0 +1,175 @@
+<?php
+use function Hestiacp\quoteshellarg\quoteshellarg;
+
+$dist_config = require __DIR__ . "/configuration_sample.php";
+
+$dist_config["public_path"] = "/fm/";
+$dist_config["frontend_config"]["app_name"] = "File Manager - Hestia Control Panel";
+$dist_config["frontend_config"]["logo"] = "../images/logo.svg";
+$dist_config["frontend_config"]["editable"] = [
+	".txt",
+	".css",
+	".js",
+	".ts",
+	".html",
+	".php",
+	".py",
+	".yml",
+	".xml",
+	".md",
+	".log",
+	".csv",
+	".conf",
+	".config",
+	".ini",
+	".scss",
+	".sh",
+	".env",
+	".example",
+	".htaccess",
+	".twig",
+	".tpl",
+	".yaml",
+];
+$dist_config["frontend_config"]["guest_redirection"] = "/login/";
+$dist_config["frontend_config"]["upload_max_size"] = 1024 * 1024 * 1024;
+
+$dist_config["services"]["Filegator\Services\Storage\Filesystem"]["config"][
+	"adapter"
+] = function () {
+	if (!empty($_SESSION["INACTIVE_SESSION_TIMEOUT"])) {
+		if ($_SESSION["INACTIVE_SESSION_TIMEOUT"] * 60 + $_SESSION["LAST_ACTIVITY"] < time()) {
+			$v_user = quoteshellarg($_SESSION["user"]);
+			$v_session_id = quoteshellarg($_SESSION["token"]);
+			exec(
+				"/usr/local/hestia/bin/v-log-user-logout " . $v_user . " " . $v_session_id,
+				$output,
+				$return_var,
+			);
+			unset($_SESSION);
+			session_unset();
+			session_destroy();
+			session_start();
+			echo '<meta http-equiv="refresh" content="0; url=/">';
+			exit();
+		} else {
+			$_SESSION["LAST_ACTIVITY"] = time();
+		}
+	} else {
+		echo '<meta http-equiv="refresh" content="0; url=/">';
+	}
+	if (isset($_SESSION["user"])) {
+		$v_user = $_SESSION["user"];
+	}
+	if (!empty($_SESSION["look"])) {
+		if (isset($_SESSION["look"]) && $_SESSION["userContext"] === "admin") {
+			$v_user = $_SESSION["look"];
+		}
+		if (
+			isset($_SESSION["look"]) &&
+			$_SESSION["look"] == "admin" &&
+			$_SESSION["POLICY_SYSTEM_PROTECTED_ADMIN"] == "yes"
+		) {
+			header("Location: /");
+		}
+	}
+	# Create filemanager sftp key if missing and trash it after 30 min
+	if (!file_exists("/home/" . basename($v_user) . "/.ssh/hst-filemanager-key")) {
+		exec(
+			"sudo /usr/local/hestia/bin/v-add-user-sftp-key " .
+				quoteshellarg(basename($v_user)) .
+				" 30",
+			$output,
+			$return_var,
+		);
+		// filemanager also requires .ssh chmod o+x ... hopefully we can improve it to g+x or u+x someday
+		// current minimum for filemanager: chmod 0701 .ssh
+		shell_exec("sudo chmod o+x " . quoteshellarg("/home/" . basename($v_user) . "/.ssh"));
+	}
+
+	if (!isset($_SESSION["SFTP_PORT"])) {
+		exec("sudo /usr/local/hestia/bin/v-list-sys-sshd-port json", $output, $result);
+		$port = json_decode(implode("", $output));
+		if (is_numeric($port[0]) && $port[0] > 0) {
+			$_SESSION["SFTP_PORT"] = $port[0];
+		} elseif (
+			preg_match('/^\s*Port\s+(\d+)$/im', file_get_contents("/etc/ssh/sshd_config"), $matches)
+		) {
+			$_SESSION["SFTP_PORT"] = $matches[1] ?? 22;
+		} else {
+			$_SESSION["SFTP_PORT"] = 22;
+		}
+	}
+
+	preg_match(
+		'/(Hestia SFTP Chroot\nMatch User)(.*)/i',
+		file_get_contents("/etc/ssh/sshd_config"),
+		$matches,
+	);
+	$user_list = explode(",", $matches[2]);
+	if (in_array($v_user, $user_list)) {
+		$root = "/";
+	} else {
+		$root = "/home/" . $v_user;
+	}
+
+	return new \League\Flysystem\Sftp\SftpAdapter([
+		"host" => "127.0.0.1",
+		"port" => intval($_SESSION["SFTP_PORT"]),
+		"username" => basename($v_user),
+		"privateKey" => "/home/" . basename($v_user) . "/.ssh/hst-filemanager-key",
+		"root" => $root,
+		"timeout" => 10,
+		"directoryPerm" => 0755,
+	]);
+};
+
+$dist_config["services"]["Filegator\Services\Archiver\ArchiverInterface"] = [
+	"handler" => "\Filegator\Services\Archiver\Adapters\HestiaZipArchiver",
+	"config" => [],
+];
+
+$dist_config["services"]["Filegator\Services\Auth\AuthInterface"] = [
+	"handler" => "\Filegator\Services\Auth\Adapters\HestiaAuth",
+	"config" => [
+		"permissions" => ["read", "write", "upload", "download", "batchdownload", "zip"],
+		"private_repos" => false,
+	],
+];
+
+$dist_config["services"]["Filegator\Services\View\ViewInterface"]["config"] = [
+	"add_to_head" => '
+    <style>
+        .logo {
+            width: 46px;
+        }
+    </style>
+    ',
+	"add_to_body" => '
+<script>
+    var checkVueLoaded = setInterval(function() {
+        if (document.getElementsByClassName("container").length) {
+            clearInterval(checkVueLoaded);
+            var navProfile = document.getElementsByClassName("navbar-item profile")[0]; navProfile.replaceWith(navProfile.cloneNode(true))
+            document.getElementsByClassName("navbar-item logout")[0].text="Exit to Control Panel \u00BB";
+            div = document.getElementsByClassName("container")[0];
+            callback = function(){
+                if (document.getElementsByClassName("navbar-item logout")[0]){
+                    if ( document.getElementsByClassName("navbar-item logout")[0].text != "Exit to Control Panel \u00BB" ){
+                        var navProfile = document.getElementsByClassName("navbar-item profile")[0]; navProfile.replaceWith(navProfile.cloneNode(true))
+                        document.getElementsByClassName("navbar-item logout")[0].text="Exit to Control Panel \u00BB";
+                    }
+                }
+            }
+            config = {
+                childList:true,
+                subtree:true
+            }
+            observer = new MutationObserver(callback);
+            observer.observe(div,config);
+        }
+    }, 200);
+</script>',
+];
+
+return $dist_config;
diff --git a/install/rpm/filemanager/install-fm.sh b/install/rpm/filemanager/install-fm.sh
new file mode 100755
index 0000000..7d3a0e4
--- /dev/null
+++ b/install/rpm/filemanager/install-fm.sh
@@ -0,0 +1,71 @@
+#!/bin/bash
+
+# Checking root permissions
+if [ "x$(id -u)" != 'x0' ]; then
+	echo "Error: Script can be run executed only by root"
+	exit 10
+fi
+
+if [ -z "$HESTIA" ]; then
+	HESTIA="/usr/local/hestia"
+fi
+
+user='admin'
+fm_error='no'
+source $HESTIA/func/main.sh
+source $HESTIA/install/upgrade/upgrade.conf
+
+if [ -z "$HOMEDIR" ] || [ -z "$HESTIA_INSTALL_DIR" ]; then
+	echo "Error: Hestia environment vars not present"
+	exit 2
+fi
+
+FM_INSTALL_DIR="$HESTIA/web/fm"
+
+FM_FILE="filegator_latest"
+FM_URL="https://github.com/filegator/static/raw/master/builds/filegator_latest.zip"
+
+COMPOSER_BIN="$HOMEDIR/$user/.composer/composer"
+if [ ! -f "$COMPOSER_BIN" ]; then
+	$BIN/v-add-user-composer "$user"
+	if [ $? -ne 0 ]; then
+		$BIN/v-add-user-notification admin 'Composer installation failed!' '<p class="u-text-bold">The File Manager will not work without Composer.</p><p>Please try running the installer from a shell session:<br><code>bash $HESTIA/install/deb/filemanager/install-fm.sh</code></p><p>If this issue continues, please <a href="https://github.com/hestiacp/hestiacp/issues" target="_blank">open an issue on GitHub</a>.</p>'
+		fm_error='yes'
+	fi
+fi
+
+if [ "$fm_error" != "yes" ]; then
+	rm --recursive --force "$FM_INSTALL_DIR"
+	mkdir -p "$FM_INSTALL_DIR"
+	cd "$FM_INSTALL_DIR"
+
+	[ ! -f "${FM_INSTALL_DIR}/${FM_FILE}" ] && wget "$FM_URL" --quiet -O "${FM_INSTALL_DIR}/${FM_FILE}.zip"
+
+	unzip -qq "${FM_INSTALL_DIR}/${FM_FILE}.zip"
+	mv --force ${FM_INSTALL_DIR}/filegator/* "${FM_INSTALL_DIR}"
+	rm --recursive --force ${FM_INSTALL_DIR}/${FM_FILE}
+	[[ -f "${FM_INSTALL_DIR}/${FM_FILE}" ]] && rm "${FM_INSTALL_DIR}/${FM_FILE}"
+
+	cp --recursive --force ${HESTIA_INSTALL_DIR}/filemanager/filegator/* "${FM_INSTALL_DIR}"
+
+	chown $user: -R "${FM_INSTALL_DIR}"
+
+	# Check if php7.3 is available and run the installer
+	if [ -f "/usr/bin/php7.3" ]; then
+		COMPOSER_HOME="$HOMEDIR/$user/.config/composer" user_exec /usr/bin/php7.3 $COMPOSER_BIN --quiet --no-dev install
+		if [ $? -ne 0 ]; then
+			$BIN/v-add-user-notification admin 'File Manager installation failed!' '<p>Please try running the installer from a shell session:<br><code>bash $HESTIA/install/deb/filemanager/install-fm.sh</code></p><p>If this issue continues, please <a href="https://github.com/hestiacp/hestiacp/issues" target="_blank">open an issue on GitHub</a>.</p>'
+			fm_error="yes"
+		fi
+	else
+		$BIN/v-add-user-notification admin 'File Manager installation failed!' '<p class="u-text-bold">Unable to proceed with installation of File Manager.</p><p>Package <span class="u-text-bold">php7.3-cli</span> is missing from your system. Please check your PHP installation and environment settings.</p>'
+		fm_error="yes"
+	fi
+
+	if [ "$fm_error" != "yes" ]; then
+		chown root: -R "${FM_INSTALL_DIR}"
+		chown $user: "${FM_INSTALL_DIR}/private"
+		chown $user: "${FM_INSTALL_DIR}/private/logs"
+		chown $user: "${FM_INSTALL_DIR}/repository"
+	fi
+fi
diff --git a/install/rpm/hestia/hestia.repo b/install/rpm/hestia/hestia.repo
index 4513db1..cf9395b 100644
--- a/install/rpm/hestia/hestia.repo
+++ b/install/rpm/hestia/hestia.repo
@@ -1,7 +1,7 @@
 [hestiacp]
-name=HestiaCP Repository for RHEL $releasever - $basearch
-#baseurl=https://rpm.hestiacp.com/rhel/$releasever/$basearch/
-baseurl=https://pkgs.dyn.su/hestiacp/el$releasever/$basearch/
-#gpgkey=https://rpm.hestiacp.com/RPM-GPG-KEY-HESTIACP
-gpgcheck=0
-enabled=1
\ No newline at end of file
+name=msvsphere9 repo on repo.putey.net
+comment=msvsphere9 repo on repo.putey.net
+baseurl=https://repo.putey.net/repo/msvsphere9_preprod
+enabled=1
+gpgkey=https://repo.putey.net/repo/gpgkeys/repo.putey.net.pub
+gpgcheck=1
\ No newline at end of file
diff --git a/install/rpm/httpd/hestia.conf b/install/rpm/httpd/hestia.conf
index fc68cfb..fa13846 100644
--- a/install/rpm/httpd/hestia.conf
+++ b/install/rpm/httpd/hestia.conf
@@ -55,4 +55,4 @@ EnableSendfile on
     LogFormat "%a %l %u %t \"%r\" %>s %b" common
 </IfModule>
 
-IncludeOptional conf.d/*.conf
+IncludeOptional conf.h.d/*.conf
diff --git a/install/rpm/httpd/hestiacp-httpd.conf b/install/rpm/httpd/hestiacp-httpd.conf
new file mode 100644
index 0000000..0a38143
--- /dev/null
+++ b/install/rpm/httpd/hestiacp-httpd.conf
@@ -0,0 +1,3 @@
+[Unit]
+Wants=network-online.target
+After=network-online.target
diff --git a/install/rpm/httpd/httpd.conf b/install/rpm/httpd/httpd.conf
index cd4d7d8..99f99ac 100644
--- a/install/rpm/httpd/httpd.conf
+++ b/install/rpm/httpd/httpd.conf
@@ -67,9 +67,9 @@ LogFormat "%{Referer}i -> %U" referer
 LogFormat "%{User-agent}i" agent
 LogFormat "%b" bytes
 
-Include conf.d/*.conf
-IncludeOptional conf.d/domains/webmail.*.conf
-IncludeOptional conf.d/domains/*.conf
+Include conf.h.d/*.conf
+IncludeOptional conf.h.d/domains/webmail.*.conf
+IncludeOptional conf.h.d/domains/*.conf
 
 ErrorDocument 403 /error/403.html
 ErrorDocument 404 /error/404.html
diff --git a/install/rpm/oneshot/hestiacp-prepare.service b/install/rpm/oneshot/hestiacp-prepare.service
new file mode 100644
index 0000000..d5321ad
--- /dev/null
+++ b/install/rpm/oneshot/hestiacp-prepare.service
@@ -0,0 +1,11 @@
+[Unit]
+Description=Prepare some actions on system boot for HestiaCP rpm
+Before=network.target
+
+[Service]
+Type=oneshot
+RemainAfterExit=yes
+ExecStart=/usr/local/hestia/bin/v-oneshot-service
+
+[Install]
+WantedBy=multi-user.target
\ No newline at end of file
diff --git a/install/rpm/pma/apache.conf b/install/rpm/pma/apache.conf
index 7c8a89a..2309369 100644
--- a/install/rpm/pma/apache.conf
+++ b/install/rpm/pma/apache.conf
@@ -26,7 +26,8 @@ Alias /%pma_alias% /usr/share/phpmyadmin
 	</IfDefine>
     <IfDefine !PHP_ENABLED>
         <FilesMatch \.php$>
-            SetHandler "proxy:unix:/run/hestia-php.sock|fcgi://localhost"
+            #SetHandler "proxy:unix:/run/hestia/php.sock|fcgi://localhost"
+            SetHandler "proxy:fcgi://127.0.0.1:9000"
         </FilesMatch>
     </IfDefine>
 
diff --git a/install/rpm/templates/web/apache2/default.stpl b/install/rpm/templates/web/httpd/default.stpl
similarity index 97%
rename from install/rpm/templates/web/apache2/default.stpl
rename to install/rpm/templates/web/httpd/default.stpl
index 27a0773..3cdde66 100644
--- a/install/rpm/templates/web/apache2/default.stpl
+++ b/install/rpm/templates/web/httpd/default.stpl
@@ -45,5 +45,5 @@
     </IfModule>
 
     IncludeOptional %home%/%user%/conf/web/%domain%/%web_system%.ssl.conf_*
-    IncludeOptional /etc/httpd/conf.d/*.inc
+    IncludeOptional /etc/httpd/conf.h.d/*.inc
 </VirtualHost>
diff --git a/install/rpm/templates/web/apache2/default.tpl b/install/rpm/templates/web/httpd/default.tpl
similarity index 97%
rename from install/rpm/templates/web/apache2/default.tpl
rename to install/rpm/templates/web/httpd/default.tpl
index 7b57e51..8445cb3 100644
--- a/install/rpm/templates/web/apache2/default.tpl
+++ b/install/rpm/templates/web/httpd/default.tpl
@@ -42,5 +42,5 @@
     </IfModule>
 
     IncludeOptional %home%/%user%/conf/web/%domain%/%web_system%.conf_*
-    IncludeOptional /etc/httpd/conf.d/*.inc
+    IncludeOptional /etc/httpd/conf.h.d/*.inc
 </VirtualHost>
diff --git a/install/rpm/templates/web/apache2/hosting.stpl b/install/rpm/templates/web/httpd/hosting.stpl
similarity index 98%
rename from install/rpm/templates/web/apache2/hosting.stpl
rename to install/rpm/templates/web/httpd/hosting.stpl
index a02ae26..0155350 100644
--- a/install/rpm/templates/web/apache2/hosting.stpl
+++ b/install/rpm/templates/web/httpd/hosting.stpl
@@ -51,5 +51,5 @@
     </IfModule>
 
     IncludeOptional %home%/%user%/conf/web/%domain%/%web_system%.ssl.conf_*
-    IncludeOptional /etc/httpd/conf.d/*.inc*
+    IncludeOptional /etc/httpd/conf.h.d/*.inc*
 </VirtualHost>
diff --git a/install/rpm/templates/web/apache2/hosting.tpl b/install/rpm/templates/web/httpd/hosting.tpl
similarity index 97%
rename from install/rpm/templates/web/apache2/hosting.tpl
rename to install/rpm/templates/web/httpd/hosting.tpl
index 85f7a7f..df0767e 100644
--- a/install/rpm/templates/web/apache2/hosting.tpl
+++ b/install/rpm/templates/web/httpd/hosting.tpl
@@ -48,5 +48,5 @@
     </IfModule>
 
     IncludeOptional %home%/%user%/conf/web/%domain%/%web_system%.conf_*
-    IncludeOptional /etc/httpd/conf.d/*.inc
+    IncludeOptional /etc/httpd/conf.h.d/*.inc
 </VirtualHost>
diff --git a/install/rpm/templates/web/apache2/php-fpm/default.stpl b/install/rpm/templates/web/httpd/php-fpm/default.stpl
similarity index 97%
rename from install/rpm/templates/web/apache2/php-fpm/default.stpl
rename to install/rpm/templates/web/httpd/php-fpm/default.stpl
index 6de27cf..717a597 100644
--- a/install/rpm/templates/web/apache2/php-fpm/default.stpl
+++ b/install/rpm/templates/web/httpd/php-fpm/default.stpl
@@ -37,5 +37,5 @@
     SetEnvIf Authorization .+ HTTP_AUTHORIZATION=$0
 
     IncludeOptional %home%/%user%/conf/web/%domain%/%web_system%.ssl.conf_*
-    IncludeOptional /etc/httpd/conf.d/*.inc
+    IncludeOptional /etc/httpd/conf.h.d/*.inc
 </VirtualHost>
diff --git a/install/rpm/templates/web/apache2/php-fpm/default.tpl b/install/rpm/templates/web/httpd/php-fpm/default.tpl
similarity index 96%
rename from install/rpm/templates/web/apache2/php-fpm/default.tpl
rename to install/rpm/templates/web/httpd/php-fpm/default.tpl
index 8213dd3..c9ebd32 100644
--- a/install/rpm/templates/web/apache2/php-fpm/default.tpl
+++ b/install/rpm/templates/web/httpd/php-fpm/default.tpl
@@ -34,5 +34,5 @@
     SetEnvIf Authorization .+ HTTP_AUTHORIZATION=$0
 
     IncludeOptional %home%/%user%/conf/web/%domain%/%web_system%.conf_*
-    IncludeOptional /etc/httpd/conf.d/*.inc
+    IncludeOptional /etc/httpd/conf.h.d/*.inc
 </VirtualHost>
diff --git a/install/rpm/templates/web/apache2/phpcgi.sh b/install/rpm/templates/web/httpd/phpcgi.sh
similarity index 100%
rename from install/rpm/templates/web/apache2/phpcgi.sh
rename to install/rpm/templates/web/httpd/phpcgi.sh
diff --git a/install/rpm/templates/web/apache2/phpcgi.stpl b/install/rpm/templates/web/httpd/phpcgi.stpl
similarity index 97%
rename from install/rpm/templates/web/apache2/phpcgi.stpl
rename to install/rpm/templates/web/httpd/phpcgi.stpl
index b775178..0293990 100644
--- a/install/rpm/templates/web/apache2/phpcgi.stpl
+++ b/install/rpm/templates/web/httpd/phpcgi.stpl
@@ -40,5 +40,5 @@
     %ssl_ca_str%SSLCertificateChainFile %ssl_ca%
 
     IncludeOptional %home%/%user%/conf/web/%domain%/%web_system%.ssl.conf_*
-    IncludeOptional /etc/httpd/conf.d/*.inc
+    IncludeOptional /etc/httpd/conf.h.d/*.inc
 </VirtualHost>
diff --git a/install/rpm/templates/web/apache2/phpcgi.tpl b/install/rpm/templates/web/httpd/phpcgi.tpl
similarity index 97%
rename from install/rpm/templates/web/apache2/phpcgi.tpl
rename to install/rpm/templates/web/httpd/phpcgi.tpl
index a38d577..392b25b 100644
--- a/install/rpm/templates/web/apache2/phpcgi.tpl
+++ b/install/rpm/templates/web/httpd/phpcgi.tpl
@@ -36,5 +36,5 @@
         AllowOverride All
     </Directory>
     IncludeOptional %home%/%user%/conf/web/%domain%/%web_system%.conf_*
-    IncludeOptional /etc/httpd/conf.d/*.inc
+    IncludeOptional /etc/httpd/conf.h.d/*.inc
 </VirtualHost>
diff --git a/install/rpm/templates/web/apache2/phpfcgid.sh b/install/rpm/templates/web/httpd/phpfcgid.sh
similarity index 100%
rename from install/rpm/templates/web/apache2/phpfcgid.sh
rename to install/rpm/templates/web/httpd/phpfcgid.sh
diff --git a/install/rpm/templates/web/apache2/phpfcgid.stpl b/install/rpm/templates/web/httpd/phpfcgid.stpl
similarity index 97%
rename from install/rpm/templates/web/apache2/phpfcgid.stpl
rename to install/rpm/templates/web/httpd/phpfcgid.stpl
index 5da82d3..75730d4 100644
--- a/install/rpm/templates/web/apache2/phpfcgid.stpl
+++ b/install/rpm/templates/web/httpd/phpfcgid.stpl
@@ -41,5 +41,5 @@
     %ssl_ca_str%SSLCertificateChainFile %ssl_ca%
 
     IncludeOptional %home%/%user%/conf/web/%domain%/%web_system%.ssl.conf_*
-    IncludeOptional /etc/httpd/conf.d/*.inc
+    IncludeOptional /etc/httpd/conf.h.d/*.inc
 </VirtualHost>
diff --git a/install/rpm/templates/web/apache2/phpfcgid.tpl b/install/rpm/templates/web/httpd/phpfcgid.tpl
similarity index 97%
rename from install/rpm/templates/web/apache2/phpfcgid.tpl
rename to install/rpm/templates/web/httpd/phpfcgid.tpl
index 366a1fa..5052f0a 100644
--- a/install/rpm/templates/web/apache2/phpfcgid.tpl
+++ b/install/rpm/templates/web/httpd/phpfcgid.tpl
@@ -36,5 +36,5 @@
         AllowOverride All
     </Directory>
     IncludeOptional %home%/%user%/conf/web/%domain%/%web_system%.conf_*
-    IncludeOptional /etc/httpd/conf.d/*.inc
+    IncludeOptional /etc/httpd/conf.h.d/*.inc
 </VirtualHost>
diff --git a/install/rpm/templates/web/apache2/www-data.stpl b/install/rpm/templates/web/httpd/www-data.stpl
similarity index 97%
rename from install/rpm/templates/web/apache2/www-data.stpl
rename to install/rpm/templates/web/httpd/www-data.stpl
index 2992f27..d953075 100644
--- a/install/rpm/templates/web/apache2/www-data.stpl
+++ b/install/rpm/templates/web/httpd/www-data.stpl
@@ -37,5 +37,5 @@
     %ssl_ca_str%SSLCertificateChainFile %ssl_ca%
 
     IncludeOptional %home%/%user%/conf/web/%domain%/%web_system%.ssl.conf_*
-    IncludeOptional /etc/httpd/conf.d/*.inc
+    IncludeOptional /etc/httpd/conf.h.d/*.inc
 </VirtualHost>
diff --git a/install/rpm/templates/web/apache2/www-data.tpl b/install/rpm/templates/web/httpd/www-data.tpl
similarity index 97%
rename from install/rpm/templates/web/apache2/www-data.tpl
rename to install/rpm/templates/web/httpd/www-data.tpl
index 4124b08..0dd536f 100644
--- a/install/rpm/templates/web/apache2/www-data.tpl
+++ b/install/rpm/templates/web/httpd/www-data.tpl
@@ -34,5 +34,5 @@
     </Directory>
 
     IncludeOptional %home%/%user%/conf/web/%domain%/%web_system%.conf_*
-    IncludeOptional /etc/httpd/conf.d/*.inc
+    IncludeOptional /etc/httpd/conf.h.d/*.inc
 </VirtualHost>
diff --git a/install/upgrade/manual/migrate_phpmyadmin.sh b/install/upgrade/manual/migrate_phpmyadmin.sh
index 2ba1e69..b05d9f6 100755
--- a/install/upgrade/manual/migrate_phpmyadmin.sh
+++ b/install/upgrade/manual/migrate_phpmyadmin.sh
@@ -65,6 +65,12 @@ if [[ $REPLY =~ ^[Yy]$ ]]; then
 		ln -s /etc/phpmyadmin/apache.conf /etc/apache2/conf.d/phpmyadmin.conf
 	fi
 
+	if [ "$WEB_SYSTEM" == "httpd" ]; then
+		cp -f $HESTIA_INSTALL_DIR/pma/apache.conf /etc/phpmyadmin/
+		rm /etc/httpd/conf.h.d/phpmyadmin.conf
+		ln -s /etc/phpmyadmin/apache.conf /etc/httpd/conf.h.d/phpmyadmin.conf
+	fi
+
 	PASS=$(generate_password)
 
 	echo "[ * ] Installing phpMyAdmin version v$pma_v..."
diff --git a/install/upgrade/versions/0.9.8-29.sh b/install/upgrade/versions/0.9.8-29.sh
deleted file mode 100644
index b389ede..0000000
--- a/install/upgrade/versions/0.9.8-29.sh
+++ /dev/null
@@ -1,30 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 0.9.8-28
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-
-# Add amd64 to repositories to prevent notifications - https://goo.gl/hmsSV7
-if ! grep -q 'arch=amd64' /etc/apt/sources.list.d/nginx.list; then
-	sed -i s/"deb "/"deb [arch=amd64] "/g /etc/apt/sources.list.d/nginx.list
-fi
-if ! grep -q 'arch=amd64' /etc/apt/sources.list.d/mariadb.list; then
-	sed -i s/"deb "/"deb [arch=amd64] "/g /etc/apt/sources.list.d/mariadb.list
-fi
-
-# Fix named rule for AppArmor - https://goo.gl/SPqHdq
-if [ "$DNS_SYSTEM" = 'bind9' ] && [ ! -f /etc/apparmor.d/local/usr.sbin.named ]; then
-	echo "/home/** rwm," >> /etc/apparmor.d/local/usr.sbin.named 2> /dev/null
-fi
-
-# Remove obsolete ports.conf if exists.
-if [ -f /usr/local/hestia/data/firewall/ports.conf ]; then
-	rm -f /usr/local/hestia/data/firewall/ports.conf
-fi
-
-# Move clamav to proper location - https://goo.gl/zNuM11
-if [ ! -d /usr/local/hestia/web/edit/server/clamav-daemon ]; then
-	mv /usr/local/hestia/web/edit/server/clamd /usr/local/web/edit/server/clamav-daemon
-fi
diff --git a/install/upgrade/versions/1.0.1.sh b/install/upgrade/versions/1.0.1.sh
deleted file mode 100644
index d2966cf..0000000
--- a/install/upgrade/versions/1.0.1.sh
+++ /dev/null
@@ -1,16 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.0.1
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-
-# Remove global options from nginx.conf to prevent conflicts with other web packages
-# and remove OCSP SSL stapling from global configuration as it has moved to per-domain availability in this release.
-if [ -e /etc/nginx/nginx.conf ]; then
-	sed -i "/add_header          X-Frame-Options SAMEORIGIN;/d" /etc/nginx/nginx.conf
-	sed -i "/add_header          X-Content-Type-Options nosniff;/d" /etc/nginx/nginx.conf
-	sed -i "/ssl_stapling        on;/d" /etc/nginx/nginx.conf
-	sed -i "/ssl_stapling_verify on;/d" /etc/nginx/nginx.conf
-fi
diff --git a/install/upgrade/versions/1.0.2.sh b/install/upgrade/versions/1.0.2.sh
deleted file mode 100644
index d399c97..0000000
--- a/install/upgrade/versions/1.0.2.sh
+++ /dev/null
@@ -1,70 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.0.2
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-
-# Replace dhparam 1024 with dhparam 4096
-echo "[ * ] Increasing Diffie-Hellman Parameter strength to 4096-bit..."
-if [ -e /etc/ssl/dhparam.pem ]; then
-	mv /etc/ssl/dhparam.pem $HESTIA_BACKUP/conf/
-fi
-cp -f $HESTIA/install/deb/ssl/dhparam.pem /etc/ssl/
-chmod 600 /etc/ssl/dhparam.pem
-
-# Enhance Vsftpd security
-if [ "$FTP_SYSTEM" = "vsftpd" ]; then
-	echo "[ * ] Hardening Vsftpd SSL configuration..."
-	cp -f /etc/vsftpd.conf $HESTIA_BACKUP/conf/
-	sed -i "s|ssl_tlsv1=YES|ssl_tlsv1=NO|g" /etc/vsftpd.conf
-fi
-
-# Enhance Dovecot security
-if [ "$IMAP_SYSTEM" = "dovecot" ]; then
-	echo "[ * ] Hardening Dovecot SSL configuration..."
-	mv /etc/dovecot/conf.d/10-ssl.conf $HESTIA_BACKUP/conf/
-	cp -f $HESTIA/install/deb/dovecot/conf.d/10-ssl.conf /etc/dovecot/conf.d/
-fi
-
-# Update DNS resolvers in hestia-nginx's configuration
-echo "[ * ] Updating DNS resolvers for Hestia Internal Web Server..."
-dns_resolver=$(cat /etc/resolv.conf | grep -i '^nameserver' | cut -d ' ' -f2 | tr '\r\n' ' ' | xargs)
-for ip in $dns_resolver; do
-	if [[ $ip =~ ^[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+$ ]]; then
-		resolver="$ip $resolver"
-	fi
-done
-if [ ! -z "$resolver" ]; then
-	sed -i "s/1.0.0.1 1.1.1.1/$resolver/g" /usr/local/hestia/nginx/conf/nginx.conf
-fi
-
-# Remove Webalizer and set AWStats as default
-WEBALIZER_CHECK=$(cat $HESTIA/conf/hestia.conf | grep webalizer)
-if [ ! -z "$WEBALIZER_CHECK" ]; then
-	echo "[ * ] Set awstats as default web statistics backend..."
-	$HESTIA/bin/v-change-sys-config-value 'STATS_SYSTEM' 'awstats'
-fi
-
-# Remove old hestia.conf files from Apache & NGINX if they exist
-if [ -f "/etc/apache2/conf.d/hestia.conf" ]; then
-	echo "[ * ] Removing old Apache configuration file from previous version of Hestia Control Panel..."
-	rm -f /etc/apache2/conf.d/hestia.conf
-fi
-if [ -f "/etc/nginx/conf.d/hestia.conf" ]; then
-	echo "[ * ] Removing old NGINX configuration file from previous version of Hestia Control Panel..."
-	rm -f /etc/nginx/conf.d/hestia.conf
-fi
-
-# Update webmail templates to enable OCSP/SSL stapling
-if [ ! -z "$IMAP_SYSTEM" ]; then
-	echo "[ * ] Enabling OCSP stapling support for webmail services..."
-	$BIN/v-update-mail-templates > /dev/null 2>&1
-fi
-
-# Enhance webmail security
-if [ -e "/etc/nginx/conf.d/webmail.inc" ]; then
-	cp -f /etc/nginx/conf.d/webmail.inc $HESTIA_BACKUP/conf/
-	sed -i "s/config|temp|logs/README.md|config|temp|logs|bin|SQL|INSTALL|LICENSE|CHANGELOG|UPGRADING/g" /etc/nginx/conf.d/webmail.inc
-fi
diff --git a/install/upgrade/versions/1.0.3.sh b/install/upgrade/versions/1.0.3.sh
deleted file mode 100644
index 3e0b248..0000000
--- a/install/upgrade/versions/1.0.3.sh
+++ /dev/null
@@ -1,7 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.0.3
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
diff --git a/install/upgrade/versions/1.0.4.sh b/install/upgrade/versions/1.0.4.sh
deleted file mode 100644
index a9e1513..0000000
--- a/install/upgrade/versions/1.0.4.sh
+++ /dev/null
@@ -1,7 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.0.4
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
diff --git a/install/upgrade/versions/1.0.5.sh b/install/upgrade/versions/1.0.5.sh
deleted file mode 100644
index a9fc368..0000000
--- a/install/upgrade/versions/1.0.5.sh
+++ /dev/null
@@ -1,7 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.0.5
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
diff --git a/install/upgrade/versions/1.0.6.sh b/install/upgrade/versions/1.0.6.sh
deleted file mode 100644
index 63c795f..0000000
--- a/install/upgrade/versions/1.0.6.sh
+++ /dev/null
@@ -1,7 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.0.6
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
diff --git a/install/upgrade/versions/1.00.0-190618.sh b/install/upgrade/versions/1.00.0-190618.sh
deleted file mode 100644
index f9de15c..0000000
--- a/install/upgrade/versions/1.00.0-190618.sh
+++ /dev/null
@@ -1,267 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.00.0-190618
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-
-# Add webmail alias variable to system configuration if non-existent
-if [ -z "$WEBMAIL_ALIAS" ]; then
-	echo "[ * ] Updating webmail alias configuration..."
-	$HESTIA/bin/v-change-sys-config-value 'WEBMAIL_ALIAS' "webmail"
-fi
-
-# Update Apache and Nginx configuration to support new file structure
-if [ -f /etc/apache2/apache.conf ]; then
-	echo "[ * ] Updating Apache configuration..."
-	mv /etc/apache2/apache.conf $HESTIA_BACKUP/conf/
-	cp -f $HESTIA_INSTALL_DIR/apache2/apache.conf /etc/apache2/apache.conf
-fi
-if [ -f /etc/nginx/nginx.conf ]; then
-	echo "[ * ] Updating NGINX configuration..."
-	mv /etc/nginx/nginx.conf $HESTIA_BACKUP/conf/
-	cp -f $HESTIA_INSTALL_DIR/nginx/nginx.conf /etc/nginx/nginx.conf
-fi
-
-# Generate dhparam
-if [ ! -e /etc/ssl/dhparam.pem ]; then
-	echo "[ * ] Enabling HTTPS Strict Transport Security (HSTS) support..."
-	mv /etc/nginx/nginx.conf $HESTIA_BACKUP/conf/
-	cp -f $HESTIA_INSTALL_DIR/nginx/nginx.conf /etc/nginx/
-
-	# Copy dhparam
-	cp -f $HESTIA_INSTALL_DIR/ssl/dhparam.pem /etc/ssl/
-
-	# Update DNS servers in nginx.conf
-	dns_resolver=$(cat /etc/resolv.conf | grep -i '^nameserver' | cut -d ' ' -f2 | tr '\r\n' ' ' | xargs)
-	sed -i "s/1.0.0.1 1.1.1.1/$dns_resolver/g" /etc/nginx/nginx.conf
-fi
-
-# Back up default package and install latest version
-if [ -d $HESTIA/data/packages/ ]; then
-	echo "[ * ] Replacing default packages..."
-	cp -f $HESTIA/data/packages/default.pkg $HESTIA_BACKUP/packages/
-fi
-
-# Remove old Office 365 template as there is a newer version with an updated name
-if [ -f $HESTIA/data/templates/dns/o365.tpl ]; then
-	rm -f $HESTIA/data/templates/dns/o365.tpl
-fi
-
-# Back up and remove default index.html if it exists
-if [ -f /var/www/html/index.html ]; then
-	mv /var/www/html/index.html $HESTIA_BACKUP/templates/
-fi
-
-# Configure default success page and set permissions on CSS, JavaScript, and Font dependencies for unassigned hosts
-if [ ! -d /var/www/html ]; then
-	mkdir -p /var/www/html/
-fi
-
-if [ ! -d /var/www/document_errors/ ]; then
-	mkdir -p /var/www/document_errors/
-fi
-
-cp -rf $HESTIA_INSTALL_DIR/templates/web/unassigned/* /var/www/html/
-cp -rf $HESTIA_INSTALL_DIR/templates/web/skel/document_errors/* /var/www/document_errors/
-chmod 644 /var/www/html/*
-chmod 644 /var/www/document_errors/*
-
-for user in $($BIN/v-list-users plain | cut -f1); do
-	USER_DATA=$HESTIA/data/users/$user
-	for domain in $($BIN/v-list-web-domains $user plain | cut -f 1); do
-		WEBFOLDER="/home/$user/web/$domain/public_html"
-		folderchecksum=$(find "$WEBFOLDER/css" "$WEBFOLDER/js" "$WEBFOLDER/webfonts" -type f -print0 2> /dev/null | sort -z | xargs -r0 cat | md5sum | cut -d" " -f1)
-		if [ "$folderchecksum" = "926feacc51384fe13598631f9d1360c3" ]; then
-			rm -rf "$WEBFOLDER/css" "$WEBFOLDER/js" "$WEBFOLDER/webfonts"
-		fi
-		unset folderchecksum
-		unset WEBFOLDER
-	done
-done
-folderchecksum=$(find /var/www/html/css /var/www/html/js /var/www/html/webfonts -type f -print0 2> /dev/null | sort -z | xargs -r0 cat | md5sum | cut -d" " -f1)
-if [ "$folderchecksum" = "d148d5173e5e4162d7af0a60585392cb" ]; then
-	rm -rf /var/www/html/css /var/www/html/js /var/www/html/webfonts
-fi
-unset folderchecksum
-
-# Correct other permissions
-if [ -d "/var/cache/bind" ]; then
-	chown bind:bind /var/cache/bind
-fi
-if [ -d "/etc/roundcube" ]; then
-	chmod 640 /etc/roundcube/debian-db*
-	chown root:www-data /etc/roundcube/debian-db*
-fi
-
-# Add a general group for normal users created by Hestia
-echo "[ * ] Verifying ACLs and hardening user permissions..."
-if [ -z "$(grep ^hestia-users: /etc/group)" ]; then
-	groupadd --system "hestia-users"
-fi
-
-# Make sure non-admin users belong to correct Hestia group
-for user in $($BIN/v-list-users plain | cut -f1); do
-	if [ "$user" != "admin" ]; then
-		usermod -a -G "hestia-users" "$user"
-		setfacl -m "u:$user:r-x" "$HOMEDIR/$user"
-
-		# Update FTP users groups membership
-		uid=$(id -u $user)
-		for ftp_user in $(cat /etc/passwd | grep -v "^$user:" | grep "^$user.*:$uid:$uid:" | cut -d ":" -f1); do
-			usermod -a -G "hestia-users" "$ftp_user"
-		done
-	fi
-	setfacl -m "g:hestia-users:---" "$HOMEDIR/$user"
-done
-
-# Add unassigned hosts configuration to Nginx and Apache
-for ipaddr in $($BIN/v-list-sys-ips plain | cut -f1); do
-
-	web_conf="/etc/$WEB_SYSTEM/conf.d/$ipaddr.conf"
-	rm -f $web_conf
-
-	if [ "$WEB_SYSTEM" = "apache2" ]; then
-		echo "[ * ] Adding unassigned hosts configuration to Apache..."
-		if [ -z "$(/usr/sbin/apache2 -v | grep Apache/2.4)" ]; then
-			echo "NameVirtualHost $ipaddr:$WEB_PORT" > $web_conf
-		fi
-		echo "Listen $ipaddr:$WEB_PORT" >> $web_conf
-		cat $HESTIA_INSTALL_DIR/apache2/unassigned.conf >> $web_conf
-		sed -i 's/directIP/'$ipaddr'/g' $web_conf
-		sed -i 's/directPORT/'$WEB_PORT'/g' $web_conf
-
-		if [ "$WEB_SSL" = 'mod_ssl' ]; then
-			if [ -z "$(/usr/sbin/apache2 -v | grep Apache/2.4)" ]; then
-				sed -i "1s/^/NameVirtualHost $ipaddr:$WEB_SSL_PORT\n/" $web_conf
-			fi
-			sed -i "1s/^/Listen $ipaddr:$WEB_SSL_PORT\n/" $web_conf
-			sed -i 's/directSSLPORT/'$WEB_SSL_PORT'/g' $web_conf
-		fi
-
-	elif [ "$WEB_SYSTEM" = "nginx" ]; then
-		cp -f $HESTIA_INSTALL_DIR/nginx/unassigned.inc $web_conf
-		sed -i 's/directIP/'$ipaddr'/g' $web_conf
-	fi
-
-	if [ "$PROXY_SYSTEM" = "nginx" ]; then
-		echo "[ * ] Adding unassigned hosts configuration to Nginx..."
-		cat $WEBTPL/$PROXY_SYSTEM/proxy_ip.tpl \
-			| sed -e "s/%ip%/$ipaddr/g" \
-				-e "s/%web_port%/$WEB_PORT/g" \
-				-e "s/%proxy_port%/$PROXY_PORT/g" \
-				> /etc/$PROXY_SYSTEM/conf.d/$ipaddr.conf
-	fi
-done
-
-# Cleanup php session files not changed in the last 7 days (60*24*7 minutes)
-if [ ! -f /etc/cron.daily/php-session-cleanup ]; then
-	echo '#!/bin/sh' > /etc/cron.daily/php-session-cleanup
-	echo "find -O3 /home/*/tmp/ -ignore_readdir_race -depth -mindepth 1 -name 'sess_*' -type f -cmin '+10080' -delete > /dev/null 2>&1" >> /etc/cron.daily/php-session-cleanup
-	echo "find -O3 $HESTIA/data/sessions/ -ignore_readdir_race -depth -mindepth 1 -name 'sess_*' -type f -cmin '+10080' -delete > /dev/null 2>&1" >> /etc/cron.daily/php-session-cleanup
-fi
-chmod 755 /etc/cron.daily/php-session-cleanup
-
-# Fix empty pool error message for MultiPHP
-php_versions=$(ls /etc/php/*/fpm -d 2> /dev/null | wc -l)
-if [ "$php_versions" -gt 1 ]; then
-	echo "[ * ] Updating Multi-PHP configuration..."
-	for v in $($BIN/v-list-sys-php plain); do
-		if [ ! -d "/etc/php/$v/fpm/pool.d/" ]; then
-			continue
-		fi
-		cp -f $HESTIA_INSTALL_DIR/php-fpm/dummy.conf /etc/php/$v/fpm/pool.d/
-		v1=$(echo "$v" | sed -e 's/[.]//')
-		sed -i "s/9999/99$v1/g" /etc/php/$v/fpm/pool.d/dummy.conf
-	done
-fi
-
-# Set Purge to false in Roundcube configuration - https://goo.gl/3Nja3u
-echo "[ * ] Updating Roundcube configuration..."
-if [ -f /etc/roundcube/config.inc.php ]; then
-	sed -i "s/\['flag_for_deletion'] = 'Purge';/\['flag_for_deletion'] = false;/gI" /etc/roundcube/config.inc.php
-fi
-if [ -f /etc/roundcube/defaults.inc.php ]; then
-	sed -i "s/\['flag_for_deletion'] = 'Purge';/\['flag_for_deletion'] = false;/gI" /etc/roundcube/defaults.inc.php
-fi
-if [ -f /etc/roundcube/main.inc.php ]; then
-	sed -i "s/\['flag_for_deletion'] = 'Purge';/\['flag_for_deletion'] = false;/gI" /etc/roundcube/main.inc.php
-fi
-
-# Remove old OS-specific installation files if they exist to free up space
-if [ -d $HESTIA/install/ubuntu ]; then
-	echo "[ * ] Removing old HestiaCP installation files for Ubuntu..."
-	rm -rf $HESTIA/install/ubuntu
-fi
-if [ -d $HESTIA/install/debian ]; then
-	echo "[ * ] Removing old HestiaCP installation files for Debian..."
-	rm -rf $HESTIA/install/debian
-fi
-
-# Fix Dovecot configuration
-echo "[ * ] Updating Dovecot IMAP/POP server configuration..."
-if [ -f /etc/dovecot/conf.d/15-mailboxes.conf ]; then
-	mv /etc/dovecot/conf.d/15-mailboxes.conf $HESTIA_BACKUP/conf/
-fi
-if [ -f /etc/dovecot/dovecot.conf ]; then
-	# Update Dovecot configuration and restart Dovecot service
-	mv /etc/dovecot/dovecot.conf $HESTIA_BACKUP/conf/
-	cp -f $HESTIA_COMMON_DIR/dovecot/dovecot.conf /etc/dovecot/dovecot.conf
-	systemctl restart dovecot
-	sleep 0.5
-fi
-
-# Fix Exim configuration
-if [ -f /etc/exim4/exim4.conf.template ]; then
-	echo "[ * ] Updating Exim SMTP server configuration..."
-	mv /etc/exim4/exim4.conf.template $HESTIA_BACKUP/conf/
-	cp -f $HESTIA_INSTALL_DIR/exim/exim4.conf.template /etc/exim4/exim4.conf.template
-	# Reconfigure spam filter and virus scanning
-	if [ ! -z "$ANTISPAM_SYSTEM" ]; then
-		sed -i "s/#SPAM/SPAM/g" /etc/exim4/exim4.conf.template
-		sed -i "s/#SPAM_SCORE/SPAM_SCORE/g" /etc/exim4/exim4.conf.template
-	fi
-	if [ ! -z "$ANTIVIRUS_SYSTEM" ]; then
-		sed -i "s/#CLAMD/CLAMD/g" /etc/exim4/exim4.conf.template
-	fi
-fi
-
-# Add IMAP system variable to configuration if Dovecot is installed
-if [ -z "$IMAP_SYSTEM" ]; then
-	if [ -f /usr/bin/dovecot ]; then
-		echo "[ * ] Adding missing IMAP_SYSTEM variable to hestia.conf..."
-		echo "IMAP_SYSTEM = 'dovecot'" >> $HESTIA/conf/hestia.conf
-	fi
-fi
-
-# Run sftp jail once
-$HESTIA/bin/v-add-sys-sftp-jail
-
-# Enable SFTP subsystem for SSH
-sftp_subsys_enabled=$(grep -iE "^#?.*subsystem.+(sftp )?sftp-server" /etc/ssh/sshd_config)
-if [ ! -z "$sftp_subsys_enabled" ]; then
-	echo "[ * ] Updating SFTP subsystem configuration..."
-	sed -i -E "s/^#?.*Subsystem.+(sftp )?sftp-server/Subsystem sftp internal-sftp/g" /etc/ssh/sshd_config
-	systemctl restart ssh
-fi
-
-# Remove and migrate obsolete object keys
-for user in $($BIN/v-list-users plain | cut -f1); do
-	USER_DATA=$HESTIA/data/users/$user
-
-	# Web keys
-	for domain in $($BIN/v-list-web-domains $user plain | cut -f 1); do
-		obskey=$(get_object_value 'web' 'DOMAIN' "$domain" '$FORCESSL')
-		if [ ! -z "$obskey" ]; then
-			echo "[ * ] Fixing HTTP-to-HTTPS redirection for $domain"
-			update_object_value 'web' 'DOMAIN' "$domain" '$FORCESSL' ''
-
-			# copy value under new key name
-			add_object_key "web" 'DOMAIN' "$domain" 'SSL_FORCE' 'SSL_HOME'
-			update_object_value 'web' 'DOMAIN' "$domain" '$SSL_FORCE' "$obskey"
-		fi
-		unset FORCESSL
-	done
-	sed -i "s/\sFORCESSL=''//g" $USER_DATA/web.conf
-done
diff --git a/install/upgrade/versions/1.1.0.sh b/install/upgrade/versions/1.1.0.sh
deleted file mode 100644
index 2d31b91..0000000
--- a/install/upgrade/versions/1.1.0.sh
+++ /dev/null
@@ -1,224 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.1.0
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-
-# Set default theme
-if [ -z $THEME ]; then
-	echo "[ * ] Enabling support for themes..."
-	$BIN/v-change-sys-theme 'default'
-fi
-
-# Reduce SSH login grace time
-if [ -e /etc/ssh/sshd_config ]; then
-	echo "[ * ] Hardening SSH daemon configuration..."
-	sed -i "s/LoginGraceTime 2m/LoginGraceTime 1m/g" /etc/ssh/sshd_config
-	sed -i "s/#LoginGraceTime 2m/LoginGraceTime 1m/g" /etc/ssh/sshd_config
-fi
-
-# Implement recidive jail for fail2ban
-if [ ! -z "$FIREWALL_EXTENSION" ]; then
-	if ! cat /etc/fail2ban/jail.local | grep -q "\[recidive\]"; then
-		echo -e "\n\n[recidive]\nenabled  = true\nfilter   = recidive\naction   = hestia[name=HESTIA]\nlogpath  = /var/log/fail2ban.log\nmaxretry = 3\nfindtime = 86400\nbantime  = 864000" >> /etc/fail2ban/jail.local
-	fi
-fi
-
-# Enable OCSP SSL stapling and harden nginx configuration for roundcube
-if [ ! -z "$IMAP_SYSTEM" ]; then
-	echo "[ * ] Hardening security of Roundcube webmail..."
-	$BIN/v-update-mail-templates > /dev/null 2>&1
-	if [ -e /etc/nginx/conf.d/webmail.inc ]; then
-		cp -f /etc/nginx/conf.d/webmail.inc $HESTIA_BACKUP/conf/
-		sed -i "s/config|temp|logs/README.md|config|temp|logs|bin|SQL|INSTALL|LICENSE|CHANGELOG|UPGRADING/g" /etc/nginx/conf.d/webmail.inc
-	fi
-fi
-
-# Fix restart queue
-if [ -z "$($BIN/v-list-cron-jobs admin | grep 'v-update-sys-queue restart')" ]; then
-	command="sudo $BIN/v-update-sys-queue restart"
-	$BIN/v-add-cron-job 'admin' '*/2' '*' '*' '*' '*' "$command"
-fi
-
-# Remove deprecated line from ClamAV configuration file
-if [ -e "/etc/clamav/clamd.conf" ]; then
-	clamd_conf_update_check=$(grep DetectBrokenExecutables /etc/clamav/clamd.conf)
-	if [ ! -z "$clamd_conf_update_check" ]; then
-		echo "[ * ] Updating ClamAV configuration..."
-		sed -i '/DetectBrokenExecutables/d' /etc/clamav/clamd.conf
-	fi
-fi
-
-# Remove errornous history.log file created by certain builds due to bug in v-restart-system
-if [ -e $HESTIA/data/users/history.log ]; then
-	rm -f $HESTIA/data/users/history.log
-fi
-
-# Use exim4 server hostname instead of mail domain and remove hardcoded mail prefix
-if [ ! -z "$MAIL_SYSTEM" ]; then
-	echo "[ * ] Updating exim configuration..."
-	if cat /etc/exim4/exim4.conf.template | grep -q 'helo_data = mail.${sender_address_domain}'; then
-		sed -i 's/helo_data = mail.${sender_address_domain}/helo_data = ${primary_hostname}/g' /etc/exim4/exim4.conf.template
-	fi
-	if ! grep -q '^OUTGOING_IP = /' /etc/exim4/exim4.conf.template; then
-		sed -i '/^OUTGOING_IP/d' /etc/exim4/exim4.conf.template
-		sed -i 's|^begin acl|OUTGOING_IP = /etc/exim4/domains/$sender_address_domain/ip\nbegin acl|' /etc/exim4/exim4.conf.template
-	fi
-	if ! grep -q 'interface =' /etc/exim4/exim4.conf.template; then
-		sed -i '/interface =/d' /etc/exim4/exim4.conf.template
-		sed -i 's|dkim_strict = 0|dkim_strict = 0\n  interface = ${if exists{OUTGOING_IP}{${readfile{OUTGOING_IP}}}}|' /etc/exim4/exim4.conf.template
-	fi
-fi
-
-# Members of admin group should be permitted to enter admin folder
-if [ -d /home/admin ]; then
-	setfacl -m "g:admin:r-x" /home/admin
-fi
-
-# Fix sftp jail cronjob
-if [ -e "/etc/cron.d/hestia-sftp" ]; then
-	if ! cat /etc/cron.d/hestia-sftp | grep -q 'root'; then
-		echo "@reboot root /usr/local/hestia/bin/v-add-sys-sftp-jail" > /etc/cron.d/hestia-sftp
-	fi
-fi
-
-# Create default writeable folders for all users
-echo "[ * ] Updating default writable folders for all users..."
-for user in $($HESTIA/bin/v-list-sys-users plain); do
-	mkdir -p \
-		$HOMEDIR/$user/.cache \
-		$HOMEDIR/$user/.config \
-		$HOMEDIR/$user/.local \
-		$HOMEDIR/$user/.composer \
-		$HOMEDIR/$user/.ssh
-
-	chown $user:$user \
-		$HOMEDIR/$user/.cache \
-		$HOMEDIR/$user/.config \
-		$HOMEDIR/$user/.local \
-		$HOMEDIR/$user/.composer \
-		$HOMEDIR/$user/.ssh
-done
-
-# Remove redundant fail2ban jail
-if fail2ban-client status sshd > /dev/null 2>&1; then
-	fail2ban-client stop sshd > /dev/null 2>&1
-	if [ -f /etc/fail2ban/jail.d/defaults-debian.conf ]; then
-		mkdir -p $HESTIA_BACKUP/conf/fail2ban/jail.d
-		mv /etc/fail2ban/jail.d/defaults-debian.conf $HESTIA_BACKUP/conf/fail2ban/jail.d/
-	fi
-fi
-
-# Update Office 365/Microsoft 365 DNS template
-if [ -e "$HESTIA/data/templates/dns/office365.tpl" ]; then
-	echo "[ * ] Updating DNS template for Office 365..."
-	cp -f $HESTIA/install/deb/templates/dns/office365.tpl $HESTIA/data/templates/dns/office365.tpl
-fi
-
-# Ensure that backup compression level is correctly set
-GZIP_LVL_CHECK=$(cat $HESTIA/conf/hestia.conf | grep BACKUP_GZIP)
-if [ -z "$GZIP_LVL_CHECK" ]; then
-	echo "[ * ] Updating backup compression level variable..."
-	$BIN/v-change-sys-config-value "BACKUP_GZIP" '9'
-fi
-
-# Randomize Roundcube des_key for better security
-if [ -f "/etc/roundcube/config.inc.php" ]; then
-	rcDesKey="$(openssl rand -base64 30 | tr -d "/" | cut -c1-24)"
-	sed -i "s/vtIOjLZo9kffJoqzpSbm5r1r/$rcDesKey/g" /etc/roundcube/config.inc.php
-fi
-
-# Place robots.txt to prevent webmail crawling by search engine bots.
-if [ -e "/var/lib/roundcube/" ]; then
-	if [ ! -f "/var/lib/roundcube/robots.txt" ]; then
-		echo "User-agent: *" > /var/lib/roundcube/robots.txt
-		echo "Disallow: /" >> /var/lib/roundcube/robots.txt
-	fi
-fi
-
-# Installing postgresql repo
-if [ -e "/etc/postgresql" ]; then
-	echo "[ * ] Enabling native PostgreSQL APT repository..."
-	osname="$(cat /etc/os-release | grep "^ID\=" | sed "s/ID\=//g")"
-	if [ "$osname" = "ubuntu" ]; then
-		codename="$(lsb_release -s -c)"
-	else
-		codename="$(cat /etc/os-release | grep VERSION= | cut -f 2 -d \( | cut -f 1 -d \))"
-	fi
-	echo "deb http://apt.postgresql.org/pub/repos/apt/ $codename-pgdg main" > /etc/apt/sources.list.d/postgresql.list
-	wget --quiet https://www.postgresql.org/media/keys/ACCC4CF8.asc -O /tmp/psql_signing.key
-	APT_KEY_DONT_WARN_ON_DANGEROUS_USAGE=1 apt-key add /tmp/psql_signing.key > /dev/null 2>&1
-	rm /tmp/psql_signing.key
-fi
-
-# Hardening MySQL configuration, prevent local infile.
-if [ -e "/etc/mysql/my.cnf" ]; then
-	mysql_local_infile_check=$(grep local-infile /etc/mysql/my.cnf)
-	if [ -z "$mysql_local_infile_check" ]; then
-		echo "[ * ] Hardening MySQL configuration..."
-		sed -i '/symbolic-links\=0/a\local-infile=0' /etc/mysql/my.cnf
-	fi
-fi
-
-# Hardening nginx configuration, drop TLSv1.1 support.
-if [ -e "/etc/nginx/nginx.conf" ]; then
-	nginx_tls_check=$(grep TLSv1.1 /etc/nginx/nginx.conf)
-	if [ ! -z "$nginx_tls_check" ]; then
-		echo "[ * ] Updating nginx security settings - disabling TLS v1.1..."
-		sed -i 's/TLSv1.1 //g' /etc/nginx/nginx.conf
-	fi
-fi
-
-# Fix logrotate permission bug for nginx
-if [ -e "/etc/logrotate/nginx" ]; then
-	sed -i "s/create 640 nginx adm/create 640/g" /etc/logrotate.d/nginx
-fi
-
-# Fix logrotate permission bug for apache
-if [ -e "/etc/logrotate/apache2" ]; then
-	sed -i "s/create 640 root adm/create 640/g" /etc/logrotate.d/apache2
-fi
-
-# Repair messed up user log permissions from the logrotate bug. Ignoring errors
-for user in $($HESTIA/bin/v-list-users plain | cut -f1); do
-	for domain in $($HESTIA/bin/v-list-web-domains $user plain | cut -f1); do
-		chown root:$user /var/log/$WEB_SYSTEM/domains/$domain.* > /dev/null 2>&1
-		for sub_domain in $($HESTIA/bin/v-list-web-domain $user $domain plain | cut -f7 | tr ',' '\n'); do
-			chown root:$user /var/log/$WEB_SYSTEM/domains/$sub_domain.* > /dev/null 2>&1
-		done
-	done
-done
-
-chown root:root /var/log/$WEB_SYSTEM/domains/$WEBMAIL_ALIAS* > /dev/null 2>&1
-
-# Enable IMAP/POP3 quota information
-if [ "$IMAP_SYSTEM" = "dovecot" ]; then
-	echo "[ * ] Enabling IMAP quota information reporting..."
-	if [ -e /etc/dovecot/conf.d/20-pop3.conf ]; then
-		cp -f $HESTIA/install/deb/dovecot/conf.d/20-pop3.conf /etc/dovecot/conf.d/20-pop3.conf
-	fi
-	if [ -e /etc/dovecot/conf.d/20-imap.conf ]; then
-		cp -f $HESTIA/install/deb/dovecot/conf.d/20-imap.conf /etc/dovecot/conf.d/20-imap.conf
-	fi
-	if [ -e /etc/dovecot/conf.d/90-quota.conf ]; then
-		cp -f $HESTIA/install/deb/dovecot/conf.d/90-quota.conf /etc/dovecot/conf.d/90-quota.conf
-	fi
-fi
-
-# Trigger multiphp legacy migration script
-num_php_versions=$(ls -d /etc/php/*/fpm/pool.d 2> /dev/null | wc -l)
-if [ "$num_php_versions" -gt 1 ] && [ -z "$WEB_BACKEND" ]; then
-	echo "[ * ] Enabling modular Multi-PHP backend..."
-	cp -rf $HESTIA/data/templates/web $HESTIA_BACKUP/templates/web
-	bash $HESTIA/install/upgrade/manual/migrate_multiphp.sh > /dev/null 2>&1
-fi
-
-# Disable global subfolder alias for webmail in favor of subdomain
-if [ -e /etc/nginx/conf.d/webmail.inc ]; then
-	rm -f /etc/nginx/conf.d/webmail.inc
-fi
-if [ -e /etc/apache2/conf.d/roundcube.conf ]; then
-	rm -f /etc/apache2/conf.d/roundcube.conf
-fi
diff --git a/install/upgrade/versions/1.1.1.sh b/install/upgrade/versions/1.1.1.sh
deleted file mode 100644
index 6205cd4..0000000
--- a/install/upgrade/versions/1.1.1.sh
+++ /dev/null
@@ -1,20 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.1.1
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-
-# Remove 5s delay when sending mail through exim4
-if [ -e "/etc/exim4/exim4.conf.template" ]; then
-	echo "[ * ] Updating exim4 configuration..."
-	sed -i "s|rfc1413_query_timeout = 5s|rfc1413_query_timeout = 0s|g" /etc/exim4/exim4.conf.template
-fi
-
-# Fix phpMyAdmin blowfish and tmp directory issues
-if [ -e "/usr/share/phpmyadmin/libraries/vendor_config.php" ]; then
-	echo "[ * ] Updating phpMyAdmin configuration..."
-	sed -i "s|define('CONFIG_DIR', ROOT_PATH);|define('CONFIG_DIR', '/etc/phpmyadmin/');|" /usr/share/phpmyadmin/libraries/vendor_config.php
-	sed -i "s|define('TEMP_DIR', ROOT_PATH . 'tmp/');|define('TEMP_DIR', '/var/lib/phpmyadmin/tmp/');|" /usr/share/phpmyadmin/libraries/vendor_config.php
-fi
diff --git a/install/upgrade/versions/1.2.0.sh b/install/upgrade/versions/1.2.0.sh
deleted file mode 100644
index 89beea5..0000000
--- a/install/upgrade/versions/1.2.0.sh
+++ /dev/null
@@ -1,219 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.2.0
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-
-# Check iptables paths and add symlinks when necessary
-
-if [ ! -e "/sbin/iptables" ]; then
-	if which iptables; then
-		ln -s "$(which iptables)" /sbin/iptables
-	elif [ -e "/usr/sbin/iptables" ]; then
-		ln -s /usr/sbin/iptables /sbin/iptables
-	elif whereis -B /bin /sbin /usr/bin /usr/sbin -f -b iptables; then
-		autoiptables=$(whereis -B /bin /sbin /usr/bin /usr/sbin -f -b iptables | cut -d '' -f 2)
-		if [ -x "$autoiptables" ]; then
-			ln -s "$autoiptables" /sbin/iptables
-		fi
-	fi
-fi
-
-if [ ! -e "/sbin/iptables-save" ]; then
-	if which iptables-save; then
-		ln -s "$(which iptables-save)" /sbin/iptables-save
-	elif [ -e "/usr/sbin/iptables-save" ]; then
-		ln -s /usr/sbin/iptables-save /sbin/iptables-save
-	elif whereis -B /bin /sbin /usr/bin /usr/sbin -f -b iptables-save; then
-		autoiptables_save=$(whereis -B /bin /sbin /usr/bin /usr/sbin -f -b iptables-save | cut -d '' -f 2)
-		if [ -x "$autoiptables_save" ]; then
-			ln -s "$autoiptables_save" /sbin/iptables-save
-		fi
-	fi
-fi
-
-if [ ! -e "/sbin/iptables-restore" ]; then
-	if which iptables-restore; then
-		ln -s "$(which iptables-restore)" /sbin/iptables-restore
-	elif [ -e "/usr/sbin/iptables-restore" ]; then
-		ln -s /usr/sbin/iptables-restore /sbin/iptables-restore
-	elif whereis -B /bin /sbin /usr/bin /usr/sbin -f -b iptables-restore; then
-		autoiptables_restore=$(whereis -B /bin /sbin /usr/bin /usr/sbin -f -b iptables-restore | cut -d '' -f 2)
-		if [ -x "$autoiptables_restore" ]; then
-			ln -s "$autoiptables_restore" /sbin/iptables-restore
-		fi
-	fi
-fi
-
-if [ -e "/etc/apache2/mods-enabled/status.conf" ]; then
-	sed -i '/Allow from all/d' /etc/apache2/mods-enabled/status.conf
-fi
-
-# Add sury apache2 repository
-if [ "$WEB_SYSTEM" = "apache2" ] && [ ! -e "/etc/apt/sources.list.d/apache2.list" ]; then
-	echo "[ * ] Configuring sury.org Apache2 repository..."
-
-	# Check OS and install related repository
-	if [ -e "/etc/os-release" ]; then
-		type=$(grep "^ID=" /etc/os-release | cut -f 2 -d '=')
-		if [ "$type" = "ubuntu" ]; then
-			codename="$(lsb_release -s -c)"
-			echo "deb http://ppa.launchpad.net/ondrej/apache2/ubuntu $codename main" > /etc/apt/sources.list.d/apache2.list
-		elif [ "$type" = "debian" ]; then
-			codename="$(cat /etc/os-release | grep VERSION= | cut -f 2 -d \( | cut -f 1 -d \))"
-			echo "deb https://packages.sury.org/apache2/ $codename main" > /etc/apt/sources.list.d/apache2.list
-			wget --quiet https://packages.sury.org/apache2/apt.gpg -O /tmp/apache2_signing.key
-			APT_KEY_DONT_WARN_ON_DANGEROUS_USAGE=1 apt-key add /tmp/apache2_signing.key > /dev/null 2>&1
-		fi
-	fi
-fi
-
-# Roundcube fixes for PHP 7.4 compatibility
-if [ -d /usr/share/roundcube ]; then
-	echo "[ * ] Updating Roundcube configuration..."
-	[ -f "/usr/share/roundcube/plugins/enigma/lib/enigma_ui.php" ] && sed -i 's/$identities, "\\n"/"\\n", $identities/g' /usr/share/roundcube/plugins/enigma/lib/enigma_ui.php
-	[ -f "/usr/share/roundcube/program/lib/Roundcube/rcube_contacts.php" ] && sed -i 's/(array_keys($post_search), \x27|\x27)/(\x27|\x27, array_keys($post_search))/g' /usr/share/roundcube/program/lib/Roundcube/rcube_contacts.php
-	[ -f "/usr/share/roundcube/program/lib/Roundcube/rcube_db.php" ] && sed -i 's/implode($name, \x27.\x27)/implode(\x27.\x27, $name)/g' /usr/share/roundcube/program/lib/Roundcube/rcube_db.php
-	[ -f "/usr/share/roundcube/program/steps/addressbook/search.inc" ] && sed -i 's/$fields, \x27,\x27/\x27,\x27, $fields/g' /usr/share/roundcube/program/steps/addressbook/search.inc
-	[ -f "/usr/share/roundcube/program/steps/addressbook/search.inc" ] && sed -i 's/implode($fields, \x27,\x27)/implode(\x27,\x27, $fields)/g' /usr/share/roundcube/program/steps/addressbook/search.inc
-	[ -f "/usr/share/roundcube/program/steps/mail/sendmail.inc" ] && sed -i 's/implode($bstyle, \x27; \x27)/implode(\x27; \x27, $bstyle)/g' /usr/share/roundcube/program/steps/mail/sendmail.inc
-fi
-
-# Enable Roundcube plugins
-if [ -d /usr/share/roundcube ]; then
-	cp -f $HESTIA_INSTALL_DIR/roundcube/plugins/config_newmail_notifier.inc.php /etc/roundcube/plugins/newmail_notifier/config.inc.php
-	cp -f $HESTIA_INSTALL_DIR/roundcube/plugins/config_zipdownload.inc.php /etc/roundcube/plugins/zipdownload/config.inc.php
-	[ -f "/etc/roundcube/config.inc.php" ] && sed -i "s/array('password')/array('password','newmail_notifier','zipdownload')/g" /etc/roundcube/config.inc.php
-fi
-
-# HELO support for multiple domains and IPs
-if [ -e "/etc/exim4/exim4.conf.template" ]; then
-	echo "[ * ] Updating exim4 configuration..."
-	sed -i 's|helo_data = ${primary_hostname}|helo_data = ${if exists {\/etc\/exim4\/mailhelo.conf}{${lookup{$sender_address_domain}lsearch*{\/etc\/exim4\/mailhelo.conf}{$value}{$primary_hostname}}}{$primary_hostname}}|g' /etc/exim4/exim4.conf.template
-fi
-
-# Add daily midnight cron
-if [ -z "$($BIN/v-list-cron-jobs admin | grep 'v-update-sys-queue daily')" ]; then
-	echo "[ * ] Updating cron jobs..."
-	command="sudo $BIN/v-update-sys-queue daily"
-	$BIN/v-add-cron-job 'admin' '01' '00' '*' '*' '*' "$command"
-fi
-[ ! -f "touch $HESTIA/data/queue/daily.pipe" ] && touch $HESTIA/data/queue/daily.pipe
-
-# Remove existing network-up hooks so they get regenerated when updating the firewall
-# - network hook will also restore ipset config during start-up
-if [ -f "/usr/lib/networkd-dispatcher/routable.d/50-ifup-hooks" ]; then
-	rm "/usr/lib/networkd-dispatcher/routable.d/50-ifup-hooks"
-	$BIN/v-update-firewall
-fi
-if [ -f "/etc/network/if-pre-up.d/iptables" ]; then
-	rm "/etc/network/if-pre-up.d/iptables"
-	$BIN/v-update-firewall
-fi
-
-# Add hestia-event.conf, if the server is running apache2
-if [ "$WEB_SYSTEM" = "apache2" ]; then
-	echo "[ * ] Updating Apache2 configuration..."
-	# Cleanup
-	rm --force /etc/apache2/mods-available/hestia-event.conf
-	rm --force /etc/apache2/mods-enabled/hestia-event.conf
-	rm --force /etc/apache2/conf-available/hestia-event.conf
-	rm --force /etc/apache2/conf-enabled/hestia-event.conf
-
-	if [ $(a2query -M) = 'event' ] && [ ! -e "/etc/apache2/conf.d/hestia-event.conf" ]; then
-		cp -f $HESTIA_INSTALL_DIR/apache2/hestia-event.conf /etc/apache2/conf.d/
-	fi
-
-	# Move apache mod_status config to /mods-available and rename it to prevent losing changes on upgrade
-	cp -f $HESTIA_INSTALL_DIR/apache2/status.conf /etc/apache2/mods-available/hestia-status.conf
-	cp -f /etc/apache2/mods-available/status.load /etc/apache2/mods-available/hestia-status.load
-	a2dismod --quiet status > /dev/null 2>&1
-	a2enmod --quiet hestia-status > /dev/null 2>&1
-	rm --force /etc/apache2/mods-enabled/status.conf # a2dismod will not remove the file if it isn't a symlink
-fi
-
-# Install File Manager during upgrade if environment variable oesn't already exist and isn't set to false
-# so that we don't override preference
-FILE_MANAGER_CHECK=$(cat $HESTIA/conf/hestia.conf | grep "FILE_MANAGER='false'")
-if [ -z "$FILE_MANAGER_CHECK" ]; then
-	if [ ! -e "$HESTIA/web/fm/configuration.php" ]; then
-		echo "[ ! ] Installing File Manager..."
-		# Install the File Manager
-		$HESTIA/bin/v-add-sys-filemanager quiet
-	else
-		echo "[ * ] Updating File Manager configuration..."
-		# Update configuration.php
-		cp -f $HESTIA_INSTALL_DIR/filemanager/filegator/configuration.php $HESTIA/web/fm/configuration.php
-		# Set environment variable for interface
-		$HESTIA/bin/v-change-sys-config-value 'FILE_MANAGER' 'true'
-	fi
-fi
-
-# Enable nginx module loading
-if [ -f "/etc/nginx/nginx.conf" ]; then
-	echo "[ * ] Updating NGINX configuration..."
-	if [ ! -d "/etc/nginx/modules-enabled" ]; then
-		mkdir -p "/etc/nginx/modules-enabled"
-	fi
-
-	if ! grep --silent "include /etc/nginx/modules-enabled" /etc/nginx/nginx.conf; then
-		sed -i '/^pid/ a include /etc/nginx/modules-enabled/*.conf;' /etc/nginx/nginx.conf
-	fi
-fi
-
-# Fix public_(s)html group ownership
-echo "[ * ] Updating public_(s)html ownership..."
-for user in $($HESTIA/bin/v-list-sys-users plain); do
-	# skip users with missing home folder
-	[[ -d /home/${user}/ ]] || continue
-
-	# skip users without web domains
-	ls /home/${user}/web/*/public_*html > /dev/null 2>&1 || continue
-
-	chown --silent --no-dereference :www-data /home/$user/web/*/public_*html
-done
-
-# Fix phpMyAdmin blowfish_secret error message due to incorrect permissions
-if [ -e /var/lib/phpmyadmin/blowfish_secret.inc.php ]; then
-	echo "[ * ] Updating phpMyAdmin permissions..."
-	chmod 0644 /var/lib/phpmyadmin/blowfish_secret.inc.php
-fi
-
-# Ensure that backup compression level is correctly set
-GZIP_LVL_CHECK=$(cat $HESTIA/conf/hestia.conf | grep BACKUP_GZIP)
-if [ -z "$GZIP_LVL_CHECK" ]; then
-	echo "[ * ] Updating backup compression level variable..."
-	$BIN/v-change-sys-config-value "BACKUP_GZIP" '9'
-fi
-
-# Update phpMyAdmin/phpPgAdmin templates and set missing alias variables if necessary
-if [ -e "/var/lib/phpmyadmin" ]; then
-	PMA_ALIAS_CHECK=$(cat $HESTIA/conf/hestia.conf | grep DB_PMA_ALIAS)
-	if [ -z "$PMA_ALIAS_CHECK" ]; then
-		echo "[ * ] Updating phpMyAdmin alias..."
-		$HESTIA/bin/v-change-sys-db-alias "pma" "phpMyAdmin"
-	else
-		echo "[ * ] Updating phpMyAdmin configuration..."
-		$HESTIA/bin/v-change-sys-db-alias "pma" "$DB_PMA_ALIAS"
-	fi
-fi
-
-if [ -e "/var/lib/phppgadmin" ]; then
-	PGA_ALIAS_CHECK=$(cat $HESTIA/conf/hestia.conf | grep DB_PGA_ALIAS)
-	if [ -z "$PGA_ALIAS_CHECK" ]; then
-		echo "[ * ] Updating phpPgAdmin alias..."
-		$HESTIA/bin/v-change-sys-db-alias "pga" "phpPgAdmin"
-	else
-		echo "[ * ] Updating phpPgAdmin configuration..."
-		$HESTIA/bin/v-change-sys-db-alias "pga" "$DB_PGA_ALIAS"
-	fi
-fi
-
-# Ensure that backup compression level is correctly set
-GZIP_LVL_CHECK=$(cat $HESTIA/conf/hestia.conf | grep BACKUP_GZIP)
-if [ -z "$GZIP_LVL_CHECK" ]; then
-	echo "[ * ] Updating backup compression level variable..."
-	$BIN/v-change-sys-config-value "BACKUP_GZIP" '9'
-fi
diff --git a/install/upgrade/versions/1.2.1.sh b/install/upgrade/versions/1.2.1.sh
deleted file mode 100644
index 45c057b..0000000
--- a/install/upgrade/versions/1.2.1.sh
+++ /dev/null
@@ -1,7 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.2.1
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
diff --git a/install/upgrade/versions/1.2.2.sh b/install/upgrade/versions/1.2.2.sh
deleted file mode 100644
index eb326bc..0000000
--- a/install/upgrade/versions/1.2.2.sh
+++ /dev/null
@@ -1,48 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.2.2
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-
-# Enhance Vsftpd security
-if [ "$FTP_SYSTEM" = "vsftpd" ]; then
-	echo "[ ! ] Hardening Vsftpd TLS configuration..."
-	if [ -e /etc/vsftpd.conf ]; then
-		rm -f /etc/vsftpd.conf
-	fi
-	cp -f $HESTIA_INSTALL_DIR/vsftpd/vsftpd.conf /etc/
-	chmod 644 /etc/vsftpd.conf
-fi
-
-# Rework apt repositories
-apt="/etc/apt/sources.list.d"
-echo "[ * ] Hardening APT repositories..."
-if [ -f "$apt/nginx.list" ]; then
-	if grep -q "http://nginx.org/packages/mainline/" $apt/nginx.list; then
-		echo "  ----- NGINX"
-		sed -i "s/http\:\/\/nginx.org/https\:\/\/nginx.org/g" $apt/nginx.list
-	fi
-fi
-
-if [ -f "$apt/php.list" ]; then
-	if grep -q "http://packages.sury.org/" $apt/php.list; then
-		echo "  ----- PHP"
-		sed -i "s/http\:\/\/packages.sury.org/https\:\/\/packages.sury.org/g" $apt/php.list
-	fi
-fi
-
-if [ -f "$apt/mariadb.list" ]; then
-	if grep -q "http://ams2.mirrors.digitalocean.com" $apt/mariadb.list; then
-		echo "  ----- MariaDB"
-		sed -i "s/http\:\/\/ams2.mirrors.digitalocean.com/https\:\/\/mirror.mva-n.net/g" $apt/mariadb.list
-	fi
-fi
-
-if [ -f "$apt/postgresql.list" ]; then
-	if grep -q "http://apt.postgresql.org" $apt/postgresql.list; then
-		echo "  ----- PostgreSQL"
-		sed -i "s/http\:\/\/apt.postgresql.org/https\:\/\/apt.postgresql.org/g" $apt/postgresql.list
-	fi
-fi
diff --git a/install/upgrade/versions/1.2.3.sh b/install/upgrade/versions/1.2.3.sh
deleted file mode 100644
index 1a6b4c7..0000000
--- a/install/upgrade/versions/1.2.3.sh
+++ /dev/null
@@ -1,7 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.2.3
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
diff --git a/install/upgrade/versions/1.3.0.sh b/install/upgrade/versions/1.3.0.sh
deleted file mode 100644
index 4da1a4a..0000000
--- a/install/upgrade/versions/1.3.0.sh
+++ /dev/null
@@ -1,76 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.3.0
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-
-# Add NPM to the default writeable folder list
-echo "[ * ] Updating default writable folders for all users..."
-for user in $($HESTIA/bin/v-list-sys-users plain); do
-	mkdir -p \
-		$HOMEDIR/$user/.npm
-
-	chown $user:$user \
-		$HOMEDIR/$user/.npm
-done
-
-# Add default SSL Certificate config when ip is visited
-if [ "$PROXY_SYSTEM" = "nginx" ]; then
-	echo "[ * ] Updating nginx configuration..."
-	while read IP; do
-		rm /etc/nginx/conf.d/$IP.conf
-		cat $WEBTPL/$PROXY_SYSTEM/proxy_ip.tpl \
-			| sed -e "s/%ip%/$IP/g" \
-				-e "s/%web_port%/$WEB_PORT/g" \
-				-e "s/%proxy_port%/$PROXY_PORT/g" \
-				-e "s/%proxy_ssl_port%/$PROXY_SSL_PORT/g" \
-				> /etc/$PROXY_SYSTEM/conf.d/$IP.conf
-	done < <(ls $HESTIA/data/ips/)
-fi
-
-if [ "$FTP_SYSTEM" == "proftpd" ]; then
-	echo "[ * ] Updating ProFTPd TLS configuration..."
-	if [ -e /etc/proftpd/proftpd.conf ]; then
-		rm /etc/proftpd/proftpd.conf
-	fi
-	if [ -e /etc/proftpd/tls.conf ]; then
-		rm /etc/proftpd/tls.conf
-	fi
-
-	cp -f $HESTIA_INSTALL_DIR/proftpd/proftpd.conf /etc/proftpd/
-	cp -f $HESTIA_INSTALL_DIR/proftpd/tls.conf /etc/proftpd/
-
-fi
-
-# Update exim configuration
-if [ -e "/etc/exim4/exim4.conf.template" ]; then
-	echo "[ * ] Updating exim4 configuration..."
-	sed -i 's/${if match {${lc:$mime_filename}}{\\N(\\.ade|\\.adp|\\.bat|\\.chm|\\.cmd|\\.com|\\.cpl|\\.exe|\\.hta|\\.ins|\\.isp|\\.jse|\\.lib|\\.lnk|\\.mde|\\.msc|\\.msp|\\.mst|\\.pif|\\.scr|\\.sct|\\.shb|\\.sys|\\.vb|\\.vbe|\\.vbs|\\.vxd|\\.wsc|\\.wsf|\\.wsh)$\\N}{1}{0}}/${if match {${lc:$mime_filename}}{\\N(\\.ace|\\.ade|\\.adp|\\.app|\\.arj|\\.asp|\\.aspx|\\.asx|\\.bas|\\.bat|\\.cab|\\.cer|\\.chm|\\.cmd|\\.cnt|\\.com|\\.cpl|\\.crt|\\.csh|\\.der|\\.diagcab|\\.dll|\\.efi|\\.exe|\\.fla|\\.fon|\\.fxp|\\.gadget|\\.grp|\\.hlp|\\.hpj|\\.hta|\\.htc|\\.img|\\.inf|\\.ins|\\.iso|\\.isp|\\.its|\\.jar|\\.jnlp|\\.js|\\.jse|\\.ksh|\\.lib|\\.lnk|\\.mad|\\.maf|\\.mag|\\.mam|\\.maq|\\.mar|\\.mas|\\.mat|\\.mau|\\.mav|\\.maw|\\.mcf|\\.mda|\\.mdb|\\.mde|\\.mdt|\\.mdw|\\.mdz|\\.msc|\\.msh|\\.msh1|\\.msh1xml|\\.msh2|\\.msh2xml|\\.mshxml|\\.msi|\\.msp|\\.mst|\\.msu|\\.ops|\\.osd|\\.pcd|\\.pif|\\.pl|\\.plg|\\.prf|\\.prg|\\.printerexport|\\.ps1|\\.ps1xml|\\.ps2|\\.ps2xml|\\.psc1|\\.psc2|\\.psd1|\\.psdm1|\\.pst|\\.py|\\.pyc|\\.pyo|\\.pyw|\\.pyz|\\.pyzw|\\.reg|\\.scf|\\.scr|\\.sct|\\.sfx|\\.shb|\\.shs|\\.swf|\\.sys|\\.theme|\\.tmp|\\.ttf|\\.url|\\.vb|\\.vba|\\.vbe|\\.vbp|\\.vbs|\\.vhd|\\.vhdx|\\.vsmacros|\\.vsw|\\.vxd|\\.webpnp|\\.website|\\.wim|\\.ws|\\.wsc|\\.wsf|\\.wsh|\\.xbap|\\.xll|\\.xnk)$\\N}{1}{0}}/g' /etc/exim4/exim4.conf.template
-fi
-
-# Restrict access to /proc fs
-if [ ! -e "/etc/cron.d/hestia-proc" ]; then
-	echo "[ * ] Restricting access to /proc fs..."
-	mount -o remount,defaults,hidepid=2 /proc > /dev/null 2>&1
-	if [ $? -ne 0 ]; then
-		echo "[ ! ] WARNING: Cannot remount /proc (LXC containers require additional permissions be added to host apparmor profile)"
-	else
-		echo "@reboot root sleep 5 && mount -o remount,defaults,hidepid=2 /proc" > /etc/cron.d/hestia-proc
-	fi
-fi
-
-# Change backup mode to zstd.
-echo "[ * ] Setting zstd backup compression type as default..."
-$BIN/v-change-sys-config-value "BACKUP_MODE" "zstd"
-
-# Set LOGIN_STYLE variable in hestia.conf
-echo "[ * ] Updating configuration file: hestia.conf..."
-$BIN/v-change-sys-config-value "LOGIN_STYLE" "default"
-
-# Remove old lanugage files.
-if [ -e $HESTIA/web/inc/i18n/en.php ]; then
-	echo "[ * ] Performing language library clean-up..."
-	rm -fr $HESTIA/web/inc/i18n
-fi
diff --git a/install/upgrade/versions/1.3.1.sh b/install/upgrade/versions/1.3.1.sh
deleted file mode 100644
index 9271b64..0000000
--- a/install/upgrade/versions/1.3.1.sh
+++ /dev/null
@@ -1,21 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.3.1
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-
-# Remove duplicate values in U_SYS_USERS variable for ips
-for ip in $($BIN/v-list-sys-ips plain | cut -f1); do
-	current_usr=$(grep "U_SYS_USERS=" $HESTIA/data/ips/$ip | cut -f 2 -d \')
-
-	new_usr=$(echo "$current_usr" \
-		| sed "s/,/\n/g" \
-		| sort -u \
-		| sed ':a;N;$!ba;s/\n/,/g')
-
-	if [ -n "$new_usr" ]; then
-		sed -i "s/U_SYS_USERS='$current_usr'/U_SYS_USERS='$new_usr'/g" $HESTIA/data/ips/$ip
-	fi
-done
diff --git a/install/upgrade/versions/1.3.2.sh b/install/upgrade/versions/1.3.2.sh
deleted file mode 100644
index 04e0324..0000000
--- a/install/upgrade/versions/1.3.2.sh
+++ /dev/null
@@ -1,7 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.3.2
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
diff --git a/install/upgrade/versions/1.3.3.sh b/install/upgrade/versions/1.3.3.sh
deleted file mode 100644
index a8c86ab..0000000
--- a/install/upgrade/versions/1.3.3.sh
+++ /dev/null
@@ -1,21 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.3.3
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-
-# Check if keys folder exists and adjust permissions
-if [ -d "$HESTIA/data/keys" ]; then
-	echo '[ * ] Update permissions'
-	chmod 750 "$HESTIA/data/keys"
-	chown admin:root "$HESTIA/data/keys"
-fi
-
-if [[ ! -e /etc/hestiacp/hestia.conf ]]; then
-	echo '[ * ] Create global Hestia config'
-
-	mkdir -p /etc/hestiacp
-	echo -e "# Do not edit this file, will get overwritten on next upgrade, use /etc/hestiacp/local.conf instead\n\nexport HESTIA='/usr/local/hestia'\n\n[[ -f /etc/hestiacp/local.conf ]] && source /etc/hestiacp/local.conf" > /etc/hestiacp/hestia.conf
-fi
diff --git a/install/upgrade/versions/1.3.4.sh b/install/upgrade/versions/1.3.4.sh
deleted file mode 100644
index 55fbd70..0000000
--- a/install/upgrade/versions/1.3.4.sh
+++ /dev/null
@@ -1,17 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.3.4
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-
-echo '[ * ] Updating System Administrator account permissions...'
-$HESTIA/bin/v-change-user-role admin admin
-
-# Send end-of-life notification to admin user on servers running Ubuntu 16.04
-if [ "$OS_TYPE" = "Ubuntu" ]; then
-	if [ "$OS_VERSION" = '16.04' ]; then
-		$HESTIA/bin/v-add-user-notification admin 'IMPORTANT: End of support for Ubuntu 16.04 LTS' '<b>Hestia Control Panel no longer supports Ubuntu 16.04 LTS</b>, as a result your server will no longer receive upgrades or security patches after <b>v1.3.4</b>.<br><br>Please upgrade to a supported operating system.'
-	fi
-fi
diff --git a/install/upgrade/versions/1.4.0.sh b/install/upgrade/versions/1.4.0.sh
deleted file mode 100644
index 4f9290a..0000000
--- a/install/upgrade/versions/1.4.0.sh
+++ /dev/null
@@ -1,198 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.4.0
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-
-# Add support for nginx FastCGI cache (standalone)
-if [ -e "/etc/nginx/nginx.conf" ]; then
-	check=$(cat /etc/nginx/nginx.conf | grep 'fastcgi_cache_path')
-	if [ -z "$check" ]; then
-		echo "[ * ] Enabling nginx FastCGI cache support..."
-		sed -i 's/# Cache bypass/# FastCGI cache\n    fastcgi_cache_path \/var\/cache\/nginx\/micro levels=1:2 keys_zone=microcache:10m max_size=1024m inactive=30m;\n    fastcgi_cache_key \"$scheme$request_method$host$request_uri\";\n    fastcgi_cache_methods GET HEAD;\n    fastcgi_cache_use_stale updating error timeout invalid_header http_500 http_503;\n    fastcgi_ignore_headers Cache-Control Expires Set-Cookie;\n    add_header X-FastCGI-Cache \$upstream_cache_status;\n\n    # Cache bypass/g' /etc/nginx/nginx.conf
-		sed -i 's/    fastcgi_cache_lock_timeout      5s;/    fastcgi_cache_lock_timeout      5s;\n    fastcgi_cache_background_update on;\n    fastcgi_cache_revalidate        on;/g' /etc/nginx/nginx.conf
-	fi
-fi
-
-if [ -e "/etc/nginx/nginx.conf" ]; then
-	echo "[ * ] Updating nginx configuration with changes to Cloudflare IP addresses"
-	sed -i 's/    set_real_ip_from 104.16.0.0\/12;/    set_real_ip_from 104.16.0.0\/13;\n    set_real_ip_from 104.24.0.0\/14;/g' /etc/nginx/nginx.conf
-fi
-
-# Populating HELO/SMTP Banner for existing IPs
-if [ "$MAIL_SYSTEM" == "exim4" ]; then
-
-	# Check if we've already done this upgrade before proceeding
-	if ! grep -q ^smtp_active_hostname /etc/exim4/exim4.conf.template; then
-
-		source $HESTIA/func/ip.sh
-
-		echo "[ * ] Populating HELO/SMTP Banner value for existing IP addresses..."
-		> /etc/exim4/mailhelo.conf
-
-		for ip in $($BIN/v-list-sys-ips plain | cut -f1); do
-			helo=$(is_ip_rdns_valid $ip)
-
-			if [ ! -z "$helo" ]; then
-				$BIN/v-change-sys-ip-helo $ip $helo
-			fi
-		done
-
-		# Update exim configuration
-		echo "[ * ] Updating exim4 configuration..."
-
-		# Add new smtp_active_hostname variable to exim config
-		sed -i '/^smtp_banner = \$smtp_active_hostname$/a smtp_active_hostname = ${if exists {\/etc\/exim4\/mailhelo.conf}{${lookup{$interface_address}lsearch{\/etc\/exim4\/mailhelo.conf}{$value}{$primary_hostname}}}{$primary_hostname}}' /etc/exim4/exim4.conf.template
-
-		# Lookup HELO address by sending ip instead of sending domain
-		sed -i 's/helo_data = \${if exists {\/etc\/exim4\/mailhelo.conf}{${lookup{\$sender_address_domain}lsearch\*{\/etc\/exim4\/mailhelo.conf}{\$value}{\$primary_hostname}}}{\$primary_hostname}}/helo_data = ${if exists {\/etc\/exim4\/mailhelo.conf}{${lookup{$sending_ip_address}lsearch{\/etc\/exim4\/mailhelo.conf}{$value}{$primary_hostname}}}{$primary_hostname}}/' /etc/exim4/exim4.conf.template
-	fi
-fi
-
-# Upgrading Mail System
-if [ "$MAIL_SYSTEM" == "exim4" ]; then
-	if ! grep -q "send_via_smtp_relay" /etc/exim4/exim4.conf.template; then
-
-		echo '[ * ] Enabling SMTP relay support...'
-		if grep -q "driver = plaintext" /etc/exim4/exim4.conf.template; then
-			disable_smtp_relay=true
-			echo '[ ! ] ERROR: SMTP Relay upgrade failed:'
-			echo ''
-			echo 'Because of the complexity of the SMTP Relay upgrade,'
-			echo 'we were unable to safely modify your existing exim config file.'
-			echo 'If you would like to use the new SMTP Relay features,'
-			echo 'you will have to replace or modify your config with the one found'
-			echo 'on GitHub at https://github.com/hestiacp/hestiacp/blob/release/install/deb/exim/exim4.conf.template.'
-			echo 'Your exim config file will be found here: /etc/exim4/exim4.conf.template'
-			$HESTIA/bin/v-add-user-notification admin 'SMTP Relay upgrade failed' 'Because of the complexity of the SMTP Relay upgrade, we were unable to safely modify your existing exim config file.<br><br>If you would like to use the new SMTP Relay features, you will have to replace or modify your config with the one <a href="https://github.com/hestiacp/hestiacp/blob/release/install/deb/exim/exim4.conf.template" target="_blank">found on GitHub</a>.<br><br>Your exim config file will be found here:<br><br><code>/etc/exim4/exim4.conf.template</code>'
-		else
-			disable_smtp_relay=false
-		fi
-
-		# Add smtp relay macros to exim config
-		insert='SMTP_RELAY_FILE = ${if exists{/etc/exim4/domains/${sender_address_domain}/smtp_relay.conf}{/etc/exim4/domains/$sender_address_domain/smtp_relay.conf}{/etc/exim4/smtp_relay.conf}}\n\SMTP_RELAY_HOST=${lookup{host}lsearch{SMTP_RELAY_FILE}}\n\SMTP_RELAY_PORT=${lookup{port}lsearch{SMTP_RELAY_FILE}}\n\SMTP_RELAY_USER=${lookup{user}lsearch{SMTP_RELAY_FILE}}\n\SMTP_RELAY_PASS=${lookup{pass}lsearch{SMTP_RELAY_FILE}}\n'
-
-		if [ "$disable_smtp_relay" = true ]; then
-			insert=$(sed 's/^/#/g; s/\\n/\\n#/g; s/.$//' <<< $insert)
-		fi
-
-		line=$(expr $(sed -n '/ACL CONFIGURATION/=' /etc/exim4/exim4.conf.template) - 1)
-		sed -i "${line}i $insert" /etc/exim4/exim4.conf.template
-
-		# Add smtp relay authenticator
-		insert='smtp_relay_login:\n\  driver = plaintext\n\  public_name = LOGIN\n\  hide client_send = : SMTP_RELAY_USER : SMTP_RELAY_PASS\n'
-
-		if [ "$disable_smtp_relay" = true ]; then
-			insert=$(sed 's/^/#/g; s/\\n/\\n#/g; s/.$//' <<< $insert)
-		fi
-
-		line=$(expr $(sed -n '/begin authenticators/=' /etc/exim4/exim4.conf.template) + 2)
-		sed -i "${line}i $insert" /etc/exim4/exim4.conf.template
-
-		# Add smtp relay router
-		insert='send_via_smtp_relay:\n\  driver = manualroute\n\  address_data = SMTP_RELAY_HOST:SMTP_RELAY_PORT\n\  domains = !+local_domains\n\  require_files = SMTP_RELAY_FILE\n\  transport = smtp_relay_smtp\n\  route_list = * ${extract{1}{:}{$address_data}}::${extract{2}{:}{$address_data}}\n\  no_more\n\  no_verify\n'
-
-		if [ "$disable_smtp_relay" = true ]; then
-			insert=$(sed 's/^/#/g; s/\\n/\\n#/g; s/.$//' <<< $insert)
-		fi
-
-		line=$(expr $(sed -n '/begin routers/=' /etc/exim4/exim4.conf.template) + 2)
-		sed -i "${line}i $insert" /etc/exim4/exim4.conf.template
-
-		# Add smtp relay transport
-		insert='smtp_relay_smtp:\n\  driver = smtp\n\  hosts_require_auth = $host_address\n\  hosts_require_tls = $host_address\n'
-
-		if [ "$disable_smtp_relay" = true ]; then
-			insert=$(sed 's/^/#/g; s/\\n/\\n#/g; s/.$//' <<< $insert)
-		fi
-
-		line=$(expr $(sed -n '/begin transports/=' /etc/exim4/exim4.conf.template) + 2)
-		sed -i "${line}i $insert" /etc/exim4/exim4.conf.template
-	fi
-fi
-
-# Set default webmail system for mail domains
-if [ -n "$WEBMAIL_SYSTEM" ]; then
-	for user in $($BIN/v-list-users plain | cut -f1); do
-		for domain in $($BIN/v-list-mail-domains $user plain | cut -f1); do
-			$BIN/v-add-mail-domain-webmail $user $domain '' no
-		done
-	done
-fi
-
-# Fix PostgreSQL repo
-if [ -f /etc/apt/sources.list.d/postgresql.list ]; then
-	echo "[ * ] Updating PostgreSQL repository..."
-	sed -i 's|deb https://apt.postgresql.org/pub/repos/apt/|deb [arch=amd64] https://apt.postgresql.org/pub/repos/apt/|g' /etc/apt/sources.list.d/postgresql.list
-fi
-
-# Remove API file if API is set to "no"
-if [ "$API" = "no" ]; then
-	if [ -f "$HESTIA/web/api/index.php" ]; then
-		echo "[ * ] Disabling API access..."
-		$HESTIA/bin/v-change-sys-api remove
-	fi
-fi
-
-# Back up users existing configuration data to $HESTIA/conf/defaults/hestia.conf
-if [ ! -f "$HESTIA/conf/defaults/hestia.conf" ]; then
-	echo "[ * ] Creating known good configuration data for system recovery..."
-	if [ ! -d "$HESTIA/conf/defaults/" ]; then
-		mkdir -p "$HESTIA/conf/defaults/"
-	fi
-	cp -f $HESTIA/conf/hestia.conf $HESTIA/conf/defaults/hestia.conf
-fi
-
-if [ -f "/usr/lib/networkd-dispatcher/routable.d/50-ifup-hooks" ]; then
-	echo "[ * ] Fix potenial issue with multiple network adapters and netplan..."
-	rm "/usr/lib/networkd-dispatcher/routable.d/50-ifup-hooks"
-	$BIN/v-update-firewall
-fi
-
-# Consolidate nginx (standalone) templates used by active websites
-if [ "$WEB_SYSTEM" = "nginx" ]; then
-	echo "[ * ] Consolidating nginx templates for Drupal & CodeIgniter..."
-	sed -i "s|TPL='drupal6'|TPL='drupal'|g" $HESTIA/data/users/*/web.conf
-	sed -i "s|TPL='drupal7'|TPL='drupal'|g" $HESTIA/data/users/*/web.conf
-	sed -i "s|TPL='drupal8'|TPL='drupal'|g" $HESTIA/data/users/*/web.conf
-	sed -i "s|TPL='codeigniter2'|TPL='codeigniter'|g" $HESTIA/data/users/*/web.conf
-	sed -i "s|TPL='codeigniter3'|TPL='codeigniter'|g" $HESTIA/data/users/*/web.conf
-fi
-
-# Remove outdated nginx templates
-echo "[ * ] Removing outdated nginx templates..."
-rm -rf $HESTIA/data/templates/web/nginx/php-fpm/drupal6.*tpl
-rm -rf $HESTIA/data/templates/web/nginx/php-fpm/drupal7.*tpl
-rm -rf $HESTIA/data/templates/web/nginx/php-fpm/drupal8.*tpl
-rm -rf $HESTIA/data/templates/web/nginx/php-fpm/codeigniter2.*tpl
-rm -rf $HESTIA/data/templates/web/nginx/php-fpm/codeigniter3.*tpl
-
-# Clean up old Hestia controlled webapps
-if [ -d "$HESTIA/web/images/webapps/" ]; then
-	echo "[ * ] Clean up old web apps code..."
-	rm -rf $HESTIA/web/images/webapps/
-	rm -rf $HESTIA/web/src/app/WebApp/Installers/LaravelSetup.php
-	rm -rf $HESTIA/web/src/app/WebApp/Installers/OpencartSetup.php
-	rm -rf $HESTIA/web/src/app/WebApp/Installers/PrestashopSetup.php
-	rm -rf $HESTIA/web/src/app/WebApp/Installers/SymfonySetup.php
-	rm -rf $HESTIA/web/src/app/WebApp/Installers/WordpressSetup.php
-	rm -rf $HESTIA/web/src/app/WebApp/Installers/Joomla
-fi
-
-# Update ClamAV configuration file
-if [ -f "/etc/clamav/clamd.conf" ]; then
-	cp -f $HESTIA_INSTALL_DIR/clamav/clamd.conf /etc/clamav/
-	$HESTIA/bin/v-add-user-notification admin 'ClamAV config has been overwritten' 'Warning: If you have manualy changed /etc/clamav/clamd.conf and any changes you made will be lost an backup has been created in the /root/hst_backups folder with the original config. If you have not changed the config file you can ignore this message'
-fi
-
-##### COMMANDS FOR V1.5.X
-
-# Back up default package and install latest version
-if [ -d $HESTIA/data/packages/ ]; then
-	echo "[ * ] Migrating legacy default package for all users..."
-	$HESTIA/bin/v-rename-user-package default custom > /dev/null 2>&1
-	echo "[ * ] Replacing default package..."
-	cp -f $HESTIA_INSTALL_DIR/packages/default.pkg $HESTIA/data/packages/
-fi
diff --git a/install/upgrade/versions/1.4.1.sh b/install/upgrade/versions/1.4.1.sh
deleted file mode 100644
index 6c48433..0000000
--- a/install/upgrade/versions/1.4.1.sh
+++ /dev/null
@@ -1,7 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.4.1
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
diff --git a/install/upgrade/versions/1.4.10.sh b/install/upgrade/versions/1.4.10.sh
deleted file mode 100644
index 412edde..0000000
--- a/install/upgrade/versions/1.4.10.sh
+++ /dev/null
@@ -1,7 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.4.10
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
diff --git a/install/upgrade/versions/1.4.11.sh b/install/upgrade/versions/1.4.11.sh
deleted file mode 100644
index 754c733..0000000
--- a/install/upgrade/versions/1.4.11.sh
+++ /dev/null
@@ -1,27 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.4.11
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-
-# Fix the potential issue of loading firewall rules
-if [ "$FIREWALL_SYSTEM" = "iptables" ]; then
-	echo "[ * ] Updating firewall configuration..."
-	# Just in case, delete the legacy version loading script again to prevent any residue
-	rm -f /usr/lib/networkd-dispatcher/routable.d/50-ifup-hooks /etc/network/if-pre-up.d/iptables
-	# The firewall rules are loading by Systemd, the old loading script is no longer needed
-	rm -f /usr/lib/networkd-dispatcher/routable.d/10-hestia-iptables /etc/network/if-pre-up.d/hestia-iptables
-	$BIN/v-update-firewall
-fi
-
-if [ -f "/etc/exim4/exim4.conf.template" ]; then
-	test=$(grep 'require_files = ${local_part}:+${home}/.forward' /etc/exim4/exim4.conf.template)
-	if [ -z "$test" ]; then
-		echo "[ * ] Fix bug where email send to news@domain.com is handled by /var/spool/news"
-		insert="\  require_files = \${local_part}:+\${home}/.forward\n\  domains = +local_domains"
-		line=$(expr $(sed -n '/userforward/=' /etc/exim4/exim4.conf.template) + 1)
-		sed -i "${line}i $insert" /etc/exim4/exim4.conf.template
-	fi
-fi
diff --git a/install/upgrade/versions/1.4.12.sh b/install/upgrade/versions/1.4.12.sh
deleted file mode 100644
index 5bf56db..0000000
--- a/install/upgrade/versions/1.4.12.sh
+++ /dev/null
@@ -1,16 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.4.12
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-
-exim_version=$(exim4 --version | head -1 | awk '{print $3}' | cut -f -2 -d .)
-if [ "$exim_version" = "4.94" ]; then
-	echo "[ ! ] Fixing issue with Exim 4.94 (#2087 - Unable send email)..."
-	if [ -f "/etc/exim4/exim4.conf.template" ]; then
-		sed -i 's|OUTGOING_IP = /etc/exim4/domains/$sender_address_domain/ip|OUTGOING_IP = /etc/exim4/domains/${lookup{$sender_address_domain}dsearch{/etc/exim4/domains}}/ip|g' /etc/exim4/exim4.conf.template
-		sed -i 's|SMTP_RELAY_FILE = ${if exists{/etc/exim4/domains/${sender_address_domain}/smtp_relay.conf}{/etc/exim4/domains/$sender_address_domain/smtp_relay.conf}{/etc/exim4/smtp_relay.conf}}|SMTP_RELAY_FILE = ${if exists{/etc/exim4/domains/${lookup{$sender_address_domain}dsearch{/etc/exim4/domains}}/smtp_relay.conf}{/etc/exim4/domains/${lookup{$sender_address_domain}dsearch{/etc/exim4/domains}}/smtp_relay.conf}{/etc/exim4/smtp_relay.conf}}|g' /etc/exim4/exim4.conf.template
-	fi
-fi
diff --git a/install/upgrade/versions/1.4.13.sh b/install/upgrade/versions/1.4.13.sh
deleted file mode 100644
index febe9df..0000000
--- a/install/upgrade/versions/1.4.13.sh
+++ /dev/null
@@ -1,51 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.4.13
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-servername=$(hostname -f)
-# Check if hostname is valid according to RFC1178
-if [[ $(echo "$servername" | grep -o "\." | wc -l) -lt 2 ]] || [[ $servername =~ ^[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+$ ]]; then
-	echo "[ * ] Hostname does not follow  RFC1178 standard Please check email send regarding the update!"
-	add_upgrade_message "We've noticed that you're using a invalid hostname. Please have a look at the RFC1178 standard (https://datatracker.ietf.org/doc/html/rfc1178) and use a valid one (ex. hostname.domain.tld). You can change the hostname using v-change-sys-hostname and also add a ssl certificate using v-add-letsencypt-host (proper dns A record mandatory). You'll find more informations in our documentation: https://hestiacp.com/docs/server-administration/ssl-certificates.html#how-to-setup-let-s-encrypt-for-the-control-panel"
-	$HESTIA/bin/v-add-user-notification admin "Invalid Hostname detected" "Warning: We've noticed that you're using a invalid hostname. Please have a look at the <a href=\"https://datatracker.ietf.org/doc/html/rfc1178\" target=\"_blank\">RFC1178 standard</a> and use a valid one (ex. hostname.domain.tld). You can change the hostname using v-change-sys-hostname and also add a ssl certificate using v-add-letsencypt-host (proper dns A record mandatory). You'll find more informations in our <a href=\"https://hestiacp.com/docs/server-administration/ssl-certificates.html#how-to-setup-let-s-encrypt-for-the-control-panel\" target=\"_blank\">documentation</a>."
-fi
-
-# Empty $HESTIA/ssl/mail/ due to bug in #2066
-if [ -e "$HESTIA/ssl/mail/" ]; then
-	rm -fr $HESTIA/ssl/mail/*
-fi
-
-# Reset PMA SSO
-if [ "$PHPMYADMIN_KEY" != "" ]; then
-	echo "[ * ] Updating hestia-sso for phpMyAdmin..."
-	$BIN/v-delete-sys-pma-sso
-	$BIN/v-add-sys-pma-sso
-fi
-
-# Loading firewall rules Systemd unit needs update. #2100
-if [ "$FIREWALL_SYSTEM" = "iptables" ]; then
-	echo "[ * ] Updating loading firewall configuration..."
-	$BIN/v-delete-sys-firewall
-	$BIN/v-add-sys-firewall
-fi
-
-# Remove old files/folders from previous versions of Hestia Control Panel
-if [ -d "$HESTIA/web/edit/file/" ]; then
-	rm -fr $HESTIA/web/edit/file/
-fi
-if [ -d "$HESTIA/web/edit/server/theme/" ]; then
-	rm -fr $HESTIA/web/edit/server/theme/
-fi
diff --git a/install/upgrade/versions/1.4.14.sh b/install/upgrade/versions/1.4.14.sh
deleted file mode 100644
index 1908fab..0000000
--- a/install/upgrade/versions/1.4.14.sh
+++ /dev/null
@@ -1,21 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.4.14
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-if [ -f "/etc/network/interfaces" ] && [ -f "/etc/netplan/60-hestia.yaml" ]; then
-	add_upgrade_message "Warning: Please check your network configuration!\n\nDuring this update network compatibility issues were detected. Both /etc/network/interfaces and /etc/netplan/60-hestia.yaml exist which can lead to issues after a system reboot. Please review your network configuration."
-	$HESTIA/bin/v-add-user-notification admin "WARNING: Invalid network configuration detected\n\nDuring this update network compatibility issues were detected. Both /etc/network/interfaces and /etc/netplan/60-hestia.yaml exist which can lead to issues after a system reboot. Please review your network configuration."
-fi
diff --git a/install/upgrade/versions/1.4.15.sh b/install/upgrade/versions/1.4.15.sh
deleted file mode 100644
index 4dce9e4..0000000
--- a/install/upgrade/versions/1.4.15.sh
+++ /dev/null
@@ -1,29 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.4.15
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-if [ -n "$DB_PMA_ALIAS" ]; then
-	$HESTIA/bin/v-change-sys-db-alias 'pma' "$DB_PMA_ALIAS"
-fi
-
-exim_version=$(exim4 --version | head -1 | awk '{print $3}' | cut -f -2 -d .)
-if [ "$exim_version" = "4.94" ]; then
-	echo "[ ! ] Updating Exim configuration..."
-	if [ -f "/etc/exim4/exim4.conf.template" ]; then
-		sed -i 's|file = /etc/exim4/domains/${lookup{$domain}dsearch{/etc/exim4/domains/}}/autoreply.${lookup{$local_part}dsearch{${extract{5}{:}{${lookup{$local_part}lsearch{/etc/exim4/domains/${lookup{$domain}dsearch{/etc/exim4/domains/}}/passwd}}}}/mail/${lookup{$domain}dsearch{/etc/exim4/domains/}}}}.msg|file = /etc/exim4/domains/${lookup{$domain}dsearch{/etc/exim4/domains/}}/autoreply.${extract{1}{:}{${lookup{$local_part}lsearch{/etc/exim4/domains/${lookup{$domain}dsearch{/etc/exim4/domains/}}/accounts}}}}.msg|g' /etc/exim4/exim4.conf.template
-		sed -i 's| from = "${lookup{$local_part}dsearch{${extract{5}{:}{${lookup{$local_part}lsearch{/etc/exim4/domains/${lookup{$domain}dsearch{/etc/exim4/domains/}}/passwd}}}}/mail/${lookup{$domain}dsearch{/etc/exim4/domains/}}}}@${lookup{$domain}dsearch{/etc/exim4/domains/}}"| from = "${extract{1}{:}{${lookup{$local_part}lsearch{/etc/exim4/domains/${lookup{$domain}dsearch{/etc/exim4/domains/}}/accounts}}}}@${lookup{$domain}dsearch{/etc/exim4/domains/}}"|g' /etc/exim4/exim4.conf.template
-	fi
-fi
diff --git a/install/upgrade/versions/1.4.16.sh b/install/upgrade/versions/1.4.16.sh
deleted file mode 100644
index ec739dc..0000000
--- a/install/upgrade/versions/1.4.16.sh
+++ /dev/null
@@ -1,20 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.4.16
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-if [ -n "$DB_PMA_ALIAS" ]; then
-	$HESTIA/bin/v-change-sys-db-alias 'pma' "$DB_PMA_ALIAS"
-fi
diff --git a/install/upgrade/versions/1.4.17.sh b/install/upgrade/versions/1.4.17.sh
deleted file mode 100644
index 5fe7d03..0000000
--- a/install/upgrade/versions/1.4.17.sh
+++ /dev/null
@@ -1,20 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.4.17
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass trough information to the end user incase of a issue or problem    #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### to the upgrade email. Please add it using:                              #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-if [ -n "$DB_PMA_ALIAS" ]; then
-	$HESTIA/bin/v-change-sys-db-alias 'pma' "$DB_PMA_ALIAS"
-fi
diff --git a/install/upgrade/versions/1.4.2.sh b/install/upgrade/versions/1.4.2.sh
deleted file mode 100644
index 8799005..0000000
--- a/install/upgrade/versions/1.4.2.sh
+++ /dev/null
@@ -1,29 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.4.2
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-
-# Optimize loading firewall rules
-if [ "$FIREWALL_SYSTEM" = "iptables" ]; then
-	echo "[ * ] Fix the issue of loading firewall rules..."
-	# Add rule to ensure the rule will be added when we update the firewall / /etc/iptables.rules
-	iptables -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
-	rm -f /usr/lib/networkd-dispatcher/routable.d/50-ifup-hooks /etc/network/if-pre-up.d/iptables
-	$BIN/v-update-firewall
-fi
-
-# Fix potential issue of updating to Nginx 1.21.0
-if [ "$WEB_SYSTEM" = "nginx" ] || [ "$PROXY_SYSTEM" = "nginx" ]; then
-	default_conf="/etc/nginx/conf.d/default.conf"
-	nginx_conf="/etc/nginx/nginx.conf"
-
-	[ -f "${default_conf}" ] && mv -f ${default_conf} ${default_conf}.dpkg-dist
-	[ -f "${default_conf}.dpkg-new" ] && mv -f ${default_conf}.dpkg-new ${default_conf}.dpkg-dist
-	[ -f "${nginx_conf}.dpkg-new" ] && mv -f ${nginx_conf}.dpkg-new ${nginx_conf}.dpkg-dist
-	[ -f "${nginx_conf}.dpkg-old" ] && mv -f ${nginx_conf} ${nginx_conf}.dpkg-dist \
-		&& rm -f ${nginx_conf}.dpkg-old \
-		&& cp -f $HESTIA/install/deb/nginx/nginx.conf /etc/nginx/
-fi
diff --git a/install/upgrade/versions/1.4.3.sh b/install/upgrade/versions/1.4.3.sh
deleted file mode 100644
index 37c01f4..0000000
--- a/install/upgrade/versions/1.4.3.sh
+++ /dev/null
@@ -1,20 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.4.3
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-
-# Improve generate and loading firewall rules
-if [ "$FIREWALL_SYSTEM" = "iptables" ]; then
-	echo "[ * ] Fix the issue of generate firewall rules..."
-	$BIN/v-update-firewall
-fi
-
-# Reset PMA SSO
-if [ "$PHPMYADMIN_KEY" != "" ]; then
-	echo "[ * ] Refressh hestia-sso for PMA..."
-	$BIN/v-delete-sys-pma-sso
-	$BIN/v-add-sys-pma-sso
-fi
diff --git a/install/upgrade/versions/1.4.4.sh b/install/upgrade/versions/1.4.4.sh
deleted file mode 100644
index 9329a91..0000000
--- a/install/upgrade/versions/1.4.4.sh
+++ /dev/null
@@ -1,37 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.4.4
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-
-if [ -d "/etc/nginx/conf.d/" ]; then
-	#Add nginx user_agent separation to desktop/mobile
-	cp -f $HESTIA_INSTALL_DIR/nginx/agents.conf /etc/nginx/conf.d/
-fi
-
-if [ -d "/etc/phpmyadmin/" ]; then
-	echo "[ * ] Secure PHPmyAdmin"
-	# limit access to /etc/phpmyadmin/ and /usr/share/phpmyadmin/tmp and so on
-	chown -R root:www-data /etc/phpmyadmin/
-	chmod -R 640 /etc/phpmyadmin/*
-	if [ -d "/etc/phpmyadmin/conf.d/" ]; then
-		chmod 750 /etc/phpmyadmin/conf.d/
-	fi
-	if [ -d "/var/lib/phpmyadmin/tmp" ]; then
-		chown root:www-data /usr/share/phpmyadmin/tmp
-		chmod 770 /usr/share/phpmyadmin/tmp
-	fi
-	if [ -d "/var/lib/phpmyadmin/tmp" ]; then
-		chmod 770 /var/lib/phpmyadmin/tmp
-		chown root:www-data /usr/share/phpmyadmin/tmp
-	fi
-fi
-
-# Reset PMA SSO to fix bug with Nginx + Apache2
-if [ "$PHPMYADMIN_KEY" != "" ]; then
-	echo "[ * ] Refressh hestia-sso for PMA..."
-	$BIN/v-delete-sys-pma-sso quiet
-	$BIN/v-add-sys-pma-sso quiet
-fi
diff --git a/install/upgrade/versions/1.4.5.sh b/install/upgrade/versions/1.4.5.sh
deleted file mode 100644
index e20494d..0000000
--- a/install/upgrade/versions/1.4.5.sh
+++ /dev/null
@@ -1,7 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.4.5
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
diff --git a/install/upgrade/versions/1.4.6.sh b/install/upgrade/versions/1.4.6.sh
deleted file mode 100644
index 85ce599..0000000
--- a/install/upgrade/versions/1.4.6.sh
+++ /dev/null
@@ -1,12 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.4.6
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-
-if [ -n "$DB_PMA_ALIAS" ]; then
-	$HESTIA/bin/v-change-sys-db-alias 'pma' "$DB_PMA_ALIAS"
-	rm -rf /usr/share/phpmyadmin/tmp/*
-fi
diff --git a/install/upgrade/versions/1.4.7.sh b/install/upgrade/versions/1.4.7.sh
deleted file mode 100644
index 61a124b..0000000
--- a/install/upgrade/versions/1.4.7.sh
+++ /dev/null
@@ -1,11 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.4.7
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-
-if [ -n "$DB_PGA_ALIAS" ]; then
-	$HESTIA/bin/v-change-sys-db-alias 'pga' "$DB_PGA_ALIAS"
-fi
diff --git a/install/upgrade/versions/1.4.8.sh b/install/upgrade/versions/1.4.8.sh
deleted file mode 100644
index ddc89c0..0000000
--- a/install/upgrade/versions/1.4.8.sh
+++ /dev/null
@@ -1,28 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.4.8
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-
-echo "[ * ] Configuring PHPMailer..."
-$HESTIA/bin/v-add-sys-phpmailer quiet
-
-matches=$(grep -o 'ENFORCE_SUBDOMAIN_OWNERSHIP' $HESTIA/conf/hestia.conf | wc -l)
-if [ "$matches" -gt 1 ]; then
-	echo "[ * ] Removing double matches ENFORCE_SUBDOMAIN_OWNERSHIP key"
-	source $HESTIA/conf/hestia.conf
-	sed -i "/ENFORCE_SUBDOMAIN_OWNERSHIP='$ENFORCE_SUBDOMAIN_OWNERSHIP'/d" $HESTIA/conf/hestia.conf
-	$HESTIA/bin/v-change-sys-config-value "ENFORCE_SUBDOMAIN_OWNERSHIP" "$ENFORCE_SUBDOMAIN_OWNERSHIP"
-fi
-
-if [ "$IMAP_SYSTEM" = "dovecot" ]; then
-	version=$(dovecot --version | cut -f -2 -d .)
-	if [ "$version" = "2.3" ]; then
-		echo "[ * ] Update dovecot config to sync with 2.3 settings"
-		sed -i 's|ssl_dh_parameters_length = 4096|#ssl_dh_parameters_length = 4096|g' /etc/dovecot/conf.d/10-ssl.conf
-		sed -i 's|#ssl_dh = </etc/ssl/dhparam.pem|ssl_dh = </etc/ssl/dhparam.pem|g' /etc/dovecot/conf.d/10-ssl.conf
-		sed -i 's|ssl_protocols = !SSLv3 !TLSv1|ssl_min_protocol=TLSv1.1|g' /etc/dovecot/conf.d/10-ssl.conf
-	fi
-fi
diff --git a/install/upgrade/versions/1.4.9.sh b/install/upgrade/versions/1.4.9.sh
deleted file mode 100644
index 9f693f5..0000000
--- a/install/upgrade/versions/1.4.9.sh
+++ /dev/null
@@ -1,7 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.4.9
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
diff --git a/install/upgrade/versions/1.5.0.sh b/install/upgrade/versions/1.5.0.sh
deleted file mode 100644
index c66f25c..0000000
--- a/install/upgrade/versions/1.5.0.sh
+++ /dev/null
@@ -1,81 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.5.0
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'true'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'true'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'true'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'true'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'true'
-
-if [ -n "$DB_PMA_ALIAS" ]; then
-	if [ -e "/etc/apache2/conf.d/phpmyadmin.conf" ]; then
-		rm /etc/apache2/conf.d/phpmyadmin.conf
-		touch /etc/apache2/conf.d/phpmyadmin.inc
-	fi
-	$HESTIA/bin/v-change-sys-db-alias 'pma' "$DB_PMA_ALIAS"
-fi
-
-if [ -n "$DB_PGA_ALIAS" ]; then
-	if [ -e "/etc/apache2/conf.d/phppgadmin.conf" ]; then
-		rm /etc/apache2/conf.d/phppgadmin.conf
-		touch /etc/apache2/conf.d/phppgadmin.inc
-	fi
-	$HESTIA/bin/v-change-sys-db-alias 'pga' "$DB_PGA_ALIAS"
-
-fi
-
-if [ -n "$MAIL_SYSTEM" ]; then
-	echo "[ ! ] Updating Exim configuration..."
-	if [ -f "/etc/exim4/exim4.conf.template" ]; then
-		sed -i 's/^smtp_active_hostname = \${if exists {\/etc\/exim4\/mailhelo\.conf}{\${lookup{\$interface_address}lsearch{\/etc\/exim4\/mailhelo\.conf}{\$value}{\$primary_hostname}}}{\$primary_hostname}}$/smtp_active_hostname = \${lookup dnsdb{>: ptr=\$interface_address}{\${listextract{1}{\$value}}}{\$primary_hostname}}/' /etc/exim4/exim4.conf.template
-
-		sed -i 's/^  helo_data = \${if exists {\/etc\/exim4\/mailhelo\.conf}{\${lookup{\$sending_ip_address}lsearch{\/etc\/exim4\/mailhelo\.conf}{\$value}{\$primary_hostname}}}{\$primary_hostname}}$/  helo_data = \${lookup dnsdb{>: ptr=\$sending_ip_address}{\${listextract{1}{\$value}}}{\$primary_hostname}}/' /etc/exim4/exim4.conf.template
-
-		# When 1.5.0 beta was installed
-		sed -i 's/^smtp_active_hostname = \${lookup dnsdb{ptr=\$interface_address}{\$value}{\$primary_hostname}}$/smtp_active_hostname = \${lookup dnsdb{>: ptr=\$interface_address}{\${listextract{1}{\$value}}}{\$primary_hostname}}/' /etc/exim4/exim4.conf.template
-
-		sed -i 's/^  helo_data = \${lookup dnsdb{ptr=\$sending_ip_address}{\$value}{\$primary_hostname}}$/  helo_data = \${lookup dnsdb{>: ptr=\$sending_ip_address}{\${listextract{1}{\$value}}}{\$primary_hostname}}/' /etc/exim4/exim4.conf.template
-	fi
-
-	# Clean up legacy mailhelo file
-	rm -f /etc/${MAIL_SYSTEM}/mailhelo.conf
-
-	# Clean up legacy ip variable
-	for ip in $($BIN/v-list-sys-ips plain | cut -f1); do
-		sed '/^HELO/d' $HESTIA/data/ips/$ip > /dev/null
-	done
-fi
-
-if [ -L "/var/log/hestia" ]; then
-	echo "[ ! ] Updating log file location: /usr/local/hestia/log/* to /var/log/hestia/..."
-	rm /var/log/hestia
-	mkdir -p /var/log/hestia
-	cp /usr/local/hestia/log/* /var/log/hestia/
-	rm -rf /usr/local/hestia/log
-	ln -s /var/log/hestia /usr/local/hestia/log
-	touch /var/log/hestia/auth.log /var/log/hestia/error.log /var/log/hestia/system.log /var/log/hestia/nginx-error.log /var/log/hestia/nginx-access.log
-fi
-
-if [ -d "/var/log/roundcube" ]; then
-	chown www-data:root /var/log/roundcube
-	chmod 751 /var/log/roundcube
-fi
-
-if [ -d "/etc/roundcube" ]; then
-	chmod 644 /etc/roundcube/defaults.inc.php
-	chmod 644 /etc/roundcube/mimetypes.php
-fi
diff --git a/install/upgrade/versions/1.5.1.sh b/install/upgrade/versions/1.5.1.sh
deleted file mode 100644
index 7f6c59c..0000000
--- a/install/upgrade/versions/1.5.1.sh
+++ /dev/null
@@ -1,56 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.5.1
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'true'
-
-RHOST='apt.hestiacp.com'
-codename="$(lsb_release -s -c)"
-if [ -z "$codename" ]; then
-	codename="$(cat /etc/os-release | grep VERSION= | cut -f 2 -d \( | cut -f 1 -d \))"
-fi
-architecture="$(arch)"
-case $architecture in
-	x86_64)
-		ARCH="amd64"
-		;;
-	aarch64)
-		ARCH="arm64"
-		;;
-	*) ;;
-esac
-
-chmod +x $HESTIA/install/deb/
-
-echo "[ * ] Updating hestia apt configuration..."
-sed -i "s|deb https://$RHOST/ $codename main|deb [arch=$ARCH] https://$RHOST/ $codename main|g" /etc/apt/sources.list.d/hestia.list
-
-if [ -n "$IMAP_SYSTEM" ]; then
-	echo "[ * ] Updating dovecot configuration..."
-	sed -i "s/mail_plugins = \$mail_plugins sieve/mail_plugins = \$mail_plugins quota sieve/g" /etc/dovecot/conf.d/15-lda.conf
-fi
-
-if [ -n "$MAIL_SYSTEM" ]; then
-	echo "[ ! ] Updating Exim configuration..."
-	if [ -f "/etc/exim4/exim4.conf.template" ]; then
-		sed -i 's/^smtp_active_hostname = \${lookup dnsdb{>: ptr=\$interface_address}{\${listextract{1}{\$value}}}{\$primary_hostname}}$/smtp_active_hostname = \${lookup dnsdb{>: defer_never,ptr=\$interface_address}{\${listextract{1}{\$value}}}{\$primary_hostname}}/' /etc/exim4/exim4.conf.template
-		sed -i 's/^  helo_data = \${lookup dnsdb{>: ptr=\$sending_ip_address}{\${listextract{1}{\$value}}}{\$primary_hostname}}$/  helo_data = \${lookup dnsdb{>: defer_never,ptr=\$sending_ip_address}{\${listextract{1}{\$value}}}{\$primary_hostname}}/' /etc/exim4/exim4.conf.template
-	fi
-fi
diff --git a/install/upgrade/versions/1.5.10.sh b/install/upgrade/versions/1.5.10.sh
deleted file mode 100644
index 259ad61..0000000
--- a/install/upgrade/versions/1.5.10.sh
+++ /dev/null
@@ -1,40 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.5.10
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
-
-# shellcheck source=/usr/local/hestia/func/db.sh
-source $HESTIA/func/db.sh
-
-if [ -n "$(echo $DB_SYSTEM | grep -w mysql)" ]; then
-	mysql_connect 'localhost'
-	version=$(mysql --defaults-file=/usr/local/hestia/conf/.mysql.localhost -e 'SELECT VERSION()')
-	mysql_version=$(echo $version | grep -o -E '[0-9]*.[0-9].[0-9]+' | head -n1)
-	mysql_version2=$(echo $mysql_version | grep -o -E '[0-9]*.[0-9]' | head -n1)
-
-	if [ "$mysql_version2" = "10.6" ]; then
-		test=$(mysql -e "select * from mysql.global_priv;" | grep root | grep unix_socket)
-		if [ -z "$test" ]; then
-			echo "[ ! ] Updating MariaDB permissions to fix startup issue "
-			mysql --defaults-file=/usr/local/hestia/conf/.mysql.localhost -e "UPDATE mysql.global_priv SET priv=json_set(priv, '$.password_last_changed', UNIX_TIMESTAMP(), '$.plugin', 'mysql_native_password', '$.authentication_string', 'invalid', '$.auth_or', json_array(json_object(), json_object('plugin', 'unix_socket'))) WHERE User='root';"
-		fi
-	fi
-fi
diff --git a/install/upgrade/versions/1.5.11.sh b/install/upgrade/versions/1.5.11.sh
deleted file mode 100644
index 2a2bd7e..0000000
--- a/install/upgrade/versions/1.5.11.sh
+++ /dev/null
@@ -1,50 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.5.11
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
-
-PORT=$(cat $HESTIA/nginx/conf/nginx.conf | grep "listen" | sed 's/[^0-9]*//g')
-
-if [ "$PORT" != "8083" ]; then
-	# Update F2B chains config
-	if [ -f "$HESTIA/data/firewall/chains.conf" ]; then
-		# Update value in chains.conf
-		sed -i "s/PORT='8083'/PORT='$PORT'/g" $HESTIA/data/firewall/chains.conf
-	fi
-
-	# Restart services
-	if [ -n "$FIREWALL_SYSTEM" ] && [ "$FIREWALL_SYSTEM" != no ]; then
-		$HESTIA/bin/v-stop-firewall
-		$HESTIA/bin/v-update-firewall
-
-	fi
-fi
-
-# Fix Roundcube logdir permission
-if [ -d "/var/log/roundcube" ]; then
-	chown www-data:www-data /var/log/roundcube
-fi
-
-# Fix bug in nginx.conf for proxy cache
-if [ -d "/etc/nginx/nginx.conf" ]; then
-	echo "[ ! ] Fixed an issue with proxy cache and redirects"
-	sed -i 's/proxy_cache_key "$host$request_uri $cookie_user";/proxy_cache_key "$scheme$request_method$host$request_uri";/g' /etc/nginx/nginx.conf
-fi
diff --git a/install/upgrade/versions/1.5.2.sh b/install/upgrade/versions/1.5.2.sh
deleted file mode 100644
index 1040e56..0000000
--- a/install/upgrade/versions/1.5.2.sh
+++ /dev/null
@@ -1,22 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.5.2
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'true'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'true'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'true'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
diff --git a/install/upgrade/versions/1.5.3.sh b/install/upgrade/versions/1.5.3.sh
deleted file mode 100644
index fec36a4..0000000
--- a/install/upgrade/versions/1.5.3.sh
+++ /dev/null
@@ -1,22 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.5.4
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'true'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
diff --git a/install/upgrade/versions/1.5.4.sh b/install/upgrade/versions/1.5.4.sh
deleted file mode 100644
index fec36a4..0000000
--- a/install/upgrade/versions/1.5.4.sh
+++ /dev/null
@@ -1,22 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.5.4
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'true'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
diff --git a/install/upgrade/versions/1.5.5.sh b/install/upgrade/versions/1.5.5.sh
deleted file mode 100644
index 66f9c37..0000000
--- a/install/upgrade/versions/1.5.5.sh
+++ /dev/null
@@ -1,103 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.5.5
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'true'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'true'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'true'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'true'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
-
-# Update php-fpm.conf
-for version in $($BIN/v-list-sys-php plain); do
-	cp -f $HESTIA_INSTALL_DIR/php-fpm/php-fpm.conf /etc/php/$version/fpm/
-	sed -i "s/fpm_v/$version/g" /etc/php/$version/fpm/php-fpm.conf
-done
-
-echo "[ * ] Updating apt keyring configuration..."
-
-mkdir -p /root/.gnupg && chmod 700 /root/.gnupg
-
-if [ ! -f "/usr/share/keyrings/nginx-keyring.gpg" ]; then
-	# Get Architecture
-	architecture="$(arch)"
-	case $architecture in
-		x86_64)
-			ARCH="amd64"
-			;;
-		aarch64)
-			ARCH="arm64"
-			;;
-		*)
-			echo "   [ ! ] Unsuported architectrue"
-			;;
-	esac
-
-	#Get OS details
-	os=$(grep "^ID=" /etc/os-release | cut -f 2 -d '=')
-	codename="$(lsb_release -s -c)"
-	release="$(lsb_release -s -r)"
-	mariadb_v=$(mysql -V | awk 'NR==1{print $5}' | head -c 4)
-	RHOST='apt.hestiacp.com'
-
-	apt="/etc/apt/sources.list.d"
-
-	if [ -f "$apt/nginx.list" ]; then
-		rm $apt/nginx.list
-		echo "   [ * ] NGINX"
-		echo "deb [arch=$ARCH signed-by=/usr/share/keyrings/nginx-keyring.gpg] https://nginx.org/packages/mainline/$os/ $codename nginx" > $apt/nginx.list
-		curl -s https://nginx.org/keys/nginx_signing.key | gpg --dearmor | tee /usr/share/keyrings/nginx-keyring.gpg > /dev/null 2>&1
-	fi
-	if [ "$os" = "debian" ]; then
-		if [ -f "$apt/php.list" ]; then
-			rm $apt/php.list
-			echo "   [ * ] PHP"
-			echo "deb [arch=$ARCH signed-by=/usr/share/keyrings/sury-keyring.gpg] https://packages.sury.org/php/ $codename main" > $apt/php.list
-			curl -s https://packages.sury.org/php/apt.gpg | gpg --dearmor | tee /usr/share/keyrings/sury-keyring.gpg > /dev/null 2>&1
-		fi
-		if [ -f "$apt/apache2.list" ]; then
-			rm $apt/apache2.list
-			echo "   [ * ] Apache2"
-			echo "deb [arch=$ARCH signed-by=/usr/share/keyrings/apache2-keyring.gpg] https://packages.sury.org/apache2/ $codename main" > $apt/apache2.list
-			curl -s https://packages.sury.org/apache2/apt.gpg | gpg --dearmor | tee /usr/share/keyrings/apache2-keyring.gpg > /dev/null 2>&1
-		fi
-	fi
-	if [ -f "$apt/mariadb.list" ]; then
-		rm $apt/mariadb.list
-		echo "   [ * ] MariaDB"
-		echo "deb [arch=$ARCH signed-by=/usr/share/keyrings/mariadb-keyring.gpg] https://mirror.mva-n.net/mariadb/repo/$mariadb_v/$os $codename main" > $apt/mariadb.list
-		curl -s https://mariadb.org/mariadb_release_signing_key.asc | gpg --dearmor | tee /usr/share/keyrings/mariadb-keyring.gpg > /dev/null 2>&1
-	fi
-	if [ -f "$apt/hestia.list" ]; then
-		rm $apt/hestia.list
-		echo "   [ * ] Hestia"
-		echo "deb [arch=$ARCH signed-by=/usr/share/keyrings/hestia-keyring.gpg] https://$RHOST/ $codename main" > $apt/hestia.list
-		gpg --no-default-keyring --keyring /usr/share/keyrings/hestia-keyring.gpg --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys A189E93654F0B0E5 > /dev/null 2>&1
-		apt-key del A189E93654F0B0E5 > /dev/null 2>&1
-	fi
-	if [ -f "$apt/postgresql.list" ]; then
-		rm $apt/postgresql.list
-		echo "[ * ] PostgreSQL"
-		echo "deb [arch=$ARCH signed-by=/usr/share/keyrings/postgresql-keyring.gpg] https://apt.postgresql.org/pub/repos/apt/ $codename-pgdg main" > $apt/postgresql.list
-		curl -s https://www.postgresql.org/media/keys/ACCC4CF8.asc | gpg --dearmor | tee /usr/share/keyrings/postgresql-keyring.gpg > /dev/null 2>&1
-	fi
-
-fi
-
-if [ ! -f "$HESTIA/data/packages/system.pkg" ]; then
-	echo "[ * ] Install default system package."
-	cp -f $HESTIA/install/deb/packages/system.pkg $HESTIA/data/packages/system.pkg
-fi
diff --git a/install/upgrade/versions/1.5.6.sh b/install/upgrade/versions/1.5.6.sh
deleted file mode 100644
index 02427f4..0000000
--- a/install/upgrade/versions/1.5.6.sh
+++ /dev/null
@@ -1,27 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.5.6
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
-
-echo "[ * ] Refresh Hostname SSL..."
-hostname=$(hostname)
-user=$($HESTIA/bin/v-search-domain-owner "$hostname")
-$HESTIA/bin/v-update-host-certificate "$user" "$hostname"
diff --git a/install/upgrade/versions/1.5.7.sh b/install/upgrade/versions/1.5.7.sh
deleted file mode 100644
index 02b47a5..0000000
--- a/install/upgrade/versions/1.5.7.sh
+++ /dev/null
@@ -1,22 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.5.7
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
diff --git a/install/upgrade/versions/1.5.8.sh b/install/upgrade/versions/1.5.8.sh
deleted file mode 100644
index 454ef50..0000000
--- a/install/upgrade/versions/1.5.8.sh
+++ /dev/null
@@ -1,33 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.5.8
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'true'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
-
-echo "[ * ] Create .gnupg directory..."
-mkdir -p /root/.gnupg/ && chmod 700 /root/.gnupg/
-
-echo "[ * ] Ensure jail is enabled for sftp or ftp users..."
-shells="rssh|nologin"
-for user in $(grep "$HOMEDIR" /etc/passwd | egrep "$shells" | cut -f 1 -d:); do
-	if [ -d "$HESTIA/data/users/$user" ]; then
-		$BIN/v-add-user-sftp-jail "$user" "no" > /dev/null 2>&1
-	fi
-done
diff --git a/install/upgrade/versions/1.5.9.sh b/install/upgrade/versions/1.5.9.sh
deleted file mode 100644
index e992b84..0000000
--- a/install/upgrade/versions/1.5.9.sh
+++ /dev/null
@@ -1,22 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.5.9
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
diff --git a/install/upgrade/versions/1.6.0.sh b/install/upgrade/versions/1.6.0.sh
deleted file mode 100644
index f82a4bf..0000000
--- a/install/upgrade/versions/1.6.0.sh
+++ /dev/null
@@ -1,133 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.6.0
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'yes'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'yes'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'yes'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'true'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
-
-# Delete compsoser to force update to composer v2
-rm -fr /home/admin/.composer
-
-if [ "$MAIL_SYSTEM" = "exim4" ]; then
-	echo "[ * ] Update exim4 config to support rate limits"
-	# Upgrade config exim for custom limits
-	sed -i '115,250 s/ratelimit             = 200 \/ 1h \/ $authenticated_id/          set acl_c_msg_limit = \${if exists{\/etc\/exim4\/domains\/\${lookup{\$sender_address_domain}dsearch{\/etc\/exim4\/domains\/}}\/limits} {\${extract{1}{:}{\${lookup{\$sender_address_local_part@\$sender_address_domain}lsearch{\/etc\/exim4\/domains\/\${lookup{\$sender_address_domain}dsearch{\/etc\/exim4\/domains\/}}\/limits}}}}} {\${readfile{\/etc\/exim4\/limit.conf}}} }\n ratelimit     = \$acl_c_msg_limit \/ 1h \/ strict\/ \$authenticated_id/g' /etc/exim4/exim4.conf.template
-	sed -i '115,250 s/warn    ratelimit     = 100 \/ 1h \/ strict \/ $authenticated_id/warn    ratelimit     = ${eval:$acl_c_msg_limit \/ 2} \/ 1h \/ strict \/ $authenticated_id/g' /etc/exim4/exim4.conf.template
-	# Add missing limit.conf file
-	cp $HESTIA_INSTALL_DIR/exim/limit.conf /etc/exim4/limit.conf
-	cp $HESTIA_INSTALL_DIR/exim/system.filter /etc/exim4/system.filter
-
-	acl=$(cat /etc/exim4/exim4.conf.template | grep "set acl_m3")
-	if [ -z "$acl" ]; then
-		echo "[ * ] Add support for optional rejecting spam"
-		sed -i 's/ warn    set acl_m1    = no/ warn    set acl_m1    = no \n          set acl_m3    = no/g' /etc/exim4/exim4.conf.template
-		sed -i 's|                          set acl_m1    = yes|              set acl_m1    = yes \n  warn    condition     = \${if exists {/etc/exim4/domains/\$domain/reject_spam}{yes}{no}} \n         set acl_m3    = yes|g' /etc/exim4/exim4.conf.template
-		sed -i 's|         message        = SpamAssassin detected spam (from \$sender_address to \$recipients).|        message        = SpamAssassin detected spam (from $sender_address to $recipients).\n\n  # Deny spam at high score if spam score > SPAM_REJECT_SCORE and delete_spam is enabled\n  deny   message        = This message scored \$spam_score spam points\n          spam           = debian-spamd:true \n          condition      = \${if eq{\$acl_m3}{yes}{yes}{no}} \n          condition      = ${if >{$spam_score_int}{SPAM_REJECT_SCORE}{1}{0}}	|g' /etc/exim4/exim4.conf.template
-	fi
-
-	if ! grep -q "send_via_unauthenticated_smtp_relay" /etc/exim4/exim4.conf.template; then
-		echo '[ * ] Enabling SMTP relay support...'
-		# Add smtp relay router
-		insert='send_via_unauthenticated_smtp_relay:\n  driver = manualroute\n  address_data = SMTP_RELAY_HOST:SMTP_RELAY_PORT\n  domains = !+local_domains\n  require_files = SMTP_RELAY_FILE\n  condition = ${if eq{SMTP_RELAY_USER}{}}\n  transport = remote_smtp\n  route_list = * ${extract{1}{:}{$address_data}}::${extract{2}{:}{$address_data}}\n  no_more\n  no_verify\n'
-
-		line=$(expr $(sed -n '/begin routers/=' /etc/exim4/exim4.conf.template) + 2)
-		sed -i "${line}i $insert" /etc/exim4/exim4.conf.template
-	fi
-fi
-
-if [ -f "/etc/dovecot/conf.d/10-ssl.conf" ]; then
-	sed -i 's|ssl_min_protocol = TLSv1.1|ssl_min_protocol = TLSv1.2|' /etc/dovecot/conf.d/10-ssl.conf
-	if ! grep -q "!TLSv1.1" /etc/dovecot/conf.d/10-ssl.conf; then
-		sed -i 's|ssl_protocols = !SSLv3 !TLSv1|ssl_protocols = !SSLv3 !TLSv1 !TLSv1.1|' /etc/dovecot/conf.d/10-ssl.conf
-	fi
-fi
-
-if [ -f "/etc/default/spamassassin" ]; then
-	echo "[ * ] Enable Samassassin Cronjob"
-	sed -i "s/#CRON=1/CRON=1/" /etc/default/spamassassin
-fi
-
-# Adding LE autorenew cronjob if there are none
-if [ -z "$(grep v-update-lets $HESTIA/data/users/admin/cron.conf)" ]; then
-	min=$(generate_password '012345' '2')
-	hour=$(generate_password '1234567' '1')
-	command="sudo $BIN/v-update-letsencrypt-ssl"
-	$BIN/v-add-cron-job 'admin' "$min" "$hour" '*' '*' '*' "$command"
-fi
-
-# Add apis if they don't exist
-# Changes have been made make sure to overwrite them to prevent issues in the future
-cp -rf $HESTIA_INSTALL_DIR/api $HESTIA/data/
-
-# Update Cloudflare address
-if [ -f /etc/nginx/nginx.conf ] && [ "$(grep 'set_real_ip_from 2405:8100::/32' /etc/nginx/nginx.conf)" = "" ]; then
-	echo "[ * ] Updating nginx configuration with changes to Cloudflare IP addresses"
-	sed -i "/#set_real_ip_from  2405:b500::\/32;/d" /etc/nginx/nginx.conf
-	sed -i "/#set_real_ip_from  2606:4700::\/32;/d" /etc/nginx/nginx.conf
-	sed -i "/#set_real_ip_from  2803:f800::\/32;/d" /etc/nginx/nginx.conf
-	sed -i "/#set_real_ip_from  2c0f:f248::\/32;/d" /etc/nginx/nginx.conf
-	sed -i "/#set_real_ip_from  2a06:98c0::\/29;/d" /etc/nginx/nginx.conf
-	sed -i "s/#set_real_ip_from  2400:cb00::\/32;/# set_real_ip_from 2400:cb00::\/32;\n    # set_real_ip_from 2606:4700::\/32;\n    # set_real_ip_from 2803:f800::\/32;\n    # set_real_ip_from 2405:b500::\/32;\n    # set_real_ip_from 2405:8100::\/32;\n    # set_real_ip_from 2a06:98c0::\/29;\n    # set_real_ip_from 2c0f:f248::\/32;/g" /etc/nginx/nginx.conf
-fi
-
-if [ -n "$PHPMYADMIN_KEY" ]; then
-	echo "[ * ] Refresh PMA SSO key due to update phpmyadmin"
-	$BIN/v-delete-sys-pma-sso quiet
-	$BIN/v-add-sys-pma-sso quiet
-fi
-
-#Fixed an issue with Exim4 and Ubutnu22.04 in beta version
-release=$(lsb_release -sr)
-if [ "$release" = "22.04" ]; then
-	if [ -d "/etc/exim4/" ]; then
-		rm -fr /etc/exim4/exim.conf.template
-		cp -f $HESTIA_INSTALL_DIR/exim/exim4.conf.4.94.template /etc/exim4/exim4.conf.template
-		if [ "$ANTIVIRUS_SYSTEM" = 'clamav-daemon' ]; then
-			sed -i "s/#SPAM/SPAM/g" /etc/exim4/exim4.conf.template
-		fi
-		if [ "$ANTISPAM_SYSTEM" = 'spamassassin' ]; then
-			sed -i "s/#CLAMD/CLAMD/g" /etc/exim4/exim4.conf.template
-		fi
-
-	fi
-fi
-
-# Mute output v-add-sys-sftp-jail out put then enabling sftp on boot
-if [ -f "/etc/cron.d/hestia-sftp" ]; then
-	rm /etc/cron.d/hestia-sftp
-	echo "@reboot root sleep 60 && /usr/local/hestia/bin/v-add-sys-sftp-jail > /dev/null" > /etc/cron.d/hestia-sftp
-fi
-
-ips=$(ls /usr/local/hestia/data/ips/ | wc -l)
-release=$(lsb_release -s -i)
-if [ $release = 'Ubuntu' ]; then
-	if [ $ips -gt 1 ]; then
-		add_upgrade_message "Warning: Please check your network configuration!\n\n A bug has been discovered that might affect your setup and can lead to issues after a system reboot. Please review your network configuration. See https://github.com/hestiacp/hestiacp/pull/2612#issuecomment-1135571835 for more info regarding this issue!"
-		$HESTIA/bin/v-add-user-notification admin "Warning: Please check your network configuration!\n\n A bug has been discovered that might affect your setup and can lead to issues after a system reboot. Please review your network configuration. <a href='https://github.com/hestiacp/hestiacp/pull/2612#issuecomment-1135571835'>More info</a>"
-	fi
-fi
-
-if [ -d /etc/phpmyadmin/conf.d ]; then
-	for file in /etc/phpmyadmin/conf.d/*; do
-		if [ -z "$(grep -i 'information_schema' $file)" ]; then
-			echo "[ * ] Update phpMyAdmin server configuration"
-			echo "\$cfg['Servers'][\$i]['hide_db'] = 'information_schema';" >> $file
-		fi
-	done
-fi
diff --git a/install/upgrade/versions/1.6.1.sh b/install/upgrade/versions/1.6.1.sh
deleted file mode 100644
index 2794401..0000000
--- a/install/upgrade/versions/1.6.1.sh
+++ /dev/null
@@ -1,51 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.6.1
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
-
-# Fix exim rate limit send issue
-if [ "$MAIL_SYSTEM" = "exim4" ]; then
-	acl=$(cat /etc/exim4/exim4.conf.template | grep '${extract{1}{:}{${lookup{$sender_address_local_part@$sender_address_domain}')
-	if [ ! -z "$acl" ]; then
-		echo "[ * ] Fixed an issue with rate limits and alias mail addresses"
-		sed -i 's/${extract{1}{:}{${lookup{$sender_address_local_part@$sender_address_domain}/${extract{1}{:}{${lookup{$authenticated_id}/' /etc/exim4/exim4.conf.template
-	fi
-	spamscore=$(cat /etc/exim4/exim4.conf.template | grep 'SPAM_REJECT_SCORE =')
-	if [ -z "$spamscore" ]; then
-		echo "[ * ] Fixed an issue reject spam not working properly."
-		sed -i '/SPAM_SCORE = .*/a SPAM_REJECT_SCORE = 100' /etc/exim4/exim4.conf.template
-		sed -i '/          set acl_m1    = yes/a    warn    condition     = ${if exists {/etc/exim4/domains/$domain/reject_spam}{yes}{no}}\n          set acl_m3    = yes' /etc/exim4/exim4.conf.template
-	fi
-
-fi
-
-# With setup from installer
-if [ -f "/etc/apt/sources.list.d/hestia-beta.list" ]; then
-	echo "[ ! ] Change to stable release!"
-	rm /etc/apt/sources.list.d/hestia-beta.list
-	sed -i 's/#//g' /etc/apt/sources.list.d/hestia.list
-fi
-check=$(cat /etc/apt/sources.list.d/hestia.list | grep "beta.hestiacp.com")
-if [ ! -z "$check" ]; then
-	echo "[ ! ] Change to stable release!"
-	sed -i '/beta.hestiacp.com/d' /etc/apt/sources.list.d/hestia.list
-	sed -i 's/#//g' /etc/apt/sources.list.d/hestia.list
-fi
diff --git a/install/upgrade/versions/1.6.10.sh b/install/upgrade/versions/1.6.10.sh
deleted file mode 100644
index c5822e0..0000000
--- a/install/upgrade/versions/1.6.10.sh
+++ /dev/null
@@ -1,25 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.6.9
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
-
-# Delete all tmp files create by hestia that are left in place
-rm -fr /tmp/vst*
diff --git a/install/upgrade/versions/1.6.12.sh b/install/upgrade/versions/1.6.12.sh
deleted file mode 100644
index 9179736..0000000
--- a/install/upgrade/versions/1.6.12.sh
+++ /dev/null
@@ -1,33 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.6.12
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
-
-if [ -f "/etc/fail2ban/jail.local" ]; then
-	sed -i "s|/var/log/mysql.log|/var/log/mysql/error.log|g" /etc/fail2ban/jail.local
-fi
-
-# Fixed firewall loading failed after reboot, applying update to hestia-iptables Systemd unit.
-if [ "$FIREWALL_SYSTEM" = "iptables" ]; then
-	echo "[ * ] Update loading firewall rules service..."
-	$BIN/v-delete-sys-firewall
-	$BIN/v-add-sys-firewall
-fi
diff --git a/install/upgrade/versions/1.6.13.sh b/install/upgrade/versions/1.6.13.sh
deleted file mode 100644
index 34ec6e6..0000000
--- a/install/upgrade/versions/1.6.13.sh
+++ /dev/null
@@ -1,22 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.6.13
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
diff --git a/install/upgrade/versions/1.6.14.sh b/install/upgrade/versions/1.6.14.sh
deleted file mode 100644
index a8477d7..0000000
--- a/install/upgrade/versions/1.6.14.sh
+++ /dev/null
@@ -1,29 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.6.14
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
-
-# Clean up firewall rules restore file.
-if [ "$FIREWALL_SYSTEM" = "iptables" ]; then
-	add_upgrade_message "About iptables rules [non-urgent]\n\nJust in case, if you added custom iptables rules in an unsupported way, they may have been lost.\n\nSee this issue to learn more:\nhttps://github.com/hestiacp/hestiacp/issues/3128"
-	echo "[ * ] Clean up firewall rules restore file..."
-	$BIN/v-update-firewall
-fi
diff --git a/install/upgrade/versions/1.6.2.sh b/install/upgrade/versions/1.6.2.sh
deleted file mode 100644
index 0c2687b..0000000
--- a/install/upgrade/versions/1.6.2.sh
+++ /dev/null
@@ -1,38 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.6.2
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
-
-if [ "$MAIL_SYSTEM" == "exim4" ]; then
-	alc=$(cat /etc/exim4/exim4.conf.template | grep '${lookup{${domain:$authenticated_id}}dsearch{/etc/exim4/domains/}}/limits')
-	if [ -z "$alc" ]; then
-		sed -i 's| set acl_c_msg_limit|#string1\n#replaceme|' /etc/exim4/exim4.conf.template
-		sed -i '/#replaceme/d' /etc/exim4/exim4.conf.template
-		sed -i 's|#string1|set acl_c_msg_limit  = \${if exists{/etc/exim4/domains/\${lookup{\${domain:\$authenticated_id}}dsearch{/etc/exim4/domains/}}/limits}{\${lookup {\$authenticated_id} lsearch{/etc/exim4/domains/\${lookup{${domain:\$authenticated_id}}dsearch{/etc/exim4/domains/}}/limits}{\$value}{\${readfile{/etc/exim4/limit.conf}}}}}{\${readfile{/etc/exim4/limit.conf}}} }|g' /etc/exim4/exim4.conf.template
-	fi
-
-	system_filter=$(cat /etc/exim4/exim4.conf.template | grep 'system_filter')
-	if [ -z "$system_filter" ]; then
-		sed -i '/SMTP_RELAY_PASS = \${lookup{pass}lsearch{SMTP_RELAY_FILE}}/a #shouldberemoved\n# Custom Filter\nsystem_filter = \/etc\/exim4\/system.filter\nsystem_filter_user = Debian-exim' /etc/exim4/exim4.conf.template
-		# Keep the spacing between the reley_pass and Custom Filter we need to insert a dummy text and remove it later on
-		sed -i 's/#shouldberemoved//g' /etc/exim4/exim4.conf.template
-	fi
-fi
diff --git a/install/upgrade/versions/1.6.3.sh b/install/upgrade/versions/1.6.3.sh
deleted file mode 100644
index abdada1..0000000
--- a/install/upgrade/versions/1.6.3.sh
+++ /dev/null
@@ -1,30 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.6.3
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'yes'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'yes'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
-
-if [ "$MAIL_SYSTEM" == "exim4" ]; then
-	host=$(cat /etc/exim4/exim4.conf.template | grep hosts_try_fastopen)
-	if [ -z "$host" ]; then
-		echo "[ * ] Fix an issue with sending large attachments to Google / Gmail"
-		sed -i '/dkim_strict = .*/a hosts_try_fastopen = !*.l.google.com' /etc/exim4/exim4.conf.template
-	fi
-fi
diff --git a/install/upgrade/versions/1.6.4.sh b/install/upgrade/versions/1.6.4.sh
deleted file mode 100644
index 8abd085..0000000
--- a/install/upgrade/versions/1.6.4.sh
+++ /dev/null
@@ -1,22 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.6.4
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
diff --git a/install/upgrade/versions/1.6.5.sh b/install/upgrade/versions/1.6.5.sh
deleted file mode 100644
index cec1ea8..0000000
--- a/install/upgrade/versions/1.6.5.sh
+++ /dev/null
@@ -1,22 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.6.6
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
diff --git a/install/upgrade/versions/1.6.6.sh b/install/upgrade/versions/1.6.6.sh
deleted file mode 100644
index f89e985..0000000
--- a/install/upgrade/versions/1.6.6.sh
+++ /dev/null
@@ -1,30 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.6.6
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
-
-if [ -f "/etc/roundcube/config.inc.php" ]; then
-	if [ -n "$(grep 'ssl://localhost' /etc/roundcube/config.inc.php)" ]; then
-		# Echo prepare for 1.6.0 update
-		sed -i "s|ssl://localhost|localhost|g" /etc/roundcube/config.inc.php
-		sed -i "s|993|143|g" /etc/roundcube/config.inc.php
-	fi
-fi
diff --git a/install/upgrade/versions/1.6.7.sh b/install/upgrade/versions/1.6.7.sh
deleted file mode 100644
index 83e6e28..0000000
--- a/install/upgrade/versions/1.6.7.sh
+++ /dev/null
@@ -1,30 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.6.7
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'yes'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
-
-if [ -f "/etc/roundcube/config.inc.php" ]; then
-	sed -i "s/\$config\['auto_create_user'] = false;/\$config\['auto_create_user'] = true;/g" /etc/roundcube/config.inc.php
-	sed -i "s/\$config\['prefer_html'] = false;/\$config\['prefer_html'] = true;/g" /etc/roundcube/config.inc.php
-
-	#For older installs
-	sed -i "s/\$config\['default_host']/\$config\['imap_host']/g" /etc/roundcube/config.inc.php
-fi
diff --git a/install/upgrade/versions/1.6.8.sh b/install/upgrade/versions/1.6.8.sh
deleted file mode 100644
index 04463f4..0000000
--- a/install/upgrade/versions/1.6.8.sh
+++ /dev/null
@@ -1,46 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version unreleased
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
-
-if [ -f /etc/nginx/nginx.conf ]; then
-	sed -i "s/fastcgi_buffers                 4 256k;/fastcgi_buffers                 8 256k;/g" /etc/nginx/nginx.conf
-fi
-
-# Sync up config files #2819
-if [ -f "/etc/roundcube/config.inc.php" ]; then
-	sed -i "s/?>//" /etc/roundcube/config.inc.php
-	sed -i "s/?>//" /etc/roundcube/mimetypes.php
-fi
-
-for version in $($HESTIA/bin/v-list-sys-php plain); do
-	# Increase max upload and max post size
-	sed -i "s/upload_max_filesize = 2M/upload_max_filesize = 100M/g" /etc/php/$version/fpm/php.ini
-	sed -i "s/post_max_size = 8M/post_max_size = 100M/g" /etc/php/$version/fpm/php.ini
-	sed -i "s/max_execution_time = 30$/max_execution_time = 60/g" /etc/php/$version/fpm/php.ini
-done
-
-if [ -d /etc/roundcube ]; then
-	if [ ! -f /etc/logrotate.d/roundcube ]; then
-		echo "[ * ] Create config roundcube logrotate file"
-		cp -f $HESTIA_INSTALL_DIR/logrotate/roundcube /etc/logrotate.d/
-	fi
-fi
diff --git a/install/upgrade/versions/1.6.9.sh b/install/upgrade/versions/1.6.9.sh
deleted file mode 100644
index 21835f3..0000000
--- a/install/upgrade/versions/1.6.9.sh
+++ /dev/null
@@ -1,28 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version unreleased
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'no'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'no'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
-
-# Update api key permissions
-if [ -f "$HESTIA/data/api/sync-dns-cluster" ]; then
-	rm $HESTIA/data/api/sync-dns-cluster
-	cp $HESTIA/install/deb/api/sync-dns-cluster $HESTIA/data/api/sync-dns-cluster
-fi
diff --git a/install/upgrade/versions/1.7.0.sh b/install/upgrade/versions/1.7.0.sh
deleted file mode 100644
index 6922d03..0000000
--- a/install/upgrade/versions/1.7.0.sh
+++ /dev/null
@@ -1,121 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.7.0
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### upgrade_config_set_value only accepts true or false.                    #######
-#######                                                                         #######
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-# load config because we need to know if proftpd is installed
-
-# Includes
-# shellcheck source=/etc/hestiacp/hestia.conf
-source /etc/hestiacp/hestia.conf
-# shellcheck source=/usr/local/hestia/func/main.sh
-source $HESTIA/func/main.sh
-# shellcheck source=/usr/local/hestia/func/ip.sh
-source $HESTIA/func/ip.sh
-# load config file
-source_conf "$HESTIA/conf/hestia.conf"
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'true'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'true'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'true'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'true'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
-
-# Make sure to sync install quoteshell arg
-if [ "$FILE_MANAGER" = "true" ]; then
-	echo "[ * ] Force update filemanager..."
-	$HESTIA/bin/v-delete-sys-filemanager quiet
-	$HESTIA/bin/v-add-sys-filemanager quiet
-fi
-
-packages=$(ls --sort=time $HESTIA/data/packages | grep .pkg)
-echo "[ * ] Update existing packages to support rate limit mail accounts..."
-for package in $packages; do
-	if [ -z "$(grep -e 'RATE_LIMIT' $HESTIA/data/packages/$package)" ]; then
-		echo "RATE_LIMIT='200'" >> $HESTIA/data/packages/$package
-	fi
-done
-
-if [ -z "$(grep -e 'condition =  ${lookup{$local_part@$domain}lsearch{/etc/exim4/domains/${lookup{$domain}dsearch{/etc/exim4/domains/}}/aliases}{false}{true}}' /etc/exim4/exim4.conf.template)" ]; then
-	for line in $(sed -n '/redirect_router = dnslookup/=' /etc/exim4/exim4.conf.template); do
-		testline=$((line - 1))
-		newline=$((line + 1))
-		if [ "$(awk NR==$testline /etc/exim4/exim4.conf.template)" = "  file_transport = local_delivery" ]; then
-			# Add new line
-			sed -i "$newline i \ \ condition = \${lookup{$local_part@\$domain}lsearch{/etc/exim4/domains/\${lookup{\$domain}dsearch{/etc/exim4/domains/}}/aliases}{false}{true}}" /etc/exim4/exim4.conf.template
-		fi
-	done
-fi
-
-# Allow Email@domain.com for login
-if [ -f "/etc/dovecot/conf.d/10-auth.conf" ]; then
-	sed -i "s/auth_username_format = %u/auth_username_format = %Lu/g" /etc/dovecot/conf.d/10-auth.conf
-fi
-
-# rename /var/run/xx to /run/
-for file in /etc/dovecot/dovecot.conf /etc/clamav/clamd.conf /etc/exim/exim.conf.template /etc/logrotate.d/apache2 /etc/logrotate.d/nginx /etc/mysql/my.cnf /etc/nginx/nginx.conf; do
-	if [ -f "$file" ]; then
-		echo "[ * ] Update $file legacy /var/run/ to /run/..."
-		sed -i 's|/var/run/|/run/|g' $file
-	fi
-done
-# Update any custom php templates
-for file in $HESTIA/data/templates/web/php-fpm/*; do
-	echo "[ * ] Update $file legacy /var/run/ to /run/..."
-	sed -i 's|/var/run/|/run/|g' $file
-done
-
-for file in /etc/php/*/fpm/pool.d/www.conf; do
-	echo "[ * ] Update $file legacy /var/run/ to /run/..."
-	sed -i 's|/var/run/|/run/|g' $file
-done
-
-#update proftpd
-if [ "$FTP_SYSTEM" = 'proftpd' ]; then
-	contains_conf_d=$(grep -c "Include /etc/proftpd/conf.d/\*.conf" "/etc/proftpd/proftpd.conf")
-	# the line below is for testing only:
-	#        echo "contains proftpd? $contains_conf_d"
-	if [ $contains_conf_d = 0 ]; then
-		sed -i 's/Include \/etc\/proftpd\/tls.conf/&\nInclude \/etc\/proftpd\/conf.d\/*.conf/' /etc/proftpd/proftpd.conf
-	fi
-	$BIN/v-restart-ftp
-fi
-
-if echo "$BACKUP_SYSTEM" | grep "google" > /dev/null; then
-	echo "[ ! ] Deprecation notice: Backup via Google Cloud has been removed setup backup again via Rclone to reinstate the backup and restore capebilities!"
-	add_upgrade_message "Deprecation notice: Backup via Google Cloud has been removed setup backup again via Rclone to reinstate the backup and restore capebilities!"
-fi
-
-if [ -f /etc/logrotate.d/httpd-prerotate/awstats ]; then
-	echo "[ * ] Update Awstats prerotate to Hestia update method..."
-	# Replace awstatst function
-	cp -f $HESTIA_INSTALL_DIR/logrotate/httpd-prerotate/awstats /etc/logrotate.d/httpd-prerotate/
-fi
-
-if [ "$PHPMYADMIN_KEY" != "" ]; then
-	echo "[ * ] Refresh hestia-sso for PMA..."
-	$BIN/v-delete-sys-pma-sso quiet
-	$BIN/v-add-sys-pma-sso quiet
-fi
-
-if [ -f /etc/nginx/nginx.conf ] && [ ! -f /etc/nginx/conf.d/cloudflare.inc ]; then
-	echo "[ * ] Enable support for updating Cloudflare Ips..."
-	sed -i '/set_real_ip_from/d' /etc/nginx/nginx.conf
-	sed -i '/real_ip_header/d' /etc/nginx/nginx.conf
-	sed -i 's|# Cloudflare https://www.cloudflare.com/ips|# Cloudflare https://www.cloudflare.com/ips\n    include /etc/nginx/conf.d/cloudflare.inc;|g' /etc/nginx/nginx.conf
-	# At a later stage a function  will run and will load all the new rules
-fi
diff --git a/install/upgrade/versions/1.7.1.sh b/install/upgrade/versions/1.7.1.sh
deleted file mode 100644
index e10072e..0000000
--- a/install/upgrade/versions/1.7.1.sh
+++ /dev/null
@@ -1,46 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.7.1
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### upgrade_config_set_value only accepts true or false.                    #######
-#######                                                                         #######
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'true'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'true'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
-
-# Moved from 1.6.15.sh
-if ! (grep -q 'v-change-user-password' $HESTIA/data/api/billing); then
-	sed -i "s|v-make-tmp-file'|v-make-tmp-file,v-change-user-password'|g" $HESTIA/data/api/billing
-fi
-
-# Apply update for path change of built-in IPset blacklist.sh
-if [ "$FIREWALL_SYSTEM" = "iptables" ]; then
-	rm -f $HESTIA/data/firewall/ipset/blacklist.sh
-
-	if ($BIN/v-list-firewall-ipset plain | grep -q '/install/deb/firewall/ipset/blacklist.sh'); then
-		echo "[ * ] Update the path of IPset blacklist.sh..."
-		sed -i 's|/install/deb/firewall/ipset/blacklist.sh|/install/common/firewall/ipset/blacklist.sh|g' $HESTIA/data/firewall/ipset.conf
-	fi
-fi
-
-if [ "$WEB_SYSTEM" = "apache2" ]; then
-	if ! (grep -q "$WEBMAIL_ALIAS.*.conf" /etc/apache2/apache2.conf); then
-		echo "[ * ] Update /etc/apache2/apache2.conf..."
-		sed -i "s/IncludeOptional conf.d\/domains\/\*.conf/IncludeOptional conf.d\/domains\/$WEBMAIL_ALIAS.*.conf\nIncludeOptional conf.d\/domains\/\*.conf/g" /etc/apache2/apache2.conf
-	fi
-fi
diff --git a/install/upgrade/versions/1.7.2.sh b/install/upgrade/versions/1.7.2.sh
deleted file mode 100644
index f636a38..0000000
--- a/install/upgrade/versions/1.7.2.sh
+++ /dev/null
@@ -1,24 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.7.2
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### upgrade_config_set_value only accepts true or false.                    #######
-#######                                                                         #######
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
diff --git a/install/upgrade/versions/1.7.3.sh b/install/upgrade/versions/1.7.3.sh
deleted file mode 100644
index ecca2f8..0000000
--- a/install/upgrade/versions/1.7.3.sh
+++ /dev/null
@@ -1,29 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.7.3
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### upgrade_config_set_value only accepts true or false.                    #######
-#######                                                                         #######
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
-
-if grep -q 'drop    message       = Helo name contains an IP address (HELO was $sender_helo_name) and not is valid' /etc/exim4/exim4.conf.template; then
-	echo "[ * ] Update exim4.conf.template ..."
-	patch /etc/exim4/exim4.conf.template $HESTIA/install/upgrade/patch/3462-exim-helo-autenticted-users.patch
-fi
diff --git a/install/upgrade/versions/1.7.4.sh b/install/upgrade/versions/1.7.4.sh
deleted file mode 100644
index c90ef4e..0000000
--- a/install/upgrade/versions/1.7.4.sh
+++ /dev/null
@@ -1,24 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.7.4
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### upgrade_config_set_value only accepts true or false.                    #######
-#######                                                                         #######
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
diff --git a/install/upgrade/versions/1.7.5.sh b/install/upgrade/versions/1.7.5.sh
deleted file mode 100644
index 40e7609..0000000
--- a/install/upgrade/versions/1.7.5.sh
+++ /dev/null
@@ -1,24 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.7.5
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### upgrade_config_set_value only accepts true or false.                    #######
-#######                                                                         #######
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
diff --git a/install/upgrade/versions/1.7.6.sh b/install/upgrade/versions/1.7.6.sh
deleted file mode 100644
index 69866b0..0000000
--- a/install/upgrade/versions/1.7.6.sh
+++ /dev/null
@@ -1,24 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.7.6
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### upgrade_config_set_value only accepts true or false.                    #######
-#######                                                                         #######
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
diff --git a/install/upgrade/versions/1.7.7.sh b/install/upgrade/versions/1.7.7.sh
deleted file mode 100644
index e8a8a52..0000000
--- a/install/upgrade/versions/1.7.7.sh
+++ /dev/null
@@ -1,24 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.7.7
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### upgrade_config_set_value only accepts true or false.                    #######
-#######                                                                         #######
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
diff --git a/install/upgrade/versions/1.8.0.sh b/install/upgrade/versions/1.8.0.sh
deleted file mode 100644
index 7277123..0000000
--- a/install/upgrade/versions/1.8.0.sh
+++ /dev/null
@@ -1,298 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.8.0
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### upgrade_config_set_value only accepts true or false.                    #######
-#######                                                                         #######
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'true'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'true'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'true'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
-
-os_release="$(lsb_release -s -i | tr "[:upper:]" "[:lower:]")-$(lsb_release -s -r)"
-
-if [ "$IMAP_SYSTEM" = "dovecot" ]; then
-	if ! grep -qw "^extra_groups = mail$" /etc/dovecot/conf.d/10-master.conf 2> /dev/null; then
-		sed -i "s/^service auth {/service auth {\n  extra_groups = mail\n/g" /etc/dovecot/conf.d/10-master.conf
-	fi
-
-	if [ -f /etc/dovecot/conf.d/90-sieve.conf ]; then
-		if ! grep -q "sieve_vacation_send_from_recipient" /etc/dovecot/conf.d/90-sieve.conf 2> /dev/null; then
-			sed -i "s/^plugin {/plugin {\n  # This setting determines whether vacation messages are sent with the SMTP MAIL FROM envelope address set to the recipient address of the Sieve script owner.\n  sieve_vacation_send_from_recipient = yes\n/g" /etc/dovecot/conf.d/90-sieve.conf
-		fi
-	fi
-fi
-
-if [ -f /etc/fail2ban/jail.local ]; then
-	# Add phpmyadmin rule
-	if ! grep -qw "phpmyadmin-auth" /etc/fail2ban/jail.local 2> /dev/null; then
-		sed -i '/\[recidive\]/i [phpmyadmin-auth]\nenabled  = true\nfilter   = phpmyadmin-syslog\naction   = hestia[name=WEB]\nlogpath  = /var/log/auth.log\nmaxretry = 5\n' /etc/fail2ban/jail.local
-	fi
-fi
-
-if [ "$MAIL_SYSTEM" = "exim4" ]; then
-	if [ "$os_release" != "debian-10" ]; then
-		# Exclude Debian 10...
-		echo "[ * ] Disable SMTPUTF8 for Exim for now"
-		if ! grep -qw "^smtputf8_advertise_hosts =" /etc/exim4/exim4.conf.template 2> /dev/null; then
-			sed -i "/^domainlist local_domains = dsearch;\/etc\/exim4\/domains/i smtputf8_advertise_hosts =" /etc/exim4/exim4.conf.template
-		fi
-	fi
-fi
-
-# Apply the update for existing users to enable the "Enhanced and Optimized TLS" feature
-echo '[ * ] Enable the "Enhanced and Optimized TLS" feature...'
-
-# Configuring global OpenSSL options
-tls13_ciphers="TLS_AES_128_GCM_SHA256:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_256_GCM_SHA384"
-
-if ! grep -qw "^[hestia_openssl_sect]$" /etc/ssl/openssl.cnf 2> /dev/null; then
-	if [ "$os_release" = "debian-10" ] || [ "$os_release" = "debian-11" ]; then
-		sed -i '/^system_default = system_default_sect$/a system_default = hestia_openssl_sect\n\n[hestia_openssl_sect]\nCiphersuites = '"$tls13_ciphers"'\nOptions = PrioritizeChaCha' /etc/ssl/openssl.cnf
-	elif [ "$os_release" = "debian-12" ]; then
-		if ! grep -qw "^ssl_conf = ssl_sect$" /etc/ssl/openssl.cnf 2> /dev/null; then
-			sed -i '/providers = provider_sect$/a ssl_conf = ssl_sect' /etc/ssl/openssl.cnf
-		fi
-
-		if ! grep -qw "^[ssl_sect]$" /etc/ssl/openssl.cnf 2> /dev/null; then
-			sed -i '$a \\n[ssl_sect]\nsystem_default = hestia_openssl_sect\n\n[hestia_openssl_sect]\nCiphersuites = '"$tls13_ciphers"'\nOptions = PrioritizeChaCha' /etc/ssl/openssl.cnf
-		elif grep -qw "^system_default = system_default_sect$" /etc/ssl/openssl.cnf 2> /dev/null; then
-			sed -i '/^system_default = system_default_sect$/a system_default = hestia_openssl_sect\n\n[hestia_openssl_sect]\nCiphersuites = '"$tls13_ciphers"'\nOptions = PrioritizeChaCha' /etc/ssl/openssl.cnf
-		fi
-	elif [ "$os_release" = "ubuntu-20.04" ]; then
-		if ! grep -qw "^openssl_conf = default_conf$" /etc/ssl/openssl.cnf 2> /dev/null; then
-			sed -i '/^oid_section		= new_oids$/a \\n# System default\nopenssl_conf = default_conf' /etc/ssl/openssl.cnf
-		fi
-
-		if ! grep -qw "^[default_conf]$" /etc/ssl/openssl.cnf 2> /dev/null; then
-			sed -i '$a [default_conf]\nssl_conf = ssl_sect\n\n[ssl_sect]\nsystem_default = hestia_openssl_sect\n\n[hestia_openssl_sect]\nCiphersuites = '"$tls13_ciphers"'\nOptions = PrioritizeChaCha' /etc/ssl/openssl.cnf
-		elif grep -qw "^system_default = system_default_sect$" /etc/ssl/openssl.cnf 2> /dev/null; then
-			sed -i '/^system_default = system_default_sect$/a system_default = hestia_openssl_sect\n\n[hestia_openssl_sect]\nCiphersuites = '"$tls13_ciphers"'\nOptions = PrioritizeChaCha' /etc/ssl/openssl.cnf
-		fi
-	elif [ "$os_release" = "ubuntu-22.04" ]; then
-		sed -i '/^system_default = system_default_sect$/a system_default = hestia_openssl_sect\n\n[hestia_openssl_sect]\nCiphersuites = '"$tls13_ciphers"'\nOptions = PrioritizeChaCha' /etc/ssl/openssl.cnf
-	fi
-fi
-
-# Update server configuration files
-tls12_ciphers="ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:DHE-RSA-AES256-SHA256"
-
-if [ "$IMAP_SYSTEM" = "dovecot" ]; then
-	if grep -qw "^ssl_min_protocol = TLSv1.2$" /etc/dovecot/conf.d/10-ssl.conf 2> /dev/null; then
-		sed -i '/^# See #2012 for TLSv1.1 to 1.2 upgrade$/d;/^ssl_cipher_list = .\+$/d;s/^ssl_min_protocol = TLSv1.2/ssl_cipher_list = '"$tls12_ciphers"'\nssl_min_protocol = TLSv1.2/' /etc/dovecot/conf.d/10-ssl.conf
-	elif grep -qw "^ssl_protocols = \!SSLv3 \!TLSv1 \!TLSv1.1$" /etc/dovecot/conf.d/10-ssl.conf 2> /dev/null; then
-		sed -i '/^# See #2012 for TLSv1.1 to 1.2 upgrade$/d;/^ssl_cipher_list = .\+$/d;s/^ssl_protocols = !SSLv3 !TLSv1 !TLSv1.1/ssl_cipher_list = '"$tls12_ciphers"'\nssl_protocols = !SSLv3 !TLSv1 !TLSv1.1/' /etc/dovecot/conf.d/10-ssl.conf
-	fi
-fi
-
-if [ "$MAIL_SYSTEM" = "exim4" ]; then
-	if grep -qw "^tls_on_connect_ports = 465$" /etc/exim4/exim4.conf.template 2> /dev/null; then
-		sed -i '/^tls_require_ciphers = .\+$/d;s/^tls_on_connect_ports = 465/tls_on_connect_ports = 465\ntls_require_ciphers = PERFORMANCE:-RSA:-VERS-ALL:+VERS-TLS1.2:+VERS-TLS1.3:%SERVER_PRECEDENCE/' /etc/exim4/exim4.conf.template
-	fi
-fi
-
-if [ "$FTP_SYSTEM" = "proftpd" ]; then
-	if grep -qw "^TLSProtocol                             TLSv1.2$" /etc/proftpd/tls.conf 2> /dev/null; then
-		sed -i '/^TLSCipherSuite .\+$/d;/^TLSServerCipherPreference .\+$/d;s/^TLSProtocol                             TLSv1.2/TLSCipherSuite                          '"$tls12_ciphers"'\nTLSProtocol                             TLSv1.2 TLSv1.3\nTLSServerCipherPreference               on/;s/^#TLSOptions                                                     AllowClientRenegotiations/#TLSOptions                      AllowClientRenegotiations/;s/^TLSOptions                       NoSessionReuseRequired AllowClientRenegotiations/TLSOptions                      NoSessionReuseRequired AllowClientRenegotiations/' /etc/proftpd/tls.conf
-	fi
-fi
-
-if [ "$FTP_SYSTEM" = "vsftpd" ]; then
-	if grep -q "^ssl_ciphers=.\+$" /etc/vsftpd/vsftpd.conf 2> /dev/null; then
-		sed -i 's/^ssl_ciphers=.\+$/ssl_ciphers='"$tls12_ciphers"'/' /etc/vsftpd/vsftpd.conf
-	fi
-fi
-
-if [ "$WEB_SYSTEM" = "nginx" ] || [ "$PROXY_SYSTEM" = "nginx" ]; then
-	# Little trick to bypass on my private fork :)
-	if ! grep -q "quic_bpf" /etc/nginx/nginx.conf && ! grep -q "spdy_headers_comp" /etc/nginx/nginx.conf; then
-		# Syncing "/etc/nginx/nginx.conf" with mainline, to fix the **** caused by formatter or forgetting to apply updates
-		echo "[ * ] Syncing NGINX configuration with mainline..."
-
-		trap 'rm -fr "$dir_for_compare" /etc/nginx/nginx.conf-staging' EXIT
-		dir_for_compare="$(mktemp -d)"
-		nginx_conf_local="$dir_for_compare"/nginx.conf-local
-		nginx_conf_commit="$dir_for_compare"/nginx.conf-commit
-
-		sed 's|https://www.cloudflare.com/||;/^[ \t]\+resolver .\+;$/d;/^[ \t]\+# Cache settings$/d;/^[ \t]\+# Proxy cache$/d' /etc/nginx/nginx.conf | sed ':l;N;$!bl;s/[ \n\t]*//g' > "$nginx_conf_local"
-
-		# For installations before v1.6.8 (from commit 9b544be to commit b2ad154)
-		curl -fsLm5 --retry 2 https://raw.githubusercontent.com/hestiacp/hestiacp/b2ad1549a21655837056e4b7883970d51a4b324f/install/deb/nginx/nginx.conf \
-			| sed 's/fastcgi_buffers                 4 256k;/fastcgi_buffers                 8 256k;/g;s|/var/run/|/run/|g;/set_real_ip_from/d;/real_ip_header/d;s|# Cloudflare https://www.cloudflare.com/ips|# Cloudflare https://www.cloudflare.com/ips\n    include /etc/nginx/conf.d/cloudflare.inc;|g' \
-			| sed 's|https://www.cloudflare.com/||;/^[ \t]\+resolver .\+;$/d;/^[ \t]\+# Cache settings$/d;/^[ \t]\+# Proxy cache$/d' | sed ':l;N;$!bl;s/[ \n\t]*//g' > "$nginx_conf_commit"-b2ad154
-
-		# For installations after v1.6.8 but before v1.7.0 (from commit b2ad154 to commit 015b20a)
-		curl -fsLm5 --retry 2 https://raw.githubusercontent.com/hestiacp/hestiacp/015b20ae1ffb82faaf58b41a5dc9ad1b078b785f/install/deb/nginx/nginx.conf \
-			| sed 's|/var/run/|/run/|g;/set_real_ip_from/d;/real_ip_header/d;s|# Cloudflare https://www.cloudflare.com/ips|# Cloudflare https://www.cloudflare.com/ips\n    include /etc/nginx/conf.d/cloudflare.inc;|g' \
-			| sed 's|https://www.cloudflare.com/||;/^[ \t]\+resolver .\+;$/d;/^[ \t]\+# Cache settings$/d;/^[ \t]\+# Proxy cache$/d' | sed ':l;N;$!bl;s/[ \n\t]*//g' > "$nginx_conf_commit"-015b20a
-
-		# For installations after v1.7.0 (commit 555f892)
-		curl -fsLm5 --retry 2 https://raw.githubusercontent.com/hestiacp/hestiacp/555f89243e54e02458586ae4f7999458cc9d33e9/install/deb/nginx/nginx.conf \
-			| sed 's|https://www.cloudflare.com/||;/^[ \t]\+resolver .\+;$/d;/^[ \t]\+# Cache settings$/d;/^[ \t]\+# Proxy cache$/d' | sed ':l;N;$!bl;s/[ \n\t]*//g' > "$nginx_conf_commit"-555f892
-
-		for commit in b2ad154 015b20a 555f892; do
-			if cmp -s "$nginx_conf_local" "$nginx_conf_commit"-"$commit" 2> /dev/null; then
-				nginx_conf_compare="same"
-				cp -f "$HESTIA_INSTALL_DIR"/nginx/nginx.conf /etc/nginx
-				break
-			fi
-		done
-
-		if [ "$nginx_conf_compare" != "same" ]; then
-			echo -e "[ ! ] Manual action required, please view:\n[ - ] $HESTIA_BACKUP/message.log"
-			add_upgrade_message "Manual Action Required [IMPORTANT]\n\nTo enable the \"Enhanced and Optimized TLS\" feature, we must update the NGINX configuration file (/etc/nginx/nginx.conf).\n\nBut for unknown reason or you edited it, may not be fully apply all the changes in this upgrade.\n\nPlease follow the default configuration file to sync it:\n$HESTIA_INSTALL_DIR/nginx/nginx.conf\n\nBacked up configuration file:\n$HESTIA_BACKUP/conf/nginx/nginx.conf\n\nLearn more:\nhttps://github.com/hestiacp/hestiacp/pull/3555\n\n"
-			"$BIN"/v-add-user-notification admin "IMPORTANT: Manual Action Required" '<p>To enable the "Enhanced and Optimized TLS" feature, we must update the NGINX configuration file at <code>/etc/nginx/nginx.conf</code>.</p><p>But for unknown reason or you edited it, may not be fully apply all the changes in this upgrade.</p><p>Please follow the default configuration file to sync it:<br><code>'"$HESTIA_INSTALL_DIR"'/nginx/nginx.conf</code></p><p>Backed up configuration file:<br><code>'"$HESTIA_BACKUP"'/conf/nginx/nginx.conf</code></p><p>Visit PR <a href="https://github.com/hestiacp/hestiacp/pull/3555" target="_blank">#3555</a> on GitHub to learn more.</p>'
-
-			sed -i "s/""$(grep -m 1 "IMPORTANT: Manual Action Required" "$HESTIA"/data/users/admin/notifications.conf | awk '{print $1}')""/NID='1'/" "$HESTIA"/data/users/admin/notifications.conf
-
-			cp -f /etc/nginx/nginx.conf /etc/nginx/nginx.conf-staging
-
-			# Apply previously missed updates
-			sed -i 's/fastcgi_buffers                 4 256k;/fastcgi_buffers                 8 256k;/;s|https://www.cloudflare.com/||;s/# Cache settings/# Proxy cache/' /etc/nginx/nginx.conf-staging
-
-			# Formatting
-			echo "" >> /etc/nginx/nginx.conf-staging
-			sed -i '/^[ \t]*$/d;s/^        worker_connections  1024;/\tworker_connections 1024;/;s/^        use                 epoll;/\tuse                epoll;/;s/^        multi_accept        on;/\tmulti_accept       on;/;s/^        /\t\t/g;s/^    /\t/g;s/^# Worker config/\n# Worker config/;s/^http {/\nhttp {/;s/^\t# Cache bypass/\n\t# Cache bypass/;s/^\t# File cache (static assets)/\n\t# File cache (static assets)/;s/^user                    www-data;/user                 www-data;/;s/^worker_processes        auto;/worker_processes     auto;/;s/^worker_rlimit_nofile    65535;/worker_rlimit_nofile 65535;/;s|^error_log               /var/log/nginx/error.log;|error_log            /var/log/nginx/error.log;|;s|^pid                     /run/nginx.pid;|pid                  /run/nginx.pid;|;s|^include /etc/nginx/modules-enabled/\*.conf;|include              /etc/nginx/modules-enabled/\*.conf;|;s/log_not_found off;/log_not_found                   off;/;s/access_log off;/access_log                      off;/;s|include             /etc/nginx/mime.types;|include                         /etc/nginx/mime.types;|;s|default_type        application/octet-stream;|default_type                    application/octet-stream;|;s/default 0;/default              0;/;s/~SESS 1;/~SESS                1;/;s|include /etc/nginx/conf.d/|include                         /etc/nginx/conf.d/|g' /etc/nginx/nginx.conf-staging
-
-			# Prepare for update
-			sed -i '/proxy_bu/d;/proxy_temp/d;/log_format/d;/body_bytes_sent/d;/http_user_agent/d;/gzip/d;/application\/j/d;/application\/x/d;/ssl_/d;/resolver/d;/error_page/d;/\/var\/cache\/nginx/d;/max_size=/d;/_cache_key/d;/_ignore_headers/d;/_cache_use_stale/d;/_cache_valid/d;/_cache_methods/d;/add_header/d;/open_file_cache/d' /etc/nginx/nginx.conf-staging
-
-			# Apply the update
-			sed -i 's/client_max_body_size            256m;/client_max_body_size            1024m;/;s/keepalive_requests              100000;/keepalive_requests              10000;/;s/fastcgi_buffers                 8 256k;/fastcgi_buffers                 512 4k;/;s/proxy_pass_header               Set-Cookie;/proxy_pass_header               Set-Cookie;\n\tproxy_buffers                   256 4k;\n\tproxy_buffer_size               32k;\n\tproxy_busy_buffers_size         32k;\n\tproxy_temp_file_write_size      256k;/;s/# Log format/# Log format\n\tlog_format                      main '"'"'$remote_addr - $remote_user [$time_local] $request "$status" $body_bytes_sent "$http_referer" "$http_user_agent" "$http_x_forwarded_for"'"'"';\n\tlog_format                      bytes '"'"'$body_bytes_sent'"'"';/;s|# Compression|# Compression\n\tgzip                            on;\n\tgzip_vary                       on;\n\tgzip_static                     on;\n\tgzip_comp_level                 6;\n\tgzip_min_length                 1024;\n\tgzip_buffers                    128 4k;\n\tgzip_http_version               1.1;\n\tgzip_types                      text/css text/javascript text/js text/plain text/richtext text/shtml text/x-component text/x-java-source text/x-markdown text/x-script text/xml image/bmp image/svg+xml image/vnd.microsoft.icon image/x-icon font/otf font/ttf font/x-woff multipart/bag multipart/mixed application/eot application/font application/font-sfnt application/font-woff application/javascript application/javascript-binast application/json application/ld+json application/manifest+json application/opentype application/otf application/rss+xml application/ttf application/truetype application/vnd.api+json application/vnd.ms-fontobject application/wasm application/xhtml+xml application/xml application/xml+rss application/x-httpd-cgi application/x-javascript application/x-opentype application/x-otf application/x-perl application/x-protobuf application/x-ttf;\n\tgzip_proxied                    any;|;s/# Cloudflare ips/# Cloudflare IPs/;s|# SSL PCI compliance|# SSL PCI compliance\n\tssl_buffer_size                 1369;\n\tssl_ciphers                     "'"$tls12_ciphers"'";\n\tssl_dhparam                     /etc/ssl/dhparam.pem;\n\tssl_early_data                  on;\n\tssl_ecdh_curve                  auto;\n\tssl_prefer_server_ciphers       on;\n\tssl_protocols                   TLSv1.2 TLSv1.3;\n\tssl_session_cache               shared:SSL:20m;\n\tssl_session_tickets             on;\n\tssl_session_timeout             7d;\n\tresolver                        1.0.0.1 8.8.4.4 1.1.1.1 8.8.8.8 valid=300s ipv6=off;\n\tresolver_timeout                5s;|;s|# Error pages|# Error pages\n\terror_page                      403 /error/404.html;\n\terror_page                      404 /error/404.html;\n\terror_page                      410 /error/410.html;\n\terror_page                      500 501 502 503 504 505 /error/50x.html;|;s|# Proxy cache|# Proxy cache\n\tproxy_cache_path                /var/cache/nginx levels=2 keys_zone=cache:10m inactive=60m max_size=1024m;\n\tproxy_cache_key                 "$scheme$request_method$host$request_uri";\n\tproxy_temp_path                 /var/cache/nginx/temp;\n\tproxy_ignore_headers            Cache-Control Expires;\n\tproxy_cache_use_stale           error timeout invalid_header updating http_502;\n\tproxy_cache_valid               any 1d;|;s|# FastCGI cache|# FastCGI cache\n\tfastcgi_cache_path              /var/cache/nginx/micro levels=1:2 keys_zone=microcache:10m inactive=30m max_size=1024m;\n\tfastcgi_cache_key               "$scheme$request_method$host$request_uri";\n\tfastcgi_ignore_headers          Cache-Control Expires Set-Cookie;\n\tfastcgi_cache_use_stale         error timeout invalid_header updating http_500 http_503;\n\tadd_header                      X-FastCGI-Cache $upstream_cache_status;|;s/# File cache (static assets)/# File cache (static assets)\n\topen_file_cache                 max=10000 inactive=30s;\n\topen_file_cache_valid           60s;\n\topen_file_cache_min_uses        2;\n\topen_file_cache_errors          off;/' /etc/nginx/nginx.conf-staging
-
-			# Apply the update for implement TLS 1.3 0-RTT anti-replay and upcoming HTTP/3 support
-			sed -i '/\/etc\/nginx\/conf\.d\/main\/\*\.conf;/d;/pid                  \/run\/nginx.pid;/a include              /etc/nginx/conf.d/main/*.conf;' /etc/nginx/nginx.conf-staging
-			sed -i '/Early-Data/d;/proxy_set_header                Host $host;/a \\tproxy_set_header                Early-Data $rfc_early_data;' /etc/nginx/nginx.conf-staging
-
-			# Verify new configuration file
-			if nginx -c /etc/nginx/nginx.conf-staging -t > /dev/null 2>&1; then
-				mv -f /etc/nginx/nginx.conf-staging /etc/nginx/nginx.conf
-			fi
-		fi
-
-		# Implement TLS 1.3 0-RTT anti-replay
-		echo -e "[ * ] TLS 1.3 0-RTT anti-replay for NGINX, please view:\n[ - ] $HESTIA_BACKUP/message.log"
-		add_upgrade_message "About TLS 1.3 0-RTT anti-replay for NGINX\n\nIf you use custom templates, please update them (*.stpl) to apply this protection.\n\nFollow the usage or other default templates:\n/etc/nginx/conf.d/0rtt-anti-replay.conf\n\nLearn more:\nhttps://github.com/hestiacp/hestiacp/pull/3692"
-		"$BIN"/v-add-user-notification admin "About TLS 1.3 0-RTT anti-replay for NGINX" '<p>If you use custom templates, please update them (*.stpl) to apply this protection.</p><p>Follow the usage or other default templates:<br><code>/etc/nginx/conf.d/0rtt-anti-replay.conf</code></p><p>Visit PR <a href="https://github.com/hestiacp/hestiacp/pull/3692" target="_blank">#3692</a> on GitHub to learn more.</p>'
-
-		if grep -qw "IMPORTANT: Manual Action Required" "$HESTIA"/data/users/admin/notifications.conf 2> /dev/null; then
-			sed -i "s/""$(grep -m 1 "About TLS 1.3 0-RTT anti-replay for NGINX" "$HESTIA"/data/users/admin/notifications.conf | awk '{print $1}')""/NID='2'/" "$HESTIA"/data/users/admin/notifications.conf
-		else
-			sed -i "s/""$(grep -m 1 "About TLS 1.3 0-RTT anti-replay for NGINX" "$HESTIA"/data/users/admin/notifications.conf | awk '{print $1}')""/NID='1'/" "$HESTIA"/data/users/admin/notifications.conf
-		fi
-
-		cp -f "$HESTIA_INSTALL_DIR"/nginx/0rtt-anti-replay.conf /etc/nginx/conf.d
-
-		# Update resolver for NGINX
-		for nameserver in $(grep -is '^nameserver' /etc/resolv.conf | cut -d' ' -f2 | tr '\r\n' ' ' | xargs); do
-			if [[ "$nameserver" =~ ^([0-9]{1,3}\.){3}[0-9]{1,3}$ ]]; then
-				if [ -z "$resolver" ]; then
-					resolver="$nameserver"
-				else
-					resolver="$resolver $nameserver"
-				fi
-			fi
-		done
-
-		if [ -n "$resolver" ]; then
-			sed -i "s/1.0.0.1 8.8.4.4 1.1.1.1 8.8.8.8/$resolver/g" /etc/nginx/nginx.conf
-		fi
-
-		# Update some configuration files
-		cp -f "$HESTIA_INSTALL_DIR"/nginx/phpmyadmin.inc "$HESTIA_INSTALL_DIR"/nginx/phppgadmin.inc "$HESTIA_INSTALL_DIR"/nginx/status.conf /etc/nginx/conf.d
-		[ -n "$DB_PMA_ALIAS" ] && sed -i "s|%pma_alias%|$DB_PMA_ALIAS|g" /etc/nginx/conf.d/phpmyadmin.inc
-		[ -n "$DB_PGA_ALIAS" ] && sed -i "s|%pga_alias%|$DB_PGA_ALIAS|g" /etc/nginx/conf.d/phppgadmin.inc
-
-		# Prepare for upcoming HTTP/3 support, also convenient for users to add directive to "main" context
-		mkdir -p /etc/nginx/conf.d/main
-	fi
-fi
-
-unset commit nameserver nginx_conf_commit nginx_conf_compare nginx_conf_local os_release tls12_ciphers tls13_ciphers resolver
-# Finish configuring the "Enhanced and Optimized TLS" feature
-
-# Update IPs configuration file
-# shellcheck source=/usr/local/hestia/func/domain.sh
-source $HESTIA/func/domain.sh
-
-if [ "$WEB_SYSTEM" = "nginx" ]; then
-	while IFS= read -r IP; do
-		ip_conf="/etc/nginx/conf.d/$IP.conf"
-		cp -f "$HESTIA_INSTALL_DIR"/nginx/unassigned.inc "$ip_conf"
-		sed -i "s/directIP/$IP/g" "$ip_conf"
-		process_http2_directive "$ip_conf"
-	done < <(ls "$HESTIA"/data/ips/ 2> /dev/null)
-elif [ "$PROXY_SYSTEM" = "nginx" ]; then
-	while IFS= read -r IP; do
-		cat "$WEBTPL"/nginx/proxy_ip.tpl \
-			| sed -e "s/%ip%/$IP/g" \
-				-e "s/%web_port%/$WEB_PORT/g" \
-				-e "s/%proxy_port%/$PROXY_PORT/g" \
-				-e "s/%proxy_ssl_port%/$PROXY_SSL_PORT/g" \
-				> "/etc/nginx/conf.d/$IP.conf"
-		process_http2_directive "/etc/nginx/conf.d/$IP.conf"
-	done < <(ls "$HESTIA"/data/ips/ 2> /dev/null)
-fi
-
-if [ "$MAIL_SYSTEM" = "exim4" ]; then
-	exim_version=$(exim4 --version | head -1 | awk '{print $3}' | cut -f -2 -d .)
-	# if Exim version > 4.95 or greater!
-	if version_ge "$exim_version" "4.95"; then
-		if ! grep -q 'SRS_SECRET' /etc/exim4/exim4.conf.template; then
-			srs=$(generate_password)
-			echo $srs > /etc/exim4/srs.conf
-			chmod 640 /etc/exim4/srs.conf
-			chown root:Debian-exim /etc/exim4/srs.conf
-			cp /etc/exim4/exim4.conf.template /etc/exim4/exim4.conf.template.staging
-			patch /etc/exim4/exim4.conf.template.staging $HESTIA/install/upgrade/patch/3661-exim-srs-support.patch 2>&1
-			exim -C /etc/exim4/exim4.conf.template.staging 2>&1
-			if [ "$?" -ne 0 ]; then
-				add_upgrade_message "Unable to successfully aply the SRS update patch for Exim.\n If you use SMTP relay with the SRS feature use the exim config found in /usr/local/hestia/install/deb/exim/exim4.conf.4.95.template"
-				"$BIN"/v-add-user-notification admin "Unable to apply patch to Exim config" 'Unable to successfully apply the SRS update patch for Exim.<br /> If you use SMTP relay with the SRS feature use the exim config found in /usr/local/hestia/install/deb/exim/exim4.conf.4.95.template'
-				if grep -qw "IMPORTANT: Manual Action Required" "$HESTIA"/data/users/admin/notifications.conf 2> /dev/null; then
-					sed -i "s/""$(grep -m 1 "Unable to apply patch to Exim config" "$HESTIA"/data/users/admin/notifications.conf | awk '{print $1}')""/NID='3'/" "$HESTIA"/data/users/admin/notifications.conf
-				else
-					sed -i "s/""$(grep -m 1 "Unable to apply patch to Exim config" "$HESTIA"/data/users/admin/notifications.conf | awk '{print $1}')""/NID='2'/" "$HESTIA"/data/users/admin/notifications.conf
-				fi
-				echo "[ ! ] Unable to apply SRS update patch for SMTP relay"
-			else
-				echo "[ * ] Update exim4.conf.template ..."
-				cp /etc/exim4/exim4.conf.template.staging /etc/exim4/exim4.conf.template
-			fi
-			rm /etc/exim4/exim4.conf.template.staging*
-		else
-			sed -i "s/SRS_SECRET = readfile{\/etc\/exim4\/srs.conf}/SRS_SECRET = \${readfile{\/etc\/exim4\/srs.conf}}/g" /etc/exim4/exim4.conf.template
-			chown root:Debian-exim /etc/exim4/srs.conf
-		fi
-	fi
-
-	exim_version=$(exim4 --version | head -1 | awk '{print $3}' | cut -f -2 -d .)
-	# if Exim version > 4.95 or greater!
-	if version_ge "$exim_version" "4.95"; then
-		if ! grep -q 'condition = ${lookup{$local_part@$domain}lsearch{/etc/exim4/domains/${lookup{$domain}dsearch{/etc/exim4/domains/}}/aliases}{false}{true}}' /etc/exim4/exim4.conf.template; then
-			for line in $(sed -n '/redirect_router = dnslookup/=' /etc/exim4/exim4.conf.template); do
-				testline=$((line - 1))
-				newline=$((line + 1))
-				if [ "$(awk NR==$testline /etc/exim4/exim4.conf.template)" = "  file_transport = local_delivery" ]; then
-					# Add new line
-					sed -i "$newline i \ \ condition = \${lookup{\$local_part@\$domain}lsearch{/etc/exim4/domains/\${lookup{\$domain}dsearch{/etc/exim4/domains/}}/aliases}{false}{true}}" /etc/exim4/exim4.conf.template
-				fi
-			done
-		fi
-	fi
-
-fi
diff --git a/install/upgrade/versions/1.8.1.sh b/install/upgrade/versions/1.8.1.sh
deleted file mode 100644
index a0da773..0000000
--- a/install/upgrade/versions/1.8.1.sh
+++ /dev/null
@@ -1,34 +0,0 @@
-#!/bin/bash
-
-# Hestia Control Panel upgrade script for target version 1.8.1
-
-#######################################################################################
-#######                      Place additional commands below.                   #######
-#######################################################################################
-####### upgrade_config_set_value only accepts true or false.                    #######
-#######                                                                         #######
-####### Pass through information to the end user in case of a issue or problem  #######
-#######                                                                         #######
-####### Use add_upgrade_message "My message here" to include a message          #######
-####### in the upgrade notification email. Example:                             #######
-#######                                                                         #######
-####### add_upgrade_message "My message here"                                   #######
-#######                                                                         #######
-####### You can use \n within the string to create new lines.                   #######
-#######################################################################################
-
-upgrade_config_set_value 'UPGRADE_UPDATE_WEB_TEMPLATES' 'true'
-upgrade_config_set_value 'UPGRADE_UPDATE_DNS_TEMPLATES' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_MAIL_TEMPLATES' 'true'
-upgrade_config_set_value 'UPGRADE_REBUILD_USERS' 'false'
-upgrade_config_set_value 'UPGRADE_UPDATE_FILEMANAGER_CONFIG' 'false'
-
-if [ "$MAIL_SYSTEM" = "exim4" ]; then
-	exim_version=$(exim4 --version | head -1 | awk '{print $3}' | cut -f -2 -d .)
-	# if Exim version > 4.95 or greater!
-	if version_ge "$exim_version" "4.95"; then
-		sed -i "s/SRS_SECRET = readfile{\/etc\/exim4\/srs.conf}/SRS_SECRET = \${readfile{\/etc\/exim4\/srs.conf}}/g" /etc/exim4/exim4.conf.template
-		chown root:Debian-exim /etc/exim4/srs.conf
-		chown 644 /etc/exim4/srs.conf
-	fi
-fi
diff --git a/src/hst_autocompile.sh b/src/hst_autocompile.sh
index c732989..d579928 100755
--- a/src/hst_autocompile.sh
+++ b/src/hst_autocompile.sh
@@ -96,6 +96,7 @@ usage() {
 	echo "    --keepbuild     Don't delete downloaded source and build folders"
 	echo "    --cross         Compile hestia package for both AMD64 and ARM64"
 	echo "    --debug         Debug mode"
+	echo "    --npm           Rebuild nmp command"
 	echo ""
 	echo "For automated builds and installations, you may specify the branch"
 	echo "after one of the above flags. To install the packages, specify 'Y'"
@@ -106,6 +107,59 @@ usage() {
 	echo "develop branch code."
 }
 
+hestiacp_vercomp () {
+    if [[ $1 == $2 ]]
+    then
+        return 0
+    fi
+    local IFS=.
+    local i ver1=($1) ver2=($2)
+    for ((i=${#ver1[@]}; i<${#ver2[@]}; i++))
+    do
+        ver1[i]=0
+    done
+    for ((i=0; i<${#ver1[@]}; i++))
+    do
+        if [[ -z ${ver2[i]} ]]
+        then
+            ver2[i]=0
+        fi
+        if ((10#${ver1[i]} > 10#${ver2[i]}))
+        then
+            return 1
+        fi
+        if ((10#${ver1[i]} < 10#${ver2[i]}))
+        then
+            return 2
+        fi
+    done
+    return 0
+}
+
+hestiacp_check_package_version () {
+    if [ -z "$1" ] || [ -z "$2" ] || [ -z "$3" ]; then
+        return 1
+    fi
+	IS_RPM="$1"
+	if [ "$IS_RPM" = true ]; then
+	    # Check for rmp based
+		pack_version=$(rpm -q --queryformat="%{VERSION}" "$2")
+		if [ $? -eq 0 ]; then
+			hestiacp_vercomp "$pack_version" "$3"
+			RESULT_OF_COMPARISON=$?
+			case "$RESULT_OF_COMPARISON" in
+				0 ) return 0 ;;
+				1 ) return 0 ;;
+			esac
+		fi
+		return 1
+	else
+	    # Debian based not yet implemented
+		return 0
+	fi
+}
+
+
 # Set compiling directory
 REPO='hestiacp/hestiacp'
 BUILD_DIR='/tmp/hestiacp-src'
@@ -128,7 +182,7 @@ if [ -f '/etc/redhat-release' ]; then
 	type=$(grep "^ID=" /etc/os-release | cut -f 2 -d '"')
 	DISTRO=$type
 	# TODO: remove this condition after testing
-	if [[ "$type" =~ ^(rhel|almalinux|eurolinux|ol|rocky|centos)$ ]]; then
+	if [[ "$type" =~ ^(rhel|almalinux|eurolinux|ol|rocky|centos|msvsphere)$ ]]; then
 		release=$(rpm --eval='%rhel')
 	fi
 else
@@ -176,6 +230,9 @@ for i in $*; do
 		--dontinstalldeps)
 			dontinstalldeps='true'
 			;;
+		--npm)
+			NPM_REBUILD='true'
+			;;
 		*)
 			branch="$i"
 			;;
@@ -278,7 +335,7 @@ if [ "$dontinstalldeps" != 'true' ]; then
 		echo "Installing dependencies for compilation..."
 		dnf install -y -q $SOFTWARE
 
-		mock -r almalinux+rhel-${release}-$BUILD_ARCH --clean
+		mock -r msvsphere+epel-${release}-$BUILD_ARCH --clean
 	else
 		# Set package dependencies for compiling
 		SOFTWARE='wget tar git curl build-essential libxml2-dev libz-dev libzip-dev libgmp-dev libcurl4-gnutls-dev unzip openssl libssl-dev pkg-config libsqlite3-dev libonig-dev rpm lsb-release'
@@ -302,7 +359,7 @@ NUM_CPUS=$(grep "^cpu cores" /proc/cpuinfo | uniq | awk '{print $4}')
 
 if [ "$HESTIA_DEBUG" ]; then
 	if [ "$OSTYPE" = 'rhel' ]; then
-		echo "OS type          : RHEL / Rocky Linux / AlmaLinux / EuroLinux"
+		echo "OS type          : RHEL / Rocky Linux / AlmaLinux / EuroLinux / MSVSphere"
 	else
 		echo "OS type          : Debian / Ubuntu"
 	fi
@@ -479,7 +536,7 @@ if [ "$NGINX_B" = true ]; then
 
 		# Build the package
 		echo Building Nginx RPM
-		mock -r almalinux+rhel-${release}-$BUILD_ARCH --sources $BUILD_DIR --spec $BUILD_DIR/hestia-nginx.spec --resultdir $RPM_DIR
+		mock -r msvsphere+epel-${release}-$BUILD_ARCH --sources $BUILD_DIR --spec $BUILD_DIR/hestia-nginx.spec --resultdir $RPM_DIR
 		rm -f $BUILD_DIR/*
 	fi
 fi
@@ -617,7 +674,7 @@ if [ "$PHP_B" = true ]; then
 
 		# Build RPM package
 		echo Building PHP RPM
-		mock -r almalinux+rhel-${release}-$BUILD_ARCH --sources $BUILD_DIR --spec $BUILD_DIR/hestia-php.spec --resultdir $RPM_DIR
+		mock -r msvsphere+epel-${release}-$BUILD_ARCH --sources $BUILD_DIR --spec $BUILD_DIR/hestia-php.spec --resultdir $RPM_DIR
 		rm -f $BUILD_DIR/*
 	fi
 fi
@@ -707,13 +764,30 @@ if [ "$HESTIA_B" = true ]; then
 			# Get RHEL package files
 			get_branch_file 'src/rpm/hestia/hestia.spec' "$BUILD_DIR/hestia.spec"
 			get_branch_file 'src/rpm/hestia/hestia.service' "$BUILD_DIR/hestia.service"
+			get_branch_file 'src/rpm/hestia/hestia.tmpfiles' "$BUILD_DIR/hestia.tmpfiles"
+
+			#Get nodejs 20.x version
+			if [ "$NPM_REBUILD" = true ]; then
+				echo "Update nodejs up to 20.x version"
+				hestiacp_check_package_version $BUILD_RPM "nodejs" "20.0"
+				IS_NEEDED_NODEJS=$?
+				if [ "$IS_NEEDED_NODEJS" = "1" ]; then
+					dnf erase nodejs -y
+					curl -fsSL https://rpm.nodesource.com/setup_20.x | bash -
+					dnf install nodejs -y
+				fi
+				pushd "$SRC_DIR" || { echo "Can't change directory to $SRC_DIR, javascript rebuild aborted"; exit 1; }
+				npm install
+				npm run build
+				popd || { echo "Can't restore directory from $SRC_DIR, javascript rebuild aborted"; exit 1; }
+			fi
 
 			# Generate source tar.gz
-			tar -czf $BUILD_DIR/hestia-$BUILD_VER.tar.gz -C $SRC_DIR/.. hestiacp
+			tar -h --exclude=".git" --exclude=".github" --exclude=".husky" --exclude=".vscode" --exclude="node_modules" --exclude="src/archive" -czf $BUILD_DIR/hestia-$BUILD_VER.tar.gz -C $SRC_DIR/.. hestiacp
 
 			# Build RPM package
 			echo Building Hestia RPM
-			mock -r almalinux+rhel-${release}-$BUILD_ARCH --sources $BUILD_DIR --spec $BUILD_DIR/hestia.spec --resultdir $RPM_DIR
+			mock -r msvsphere+epel-${release}-$BUILD_ARCH --sources $BUILD_DIR --spec $BUILD_DIR/hestia.spec --resultdir $RPM_DIR
 			rm -f $BUILD_DIR/*
 		fi
 
diff --git a/src/hst_bootstrap_install.sh b/src/hst_bootstrap_install.sh
index a480468..83ee1ed 100755
--- a/src/hst_bootstrap_install.sh
+++ b/src/hst_bootstrap_install.sh
@@ -11,11 +11,11 @@ os=$3
 
 # Download specified installer and compiler
 if [ -f "/etc/redhat-release" ]; then
-	wget https://raw.githubusercontent.com/$fork/hestiacp/$branch/install/hst-install-rhel.sh
+	wget https://dev.putey.net/bayrepo/hestiacp/raw/branch/master/install/hst-install-rhel.sh
 else
-	wget https://raw.githubusercontent.com/$fork/hestiacp/$branch/install/hst-install-$os.sh
+	wget https://dev.putey.net/bayrepo/hestiacp/raw/branch/master/install/hst-install-$os.sh
 fi
-wget https://raw.githubusercontent.com/$fork/hestiacp/$branch/src/hst_autocompile.sh
+wget https://dev.putey.net/bayrepo/hestiacp/raw/branch/master/src/hst_autocompile.sh
 
 # Execute compiler and build hestia core package
 chmod +x hst_autocompile.sh
diff --git a/src/lxd_compile.sh b/src/lxd_compile.sh
index d50a1fc..200277d 100644
--- a/src/lxd_compile.sh
+++ b/src/lxd_compile.sh
@@ -8,7 +8,7 @@ else
 	apt -y install curl wget
 fi
 
-curl https://raw.githubusercontent.com/hestiacp/hestiacp/$branch/src/hst_autocompile.sh > /tmp/hst_autocompile.sh
+curl https://dev.putey.net/bayrepo/hestiacp/raw/branch/master/src/hst_autocompile.sh > /tmp/hst_autocompile.sh
 chmod +x /tmp/hst_autocompile.sh
 
 mkdir -p /opt/hestiacp
diff --git a/src/rpm/hestia/control b/src/rpm/hestia/control
new file mode 100644
index 0000000..a912d87
--- /dev/null
+++ b/src/rpm/hestia/control
@@ -0,0 +1,14 @@
+Source: hestia
+Package: hestia
+Priority: optional
+Version: 1.9.0~alpha
+Section: admin
+Maintainer: HestiaCP <info@hestiacp.com>
+Homepage: https://www.hestiacp.com
+Architecture: amd64
+Depends: bash, awk, sed, acl, sysstat, setpriv | util-linux (>= 2.33), zstd, lsb-release, idn2, jq
+Description: hestia
+ hestia is an open source hosting control panel.
+ hestia has a clean and focused interface without the clutter.
+ hestia has the latest of very innovative technologies.
+ hestia is a fork from VestaCP, special thanks to vestacp.com and Serghey Rodin
diff --git a/src/rpm/hestia/hestia.spec b/src/rpm/hestia/hestia.spec
index 6c043ab..8790e23 100644
--- a/src/rpm/hestia/hestia.spec
+++ b/src/rpm/hestia/hestia.spec
@@ -2,8 +2,8 @@
 %global _hardened_build 1
 
 Name:              hestia
-Version:           1.8.0~alpha
-Release:           1%{dist}
+Version:           1.8.4
+Release:           1%{dist}.bayrepo.1
 Summary:           Hestia Control Panel
 Group:             System Environment/Base
 License:           GPLv3
@@ -25,6 +25,7 @@ Requires:          sysstat
 Requires:          util-linux
 Requires:          zstd
 Requires:          jq
+Requires:          util-linux-user
 Requires(post):    systemd
 Requires(preun):   systemd
 Requires(postun):  systemd
@@ -83,6 +84,7 @@ if [ -e "/usr/local/hestia/data/users/admin" ]; then
     ###############################################################
 
     # Load upgrade functions and refresh variables/configuration
+    source /usr/local/hestia/func/main.sh
     source /usr/local/hestia/func/upgrade.sh
     upgrade_refresh_config
 
@@ -145,7 +147,7 @@ if [ -e "/usr/local/hestia/data/users/admin" ]; then
 	update_whitelabel_logo | tee -a $LOG
 
     # Set new version number in hestia.conf
-    upgrade_set_version
+    upgrade_set_version $new_version
 
     # Perform account and domain rebuild to ensure configuration files are correct
     upgrade_rebuild_users
@@ -163,6 +165,12 @@ fi
 %postun
 %systemd_postun_with_restart hestia.service
 
+%triggerin -- openssh-server
+/usr/local/hestia/bin/v-package-hook-checks
+
+%posttrans
+/usr/local/hestia/bin/v-package-hook-checks
+
 %files
 %defattr(-,root,root)
 %attr(755,root,root) /usr/local/hestia
@@ -170,6 +178,10 @@ fi
 %{_tmpfilesdir}/%{name}.conf
 
 %changelog
+* Fri Apr 5 2024 Alexey Berezhok <a@bayrepo.ru> - 1.8.1-1.bayrepo.2
+- Added fixes in rpm based installation
+- Added MSVSphere 9/8 support
+
 * Sun May 14 2023 Istiak Ferdous <hello@istiak.com> - 1.8.0-1
 - HestiaCP RHEL 9 support
 
diff --git a/src/rpm/nginx/nginx.conf b/src/rpm/nginx/nginx.conf
index 54612d6..efd5a1a 100644
--- a/src/rpm/nginx/nginx.conf
+++ b/src/rpm/nginx/nginx.conf
@@ -163,7 +163,7 @@ http {
 				include       fastcgi_params;
 				fastcgi_param HTTP_EARLY_DATA $rfc_early_data if_not_empty;
 				fastcgi_param SCRIPT_FILENAME /usr/local/hestia/web/fm/dist/index.php;
-				fastcgi_pass  unix:/run/hestia-php.sock;
+				fastcgi_pass  unix:/run/hestia/php.sock;
 				fastcgi_index index.php;
 			}
 		}
diff --git a/src/rpm/php/hestia-php.service b/src/rpm/php/hestia-php.service
index ca8c474..4c30640 100644
--- a/src/rpm/php/hestia-php.service
+++ b/src/rpm/php/hestia-php.service
@@ -6,10 +6,11 @@ PartOf=hestia.service
 [Service]
 Type=forking
 PIDFile=/run/hestia/php.pid
-ExecStart=/usr/local/hestia/php/sbin/hestia-php --fpm-config /usr/local/hestia/php/etc/php-fpm.conf
+ExecStart=/usr/local/hestia/php/sbin/php-fpm --fpm-config /usr/local/hestia/php/etc/php-fpm.conf
 ExecReload=/bin/kill -USR2 $MAINPID
 ExecStop=/bin/kill -TERM $MAINPID
 ExecStartPre=/bin/bash -c "/bin/systemctl set-environment HOSTNAME=$(/usr/bin/hostname)"
+ExecStartPre=/bin/bash -c "[ -e /usr/local/hestia/bin/v-oneshot-service ] && /usr/local/hestia/bin/v-oneshot-service"
 Environment="HESTIA=/usr/local/hestia"
 
 [Install]
diff --git a/src/rpm/php/hestia-php.spec b/src/rpm/php/hestia-php.spec
index 40769eb..0568353 100644
--- a/src/rpm/php/hestia-php.spec
+++ b/src/rpm/php/hestia-php.spec
@@ -7,7 +7,7 @@ Release:        1%{dist}
 Summary:        Hestia internal PHP
 Group:          System Environment/Base
 URL:            https://www.hestiacp.com
-Source0:        https://www.php.net/distributions/php-%{version}.tar.xz
+Source0:        https://www.php.net/distributions/php-%{version}.tar.gz
 Source1:        hestia-php.service
 Source2:        php-fpm.conf
 Source3:        php.ini
diff --git a/src/rpm/php/php-fpm.conf b/src/rpm/php/php-fpm.conf
index 5d511c1..16e7e02 100644
--- a/src/rpm/php/php-fpm.conf
+++ b/src/rpm/php/php-fpm.conf
@@ -41,3 +41,5 @@ php_admin_value[upload_max_filesize] = 256M
 php_admin_value[max_execution_time] = 300
 php_admin_value[max_input_time] = 300
 php_admin_value[session.save_path] = /usr/local/hestia/data/sessions
+php_admin_value[open_basedir] = /usr/local/hestia/:/tmp/:/dev/:/home/:/etc/ssh/:/backup/:/var/tmp/
+
diff --git a/test/make-test-containers.php b/test/make-test-containers.php
index e58acae..344e12d 100644
--- a/test/make-test-containers.php
+++ b/test/make-test-containers.php
@@ -256,10 +256,10 @@ function lxc_run($args, &$rc) {
 function getHestiaVersion($branch) {
 	$control_file = "";
 	if ($branch === "~localsrc") {
-		$control_file = file_get_contents(SHARED_HOST_FOLDER . "/hestiacp/src/deb/hestia/control");
+		$control_file = file_get_contents(SHARED_HOST_FOLDER . "/hestiacp/src/rpm/hestia/control");
 	} else {
 		$control_file = file_get_contents(
-			"https://raw.githubusercontent.com/hestiacp/hestiacp/${branch}/src/deb/hestia/control",
+			"https://dev.putey.net/bayrepo/hestiacp/raw/branch/master/src/rpm/hestia/control",
 		);
 	}
 
diff --git a/test/test.bats b/test/test.bats
index 289c47c..cb98a3b 100755
--- a/test/test.bats
+++ b/test/test.bats
@@ -635,13 +635,25 @@ function check_ip_not_banned(){
     assert_success
     refute_output
 
-    assert_file_exist /etc/$WEB_SYSTEM/conf.d/$ip.conf
+    if [ "$WEB_SYSTEM" = "httpd" ]; then
+		confd="conf.h.d"
+	else
+		confd="conf.d"
+	fi
+
+    if [ "$PROXY_SYSTEM" = "httpd" ]; then
+		pconfd="conf.h.d"
+	else
+		pconfd="conf.d"
+	fi
+
+    assert_file_exist /etc/$WEB_SYSTEM/$confd/$ip.conf
     assert_file_exist $HESTIA/data/ips/$ip
     assert_file_contains $HESTIA/data/ips/$ip "OWNER='$user'"
     assert_file_contains $HESTIA/data/ips/$ip "INTERFACE='$interface'"
 
     if [ -n "$PROXY_SYSTEM" ]; then
-        assert_file_exist /etc/$PROXY_SYSTEM/conf.d/$ip.conf
+        assert_file_exist /etc/$PROXY_SYSTEM/$pconfd/$ip.conf
         [ -f "$a2_rpaf" ] && assert_file_contains "$a2_rpaf" "RPAFproxy_ips.*$ip\b"
         [ -f "$a2_remoteip" ] && assert_file_contains "$a2_remoteip" "RemoteIPInternalProxy $ip\$"
     fi
@@ -683,13 +695,25 @@ function check_ip_not_banned(){
     assert_success
     refute_output
 
-    assert_file_exist /etc/$WEB_SYSTEM/conf.d/$ip.conf
+    if [ "$WEB_SYSTEM" = "httpd" ]; then
+		confd="conf.h.d"
+	else
+		confd="conf.d"
+	fi
+
+    if [ "$PROXY_SYSTEM" = "httpd" ]; then
+		pconfd="conf.h.d"
+	else
+		pconfd="conf.d"
+	fi
+
+    assert_file_exist /etc/$WEB_SYSTEM/$confd/$ip.conf
     assert_file_exist $HESTIA/data/ips/$ip
     assert_file_contains $HESTIA/data/ips/$ip "OWNER='$user'"
     assert_file_contains $HESTIA/data/ips/$ip "INTERFACE='$interface'"
 
     if [ -n "$PROXY_SYSTEM" ]; then
-        assert_file_exist /etc/$PROXY_SYSTEM/conf.d/$ip.conf
+        assert_file_exist /etc/$PROXY_SYSTEM/$pconfd/$ip.conf
         local a2_rpaf="/etc/$WEB_SYSTEM/mods-enabled/rpaf.conf"
         [ -f "$a2_rpaf" ] && assert_file_contains "$a2_rpaf" "RPAFproxy_ips.*$ip\b"
 
@@ -704,7 +728,19 @@ function check_ip_not_banned(){
     assert_success
     refute_output
 
-    assert_file_not_exist /etc/$WEB_SYSTEM/conf.d/$ip.conf
+    if [ "$WEB_SYSTEM" = "httpd" ]; then
+		confd="conf.h.d"
+	else
+		confd="conf.d"
+	fi
+
+    if [ "$PROXY_SYSTEM" = "httpd" ]; then
+		pconfd="conf.h.d"
+	else
+		pconfd="conf.d"
+	fi
+
+    assert_file_not_exist /etc/$WEB_SYSTEM/$confd/$ip.conf
     assert_file_not_exist $HESTIA/data/ips/$ip
 
 
@@ -713,11 +749,11 @@ function check_ip_not_banned(){
     assert_success
     refute_output
 
-    assert_file_not_exist /etc/$WEB_SYSTEM/conf.d/$ip.conf
+    assert_file_not_exist /etc/$WEB_SYSTEM/$confd/$ip.conf
     assert_file_not_exist $HESTIA/data/ips/$ip
 
     if [ -n "$PROXY_SYSTEM" ]; then
-        assert_file_not_exist /etc/$PROXY_SYSTEM/conf.d/$ip.conf
+        assert_file_not_exist /etc/$PROXY_SYSTEM/$pconfd/$ip.conf
     fi
 
     # remoteip and rpaf config hashes must match the initial one
@@ -739,13 +775,25 @@ function check_ip_not_banned(){
     assert_success
     refute_output
 
-    assert_file_exist /etc/$WEB_SYSTEM/conf.d/$ip.conf
+    if [ "$WEB_SYSTEM" = "httpd" ]; then
+		confd="conf.h.d"
+	else
+		confd="conf.d"
+	fi
+
+    if [ "$PROXY_SYSTEM" = "httpd" ]; then
+		pconfd="conf.h.d"
+	else
+		pconfd="conf.d"
+	fi
+
+    assert_file_exist /etc/$WEB_SYSTEM/$confd/$ip.conf
     assert_file_exist $HESTIA/data/ips/$ip
     assert_file_contains $HESTIA/data/ips/$ip "OWNER='$user'"
     assert_file_contains $HESTIA/data/ips/$ip "INTERFACE='$interface'"
 
     if [ -n "$PROXY_SYSTEM" ]; then
-        assert_file_exist /etc/$PROXY_SYSTEM/conf.d/$ip.conf
+        assert_file_exist /etc/$PROXY_SYSTEM/$pconfd/$ip.conf
         local a2_rpaf="/etc/$WEB_SYSTEM/mods-enabled/rpaf.conf"
         [ -f "$a2_rpaf" ] && assert_file_contains "$a2_rpaf" "RPAFproxy_ips.*$ip\b"
 
diff --git a/web/edit/server/index.php b/web/edit/server/index.php
index 09d66be..3facf7a 100644
--- a/web/edit/server/index.php
+++ b/web/edit/server/index.php
@@ -29,6 +29,10 @@ exec(HESTIA_CMD . "v-list-web-templates-backend json", $output, $return_var);
 $backend_templates = json_decode(implode("", $output), true);
 unset($output);
 
+exec(HESTIA_CMD . "v-check-rhel-utility", $output, $return_var);
+$is_rhel = str_contains(implode("", $output), "+");
+unset($output);
+
 $v_php_versions = [
 	"php-5.6",
 	"php-7.0",
@@ -40,6 +44,21 @@ $v_php_versions = [
 	"php-8.1",
 	"php-8.2",
 ];
+
+if ($is_rhel){
+	$v_php_versions = [
+		"php-56",
+		"php-70",
+		"php-71",
+		"php-72",
+		"php-73",
+		"php-74",
+		"php-80",
+		"php-81",
+		"php-82",
+	];
+}
+
 sort($v_php_versions);
 
 if (empty($backend_templates)) {
diff --git a/web/list/server/index.php b/web/list/server/index.php
index 651698f..42ecf52 100644
--- a/web/list/server/index.php
+++ b/web/list/server/index.php
@@ -125,7 +125,11 @@ unset($output);
 $phpfpm = [];
 foreach ($php as $version) {
 	$phpfpm[] = "php" . $version . "-fpm";
+	$phpfpm[] = "php" . $version . "-php-fpm";
 }
+$clamav_names = [];
+$clamav_names[] = "clamav-daemon";
+$clamav_names[] = "clamd";
 
 exec(HESTIA_CMD . "v-list-sys-services json", $output, $return_var);
 $data = json_decode(implode("", $output), true);
diff --git a/web/templates/pages/list_services.php b/web/templates/pages/list_services.php
index 25f292b..333ab7b 100644
--- a/web/templates/pages/list_services.php
+++ b/web/templates/pages/list_services.php
@@ -128,6 +128,11 @@
 				} else {
 					$edit_url=$key;
 				}
+				if (in_array($key, $clamav_names)){
+					$edit_url="clamav-daemon";
+				} else {
+					$edit_url=$key;
+				}
 
 				$cpu = $data[$key]['CPU'] / 10;
 				$cpu = number_format($cpu, 1);
